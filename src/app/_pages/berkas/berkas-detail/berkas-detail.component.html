<div *ngIf="berkasData">
  
  <div class="container-fluid p-0">
    <div class="wrapper">
      <ul class="bg-bubbles align-items-center p-0">
        <li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li>
        <div class="row align-items-center h-100">
        <div class="col-12 mx-auto text-light">
          <div class="container">
            <h2 class="mb-1" style="line-height: normal;">
              {{ berkasData.name }}
            </h2>
            <p class="mb-0">{{ berkasData.project_type_.name }} :: {{ berkasData.view_count }} Views</p>
            <p class="mb-1">{{ berkasData.created_at | date:'long' }}</p>
          </div>
        </div>
      </div>
      </ul>
    </div>
  </div>
  
  <!-- Notification -->
  <app-notifications></app-notifications>

  <!-- Content -->
  <div class="container">
  
    <div class="row">
      <div class="col-md-5 col-xl-4 py-3">
        <div class="row mb-3">
          <img class="w-100" src="{{ berkasData.image_url }}" />
        </div>
        <div class="row py-3">
          <div class="col-12 sticky-top bg-light">
            <h2 class="border-bottom-dotted">
              <b class="text-secondary">Tautan Rujukan Berkas</b></h2>
          </div>
          <div class="col-12">
            <mat-selection-list [multiple]="false">
              <mat-list-option routerLink="/anime/{{ berkasData.anime_.id }}">
                <img matListAvatar src="{{ berkasData.anime_.image_url }}" class="ml-3" style="border-radius: 0;" />
                <h4>{{ berkasData.anime_.name }}</h4>
              </mat-list-option>
              <mat-list-option routerLink="/fansub/{{ fs.id }}" *ngFor="let fs of berkasData.fansub_">
                <img matListAvatar src="{{ fs.image_url }}" class="ml-3" style="border-radius: 0;" />
                <h4>{{ fs.name }}</h4>
              </mat-list-option>
              <mat-list-option routerLink="/user/{{ berkasData.user_.username }}">
                <img matListAvatar src="{{ berkasData.user_.image_url }}" class="ml-3" />
                <h4>{{ berkasData.user_.username }}</h4>
              </mat-list-option>
            </mat-selection-list>
          </div>
        </div>
        <div class="row py-3">
          <div class="col-12 sticky-top bg-light">
            <h2 class="border-bottom-dotted">
              <b class="text-secondary">Tautan Unduhan Berkas</b>
            </h2>
          </div>
          <div class="col-12 text-center" *ngIf="currentUser">
            <a href="{{ i.url }}" class="m-1" target="_blank" mat-stroked-button color="primary" *ngFor="let i of berkasData.download_url">
              <mat-icon class="mr-2">cloud_download</mat-icon>
              {{ i.name }}
            </a>
          </div>
          <div class="col-12 text-center" *ngIf="!currentUser">
            <button class="m-1" mat-stroked-button color="primary" (click)="login()">
              <mat-icon class="mr-2">vpn_key</mat-icon>
              Klik Untuk Login
            </button>
          </div>
        </div>
        <div class="row py-3" *ngIf="currentUser && berkasData.attachment_">
          <div class="col-12 sticky-top bg-light">
            <h2 class="border-bottom-dotted">
              <b class="text-secondary">Tautan DDL Berkas</b>
            </h2>
          </div>
          <div class="col-12 text-center" *ngIf="currentUser.verified">
            <button class="m-1 w-100" mat-stroked-button color="primary" (click)="ddl()"
              matTooltip="Diunduh Sebanyak :: {{ lampiran.download_count }}x" *ngIf="!lampiran.data && !lampiran.isDownloading && !lampiran.isCompleted">
              <mat-icon class="mr-2">save_alt</mat-icon>
              {{ lampiran.ext }} ({{ lampiran.size }} Bytes)
            </button>
            <button class="m-1 w-100" mat-stroked-button color="primary" (click)="cancel_dl()"
              matTooltip="Diunduh Sebanyak :: {{ lampiran.download_count }}x" *ngIf="!lampiran.data && lampiran.isDownloading">
              <mat-icon class="mr-2">close</mat-icon>
              Batal Unduh
            </button>
            <button class="m-1 w-100" mat-stroked-button color="primary" (click)="saveFileAs()" *ngIf="lampiran.data"
              matTooltip="Diunduh Sebanyak :: {{ lampiran.download_count }}x">
              <mat-icon class="mr-2">save</mat-icon>
              {{ lampiran.name + '.' + lampiran.ext }}
            </button>
            <div class="col">
              <div class="px-3" *ngIf="lampiran.isDownloading || lampiran.isCompleted">
                {{ lampiran.percentage >= 100 ? 'Selesai Mengunduh ... '  : 'Sedang Mengunduh ... ' }}
                {{ lampiran.percentage }}% @ {{ lampiran.speed }} KB/s
                <br />
                <mat-progress-bar [mode]="lampiran.mode" [value]="lampiran.percentage"></mat-progress-bar>
              </div>
            </div>
            <div class="col">
              <div class="px-3 text-danger" *ngIf="lampiran.isDownloading" (click)="standardDdl()" style="cursor: pointer;">
                Unduhan Macet? <i><u>Coba Gunakan Unduhan Biasa~</u></i>
              </div>
            </div>
          </div>
          <div class="col-12 text-center" *ngIf="!currentUser.verified">
            <button class="m-1" mat-stroked-button color="primary" (click)="verify()">
              <mat-icon class="mr-2">domain_verification</mat-icon>
              Klik Untuk Verifikasi
            </button>
          </div>
        </div>
      </div>
      <div class="col-md-7 col-xl-8 py-3">
        <div class="row mt-3 mb-5">
          <div class="col-12">
            <h2 class="border-bottom-dotted">
              <b class="text-secondary">Deskripsi & Informasi</b>
            </h2>
          </div>
          <div class="col-12">
            <div class="p-2" style="white-space: pre-line !important;" [innerHTML]="berkasData.description"></div>
          </div>
        </div>
        <div class="row mt-5 mb-3">
          <div class="col-12">
            <app-material-tab></app-material-tab>
          </div>
        </div>
      </div>
    </div>
  
  </div>

</div>

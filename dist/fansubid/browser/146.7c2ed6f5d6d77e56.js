(self.webpackChunkfansubid=self.webpackChunkfansubid||[]).push([[146],{1146:(z,N,h)=>{"use strict";h.r(N),h.d(N,{TorrentModule:()=>$t});var p=h(9808),P=h(8406),U=h(3075),g=h(1777),A=h(4847),w=h(4999),D=h(4327),s=h(5934),n=h(5e3),F=h(7261);class B{constructor(T,o){this._document=o;const c=this._textarea=this._document.createElement("textarea"),_=c.style;_.position="fixed",_.top=_.opacity="0",_.left="-999em",c.setAttribute("aria-hidden","true"),c.value=T,this._document.body.appendChild(c)}copy(){const T=this._textarea;let o=!1;try{if(T){const c=this._document.activeElement;T.select(),T.setSelectionRange(0,T.value.length),o=this._document.execCommand("copy"),c&&c.focus()}}catch(c){}return o}destroy(){const T=this._textarea;T&&(T.remove(),this._textarea=void 0)}}let k=(()=>{class l{constructor(o){this._document=o}copy(o){const c=this.beginCopy(o),_=c.copy();return c.destroy(),_}beginCopy(o){return new B(o,this._document)}}return l.\u0275fac=function(o){return new(o||l)(n.LFG(p.K0))},l.\u0275prov=n.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"}),l})();var W=h(8696),V=h(5861),Z=h(9076),d=h.n(Z),m=h(1135),x=h(8202),C=h(3172),v=h(9731),H=h(2290),O=h(3379);let y=(()=>{class l{constructor(o,c,_,b){this.gs=o,this.api=c,this.toast=_,this.ls=b,this.trackerAnnounce=s.N.trackerAnnounce,this.clientOptions={maxConns:64,tracker:{announce:this.trackerAnnounce,rtcConfig:{iceServers:s.N.iceServers}}},this.torrentsQueue={},this.torrentOptions={announce:this.trackerAnnounce,maxWebConns:16,store:d()},this.webClient=null,this.expandedRow=null,this.tableDataRowSubject=new m.X([]),this.tableDataRow=this.tableDataRowSubject.asObservable(),this.error=null,this.refCallback=null,this.flagResurrected=!1,this.gs.isBrowser&&(this.torrentsQueue=this.ls.getItem(this.gs.localStorageKeys.Torrents,!0)||this.torrentsQueue,WebTorrent.WEBRTC_SUPPORT?(this.webClient=new WebTorrent(this.clientOptions),this.gs.log("[TORRENT_CLIENT_WEB_MODE_INITIALIZED]",this.webClient),this.handleWebClient()):this.toast.error("WebRTC Not Supported!","Whoops! Error."))}get tableDataRowValue(){var o;return(null===(o=this.tableDataRowSubject)||void 0===o?void 0:o.value)||[]}checkHealthOnTracker(o){return this.api.postData("/torrent",o)}handleWebClient(){this.webClient.on("torrent",o=>{this.gs.log("[TORRENT_CLIENT_ADD_TORRENT_FILE]",o),this.toast.info(o.infoHash,"Woaw, Antrian Baru!"),this.tableDataRowValue.push(o),this.tableDataRowSubject.next(this.tableDataRowValue),this.refCallback&&this.refCallback(null,o)}),this.webClient.on("error",o=>{this.gs.log("[TORRENT_CLIENT_ERROR]",o),this.toast.error(o.toString(),"Whoops! Error."),this.error=o,this.refCallback&&this.refCallback(this.error,null)})}handleWebTorrent(o,c){o.on("done",()=>{this.gs.log("[TORRENT_FILE_DONE]",o),this.toast.success("Ada Torrent Yang Sudah Selesai Di Download","Yeay, Selesai!"),this.torrentsQueue[o.infoHash].completed=!0,this.ls.setItem(this.gs.localStorageKeys.Torrents,this.torrentsQueue),c&&c(null,null)}),o.on("warning",_=>{this.gs.log("[TORRENT_FILE_WARNING]",_),this.toast.warning(_.toString(),"Yuhuu! Warning."),c&&c(_,null)}),o.on("error",_=>{this.gs.log("[TORRENT_FILE_ERROR]",_),this.toast.error(_.toString(),"Whoops! Error."),c&&c(_,null)})}handleWebWire(o,c){this.gs.log("[TORRENT_WIRE_CONNECT]",o);let _=o.peerId||"Unknown!";o.remoteAddress&&o.remotePort&&(_=`${o.remoteAddress}:${o.remotePort}`),o.on("close",()=>{this.gs.log("[TORRENT_WIRE_DISCONNECT]",_),c&&c(null,o)}),c&&c(null,o)}resurrectFiles(o){var c=this;if(!this.flagResurrected){this.flagResurrected=!0;for(const _ in this.torrentsQueue)this.gs.log("[TORRENT_CLIENT_QUEUE_RESURRECT]",this.torrentsQueue[_]),this.torrentsQueue[_].completed?(0,x.openDB)(this.torrentsQueue[_].indexedDb,1).then(function(){var b=(0,V.Z)(function*($){const Ot=yield $.transaction("chunks","readonly").objectStore("chunks").getAll(),Wt=C.lW.concat(Ot),Nt=[];for(const Qt of c.torrentsQueue[_].files){const Ct=Qt;Nt.push(new File([Wt.slice(Ct.offset,Ct.offset+Ct.length)],Ct.name))}c.uploadFiles({torrentBerkasName:{inputText:c.torrentsQueue[_].name}},Nt,o)});return function($){return b.apply(this,arguments)}}()).catch(b=>this.gs.log("[INDEXDB-OPEN_FAILED]",b,"error")):this.downloadFiles(this.torrentsQueue[_].infoHash,o,{...this.torrentOptions,name:this.torrentsQueue[_].name})}o(null,null)}processTorrent(o,c,_){o.on("wire",b=>this.handleWebWire(b,_)),this.torrentsQueue[o.infoHash]={completed:c,indexedDb:o.name+" - "+o.infoHash.slice(0,8),infoHash:o.infoHash,name:o.name,files:[]};for(const b of o.files)this.torrentsQueue[o.infoHash].files.push({name:b.name,offset:b.offset,length:b.length});this.ls.setItem(this.gs.localStorageKeys.Torrents,this.torrentsQueue),this.handleWebTorrent(o,_)}downloadFiles(o,c,_=this.torrentOptions){this.gs.log("[TORRENT_CLIENT_QUEUE_DOWNLOAD]",o),this.refCallback=c,this.checkHealthOnTracker({magnetHash:o,trackTimeout:1234}).subscribe({next:b=>{this.gs.log("[TORRENT_CLIENT_HEALTH_SUCCESS]",b.result),b.result.seeds<=0?(this.toast.warning("Tidak Ada Seeder!","Whoops! Error."),c&&c(null,b.result)):this.webClient.add(o,_,$=>{this.gs.log("[TORRENT_FILE_DOWNLOAD_READY]",$),this.toast.info("Memulai Download ...","Download!"),this.processTorrent($,!1,c)})},error:b=>{this.gs.log("[TORRENT_CLIENT_HEALTH_ERROR]",b,"error"),c&&c(b,null)}})}uploadFiles(o,c,_){this.gs.log("[TORRENT_CLIENT_QUEUE_UPLOAD]",c),this.gs.log("[TORRENT_CLIENT_QUEUE_UPLOAD]",o),this.refCallback=_,this.webClient.seed(c,{...this.torrentOptions,name:o.torrentBerkasName.inputText},b=>{this.gs.log("[TORRENT_FILE_SEED_READY]",b),this.toast.info("Memulai Seeding ...","Seeding"),this.processTorrent(b,!0,_)})}removeTorrent(o,c,_=!0){this.tableDataRowSubject.next(this.tableDataRowValue.filter(b=>b.infoHash!==o)),this.webClient.remove(o,{destroyStore:!0},b=>{b&&this.gs.log("[TORRENT_FILE_REMOVE_ERROR]",b),delete this.torrentsQueue[o],_&&this.ls.setItem(this.gs.localStorageKeys.Torrents,this.torrentsQueue),c&&c(b)})}pauseTorrent(o,c){const _=this.webClient.get(o);_&&(_.pause(),c&&c(_))}resumeTorrent(o,c){const _=this.webClient.get(o);_&&(_.resume(),c&&c(_))}removeAll(){for(const o of this.webClient.torrents)this.removeTorrent(o.infoHash,c=>{c||this.gs.log("[TORRENT_FILE_REMOVE_SUCCESS]",o.infoHash)},!1)}}return l.\u0275fac=function(o){return new(o||l)(n.LFG(W.U),n.LFG(v.s),n.LFG(H._W),n.LFG(O.n))},l.\u0275prov=n.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"}),l})();var I=h(7845),L=h(8381),q=h(3e3);let X=(()=>{class l{constructor(){this.fileDropped=new n.vpe}onDragOver(o){o.preventDefault(),o.stopPropagation(),this.fileOver=!0}onDragLeave(o){o.preventDefault(),o.stopPropagation(),this.fileOver=!1}ondrop(o){o.preventDefault(),o.stopPropagation(),this.fileOver=!1;let c=o.dataTransfer.files;c.length>0&&this.fileDropped.emit(c)}}return l.\u0275fac=function(o){return new(o||l)},l.\u0275dir=n.lG2({type:l,selectors:[["","appDragDrop",""]],hostVars:2,hostBindings:function(o,c){1&o&&n.NdJ("dragover",function(b){return c.onDragOver(b)})("dragleave",function(b){return c.onDragLeave(b)})("drop",function(b){return c.ondrop(b)}),2&o&&n.ekj("fileover",c.fileOver)},outputs:{fileDropped:"fileDropped"}}),l})();var tt=h(8616),K=h(7322),ot=h(7531),nt=h(5245),lt=h(5899),ut=h(7238),It=h(7423),j=h(4623),et=h(3626);function mt(l,T){1&l&&n._UZ(0,"mat-progress-bar",26)}function gt(l,T){1&l&&(n.TgZ(0,"span"),n._uU(1,"\u{1f516} NAME"),n.qZA()),2&l&&n.Udp("color","#ff4081")}function _t(l,T){1&l&&(n.TgZ(0,"span"),n._uU(1,"\u{1f4be} SIZE"),n.qZA()),2&l&&n.Udp("color","#ff4081")}function xt(l,T){1&l&&(n.TgZ(0,"span"),n._uU(1,"\u{1f4bf} DOWNLOADED"),n.qZA()),2&l&&n.Udp("color","#ff4081")}function yt(l,T){1&l&&(n.TgZ(0,"span"),n._uU(1,"\u{1f4c0} UPLOADED"),n.qZA()),2&l&&n.Udp("color","#ff4081")}function st(l,T){1&l&&(n.TgZ(0,"span"),n._uU(1,"\u{1f504} PROGRESS"),n.qZA()),2&l&&n.Udp("color","#ff4081")}function ft(l,T){1&l&&(n.TgZ(0,"span"),n._uU(1,"\u{1f53d} SPEED"),n.qZA()),2&l&&n.Udp("color","#ff4081")}function Et(l,T){1&l&&(n.TgZ(0,"span"),n._uU(1,"\u{1f53c} SPEED"),n.qZA()),2&l&&n.Udp("color","#ff4081")}function Dt(l,T){1&l&&(n.TgZ(0,"span"),n._uU(1,"\u{1f551} ~ETA."),n.qZA()),2&l&&n.Udp("color","#ff4081")}function Tt(l,T){1&l&&(n.TgZ(0,"span"),n._uU(1,"\u{1f9f2} PEERS"),n.qZA()),2&l&&n.Udp("color","#ff4081")}function at(l,T){1&l&&(n.TgZ(0,"span"),n._uU(1,"\u{1f310} RATIO"),n.qZA()),2&l&&n.Udp("color","#ff4081")}function ct(l,T){if(1&l&&(n.TgZ(0,"th",30)(1,"h3",31),n.YNc(2,gt,2,2,"span",32),n.YNc(3,_t,2,2,"span",32),n.YNc(4,xt,2,2,"span",32),n.YNc(5,yt,2,2,"span",32),n.YNc(6,st,2,2,"span",32),n.YNc(7,ft,2,2,"span",32),n.YNc(8,Et,2,2,"span",32),n.YNc(9,Dt,2,2,"span",32),n.YNc(10,Tt,2,2,"span",32),n.YNc(11,at,2,2,"span",32),n.qZA()()),2&l){const o=n.oxw().$implicit;n.xp6(2),n.Q6J("ngIf","NAME"===o.toUpperCase()),n.xp6(1),n.Q6J("ngIf","LENGTH"===o.toUpperCase()),n.xp6(1),n.Q6J("ngIf","DOWNLOADED"===o.toUpperCase()),n.xp6(1),n.Q6J("ngIf","UPLOADED"===o.toUpperCase()),n.xp6(1),n.Q6J("ngIf","PROGRESS"===o.toUpperCase()),n.xp6(1),n.Q6J("ngIf","DOWNLOADSPEED"===o.toUpperCase()),n.xp6(1),n.Q6J("ngIf","UPLOADSPEED"===o.toUpperCase()),n.xp6(1),n.Q6J("ngIf","TIMEREMAINING"===o.toUpperCase()),n.xp6(1),n.Q6J("ngIf","NUMPEERS"===o.toUpperCase()),n.xp6(1),n.Q6J("ngIf","RATIO"===o.toUpperCase())}}function Rt(l,T){if(1&l&&(n.TgZ(0,"span"),n._uU(1),n.qZA()),2&l){const o=n.oxw().$implicit,c=n.oxw().$implicit;n.xp6(1),n.Oqu(o[c])}}function At(l,T){if(1&l&&(n.TgZ(0,"span"),n._uU(1),n.ALo(2,"bytes"),n.qZA()),2&l){const o=n.oxw().$implicit,c=n.oxw().$implicit;n.xp6(1),n.Oqu(n.lcZ(2,1,o[c]))}}function ht(l,T){if(1&l&&(n.TgZ(0,"span"),n._uU(1),n.ALo(2,"bytes"),n.qZA()),2&l){const o=n.oxw().$implicit,c=n.oxw().$implicit;n.xp6(1),n.Oqu(n.lcZ(2,1,o[c]))}}function Bt(l,T){if(1&l&&(n.TgZ(0,"span"),n._uU(1),n.ALo(2,"bytes"),n.qZA()),2&l){const o=n.oxw().$implicit,c=n.oxw().$implicit;n.xp6(1),n.Oqu(n.lcZ(2,1,o[c]))}}function bt(l,T){if(1&l&&(n.TgZ(0,"span"),n._uU(1),n.ALo(2,"number"),n.qZA()),2&l){const o=n.oxw().$implicit;n.xp6(1),n.hij("",n.xi3(2,1,o.downloaded/o.length*100,"1.2-2")," %")}}function wt(l,T){if(1&l&&(n.TgZ(0,"span"),n._uU(1),n.ALo(2,"bytes"),n.qZA()),2&l){const o=n.oxw().$implicit,c=n.oxw().$implicit;n.xp6(1),n.hij("",n.lcZ(2,1,o[c]),"/s")}}function pt(l,T){if(1&l&&(n.TgZ(0,"span"),n._uU(1),n.ALo(2,"bytes"),n.qZA()),2&l){const o=n.oxw().$implicit,c=n.oxw().$implicit;n.xp6(1),n.hij("",n.lcZ(2,1,o[c]),"/s")}}function rt(l,T){if(1&l&&(n.TgZ(0,"span"),n._uU(1),n.ALo(2,"number"),n.qZA()),2&l){const o=n.oxw().$implicit,c=n.oxw().$implicit;n.xp6(1),n.Oqu(o[c]<=0?"COMPLETED":n.xi3(2,1,o[c]/1e3,"1.0-0")+" s")}}function dt(l,T){if(1&l&&(n.TgZ(0,"span"),n._uU(1),n.qZA()),2&l){const o=n.oxw().$implicit,c=n.oxw().$implicit;n.xp6(1),n.Oqu(o[c])}}function vt(l,T){if(1&l&&(n.TgZ(0,"span"),n._uU(1),n.ALo(2,"number"),n.qZA()),2&l){const o=n.oxw().$implicit,c=n.oxw().$implicit;n.xp6(1),n.Oqu(n.xi3(2,1,o[c],"1.4-4"))}}function it(l,T){if(1&l&&(n.TgZ(0,"td",33)(1,"h3"),n.YNc(2,Rt,2,1,"span",34),n.YNc(3,At,3,3,"span",34),n.YNc(4,ht,3,3,"span",34),n.YNc(5,Bt,3,3,"span",34),n.YNc(6,bt,3,4,"span",34),n.YNc(7,wt,3,3,"span",34),n.YNc(8,pt,3,3,"span",34),n.YNc(9,rt,3,4,"span",34),n.YNc(10,dt,2,1,"span",34),n.YNc(11,vt,3,4,"span",34),n.qZA()()),2&l){const o=n.oxw().$implicit;n.xp6(1),n.Gre("m-0 ","NAME"===o.toUpperCase()?"text-start":"",""),n.xp6(1),n.Q6J("ngIf","NAME"===o.toUpperCase()),n.xp6(1),n.Q6J("ngIf","LENGTH"===o.toUpperCase()),n.xp6(1),n.Q6J("ngIf","DOWNLOADED"===o.toUpperCase()),n.xp6(1),n.Q6J("ngIf","UPLOADED"===o.toUpperCase()),n.xp6(1),n.Q6J("ngIf","PROGRESS"===o.toUpperCase()),n.xp6(1),n.Q6J("ngIf","DOWNLOADSPEED"===o.toUpperCase()),n.xp6(1),n.Q6J("ngIf","UPLOADSPEED"===o.toUpperCase()),n.xp6(1),n.Q6J("ngIf","TIMEREMAINING"===o.toUpperCase()),n.xp6(1),n.Q6J("ngIf","NUMPEERS"===o.toUpperCase()),n.xp6(1),n.Q6J("ngIf","RATIO"===o.toUpperCase())}}function Ut(l,T){1&l&&(n.ynx(0,27),n.YNc(1,ct,12,10,"th",28),n.YNc(2,it,12,13,"td",29),n.BQk()),2&l&&n.s9C("matColumnDef",T.$implicit)}function r(l,T){if(1&l&&(n.TgZ(0,"p",41),n._uU(1," Info Hash :: "),n.TgZ(2,"span",52),n._uU(3),n.qZA()()),2&l){const o=n.oxw().$implicit;n.xp6(3),n.hij(" ",o.infoHash," ")}}function t(l,T){if(1&l){const o=n.EpF();n.TgZ(0,"p",41),n._uU(1," Magnet URI :: "),n.TgZ(2,"span",53),n.NdJ("click",function(){n.CHM(o);const _=n.oxw().$implicit;return n.oxw().copyMagnetHashToClipboard(_.magnetURI)}),n._uU(3),n.qZA()()}if(2&l){const o=n.oxw().$implicit;n.xp6(3),n.hij(" ",o.magnetURI," ")}}function e(l,T){if(1&l&&(n.TgZ(0,"li"),n._uU(1),n.qZA()),2&l){const o=T.$implicit;n.xp6(1),n.hij(" ",o," ")}}function i(l,T){if(1&l){const o=n.EpF();n.TgZ(0,"button",45),n.NdJ("click",function(){n.CHM(o);const _=n.oxw().$implicit;return n.oxw().resumeTorrent(_)}),n.TgZ(1,"mat-icon",46),n._uU(2,"play_arrow"),n.qZA(),n._uU(3," Resume "),n.qZA()}}function a(l,T){if(1&l){const o=n.EpF();n.TgZ(0,"button",45),n.NdJ("click",function(){n.CHM(o);const _=n.oxw().$implicit;return n.oxw().pauseTorrent(_)}),n.TgZ(1,"mat-icon",46),n._uU(2,"pause"),n.qZA(),n._uU(3," Pause "),n.qZA()}}function u(l,T){if(1&l){const o=n.EpF();n.TgZ(0,"mat-list-option",54)(1,"mat-icon",55),n._uU(2,"file_present"),n.qZA(),n.TgZ(3,"div",56),n.NdJ("click",function(){const b=n.CHM(o).$implicit;return n.oxw(2).saveFile(b)}),n.TgZ(4,"span"),n._uU(5),n.qZA(),n._uU(6," -- "),n.TgZ(7,"span",57),n._uU(8),n.ALo(9,"number"),n.qZA(),n._uU(10," :: "),n.TgZ(11,"span",52),n._uU(12),n.ALo(13,"bytes"),n.ALo(14,"bytes"),n.qZA()()()}if(2&l){const o=T.$implicit;n.xp6(4),n.Gre("text-",o.downloaded/o.length>=1?"primary":"bifeldy",""),n.xp6(1),n.hij(" ",o.name," "),n.xp6(3),n.hij(" ",n.xi3(9,7,o.downloaded/o.length*100,"1.2-2")," % "),n.xp6(4),n.AsE(" ",n.lcZ(13,10,o.downloaded)," / ",n.lcZ(14,12,o.length)," ")}}function f(l,T){if(1&l){const o=n.EpF();n.TgZ(0,"td",35)(1,"div",36)(2,"div",37)(3,"div",38),n._UZ(4,"div"),n.qZA(),n.TgZ(5,"div",39),n.YNc(6,r,4,1,"p",40),n.YNc(7,t,4,1,"p",40),n.TgZ(8,"div",41),n._uU(9," Announce Trackers :: "),n.TgZ(10,"ul",42),n.YNc(11,e,2,1,"li",43),n.qZA()(),n.TgZ(12,"div",44)(13,"button",45),n.NdJ("click",function(){const b=n.CHM(o).$implicit;return n.oxw().refreshGraph(b)}),n.TgZ(14,"mat-icon",46),n._uU(15,"refresh"),n.qZA(),n._uU(16," Refresh Graph "),n.qZA(),n.TgZ(17,"button",45),n.NdJ("click",function(){const b=n.CHM(o).$implicit;return n.oxw().removeTorrent(b)}),n.TgZ(18,"mat-icon",46),n._uU(19,"delete_outline"),n.qZA(),n._uU(20," Remove "),n.qZA(),n.YNc(21,i,4,0,"button",47),n.YNc(22,a,4,0,"button",47),n.qZA(),n.TgZ(23,"div",48)(24,"div",49),n._uU(25,"Rincian Isi Berkas \u2728"),n.qZA(),n.TgZ(26,"mat-selection-list",50),n.YNc(27,u,15,14,"mat-list-option",51),n.qZA()()()()()()}if(2&l){const o=T.$implicit,c=n.oxw();n.uIk("colspan",c.tableDataColumn.length),n.xp6(1),n.Q6J("@detailExpand",o===c.TORRENT.expandedRow?"expanded":"collapsed"),n.xp6(3),n.Gre("p2p-graph graphP2p-",o.infoHash,""),n.xp6(2),n.Q6J("ngIf",o.infoHash),n.xp6(1),n.Q6J("ngIf",o.magnetURI),n.xp6(4),n.Q6J("ngForOf",o.announce),n.xp6(10),n.Q6J("ngIf",o.paused),n.xp6(1),n.Q6J("ngIf",!o.paused),n.xp6(4),n.Q6J("multiple",!1),n.xp6(1),n.Q6J("ngForOf",o.files)}}function S(l,T){1&l&&n._UZ(0,"tr",58)}function Y(l,T){if(1&l){const o=n.EpF();n.TgZ(0,"tr",59),n.NdJ("click",function(){const b=n.CHM(o).$implicit;return n.oxw().toggleExpanded(b)}),n.qZA()}if(2&l){const o=T.$implicit,c=n.oxw();n.ekj("expanded-row",c.TORRENT.expandedRow===o)}}function Q(l,T){1&l&&n._UZ(0,"tr",60)}function J(l,T){if(1&l&&(n.TgZ(0,"tr",61)(1,"td",62)(2,"div",63)(3,"div",64)(4,"h3",31),n._uU(5," Tidak Ada Data \xaf\\_(\u30c4)_/\xaf "),n.qZA()()()()()),2&l){const o=n.oxw();n.xp6(1),n.uIk("colspan",o.tableDataColumn.length)}}const G=function(){return["expandedDetail"]};let Mt=(()=>{class l{constructor(o,c,_,b,$,Ft,Lt,Ot){this.snackBar=o,this.clipboard=c,this.gs=_,this.torrent=b,this.toast=$,this.ds=Ft,this.ss=Lt,this.bs=Ot,this.isProcessing=!1,this.magnetHash=null,this.torrentsGraph={},this.tableDataColumn=["name","length","downloaded","uploaded","progress","downloadSpeed","uploadSpeed","timeRemaining","numPeers","ratio"],this.files=[],this.subsDialog=null,this.subsUser=null,this.subsTableDataRow=null,this.timedOut=null,this.gs.bannerImg=null,this.gs.sizeContain=!1,this.gs.bgRepeat=!1}get ENV(){return s.N}get TORRENT(){return this.torrent}ngOnInit(){this.dataSource=new w.by,this.gs.isBrowser&&(this.dataSource.sort=this.sort,this.subsTableDataRow=this.torrent.tableDataRow.subscribe({next:o=>{this.dataSource.data=o,this.refreshAllGraph()}}),this.reviveTorrent())}ngOnDestroy(){var o,c,_,b,$;null===(c=null===(o=this.sort)||void 0===o?void 0:o.sortChange)||void 0===c||c.unsubscribe(),null===(_=this.subsDialog)||void 0===_||_.unsubscribe(),null===(b=this.subsUser)||void 0===b||b.unsubscribe(),null===($=this.subsTableDataRow)||void 0===$||$.unsubscribe(),this.timedOut&&(clearTimeout(this.timedOut),this.timedOut=null)}copyMagnetHashToClipboard(o){this.clipboard.copy(o)&&this.snackBar.open("Link Magnet Hash Berhasil Disalin!")}toggleExpanded(o){this.gs.log("[TORRENT_CLICKED]",o),this.torrent.expandedRow=this.torrent.expandedRow===o?null:o,this.refreshGraph(o)}saveFile(o){o.downloaded/o.length>=1?(this.bs.busy(),o.getBlobURL((c,_)=>{c||(this.gs.log("[TORRENT_FILE_BLOBURL]",_),(0,D.saveAs)(_,o.name),this.bs.idle())})):this.toast.info("Berkas Sedang Dalam Proses Unduhan!","Yah, File Belum Siap!")}reviveTorrent(){this.torrent.resurrectFiles((o,c)=>{this.refreshAllGraph()})}resumeTorrent(o){this.torrent.resumeTorrent(o.infoHash,c=>{this.refreshAllGraph()})}pauseTorrent(o){this.torrent.pauseTorrent(o.infoHash,c=>{c||this.gs.log("[TORRENT_FILE_PAUSE_SUCCESS]",o.infoHash),this.refreshAllGraph()})}removeTorrent(o){this.torrent.removeTorrent(o.infoHash,c=>{c||this.gs.log("[TORRENT_FILE_REMOVE_SUCCESS]",o.infoHash),this.torrentsGraph[o.infoHash].destroy(),delete this.torrentsGraph[o.infoHash],this.refreshAllGraph()})}downloadFiles(o){this.isProcessing=!0,this.torrent.downloadFiles(this.magnetHash,(c,_)=>{this.magnetHash=null,this.isProcessing=!1,this.refreshAllGraph()})}uploadFiles(o){this.gs.log("[TORRENT_SEED_USER_INFORMATION]",o),this.isProcessing=!0,this.torrent.uploadFiles(o,this.files,(c,_)=>{this.isProcessing=!1,this.refreshAllGraph()})}prepareFilesList(o){this.files=[];for(const _ of o)this.files.push(_);const c={torrentBerkasName:{inputLabel:"Nama Torrent",inputText:`Torrent # ${this.ss.mySocket.id} @ ${(new Date).toUTCString()}`}};1===this.files.length?(c.torrentBerkasName.inputText=this.files[0].name,this.uploadFiles(c)):this.files.length>1&&(this.subsDialog=this.ds.openInputDialog({data:{title:"Silahkan Masukkan Nama Untuk Torrent Kamu!",input:c,confirmText:"Ya, Mulai SEED",cancelText:"Tidak, Batal"},disableClose:!0}).afterClosed().subscribe({next:_=>{this.gs.log("[INPUT_DIALOG_CLOSED]",_),_&&this.uploadFiles(_),this.subsDialog.unsubscribe()}}))}onFileDropped(o){this.prepareFilesList(o)}fileBrowseHandler(o){this.prepareFilesList(o.target.files)}initGraph(o){!this.torrentsGraph[o.infoHash]&&this.dataSource.data.length>0&&(this.gs.log("[TORRENT_WIRE_INIT_GRAPH]",o),this.torrentsGraph[o.infoHash]=new P2PGraph(`.graphP2p-${o.infoHash}`),this.torrentsGraph[o.infoHash].add({id:this.torrent.webClient.peerId,me:!0,name:"Kamu!"}))}addAllGraph(o){this.gs.log("[TORRENT_WIRE_RELOAD_GRAPH]",o);for(const c of o.wires){let _=c.peerId||"Anonim!";c.remoteAddress&&c.remotePort&&(_=`${c.remoteAddress}:${c.remotePort}`),this.torrentsGraph[o.infoHash].add({id:c.peerId,name:_}),this.torrentsGraph[o.infoHash].connect(this.torrent.webClient.peerId,c.peerId)}}deleteAllGraph(o){this.gs.log("[TORRENT_WIRE_DELETE_GRAPH]",o);const c=this.torrentsGraph[o.infoHash].list().filter(_=>_.id!==this.torrent.webClient.peerId);for(const _ of c)this.torrentsGraph[o.infoHash].disconnect(this.torrent.webClient.peerId,_.id),this.torrentsGraph[o.infoHash].remove(_.id)}refreshGraph(o){this.gs.log("[TORRENT_WIRE_REFRESH_GRAPH]",o),this.torrentsGraph[o.infoHash]?(this.deleteAllGraph(o),this.addAllGraph(o)):this.initGraph(o)}refreshAllGraph(){for(const o of this.dataSource.data)this.timedOut=setTimeout(()=>{this.refreshGraph(o)},1234)}}return l.\u0275fac=function(o){return new(o||l)(n.Y36(F.ux),n.Y36(k),n.Y36(W.U),n.Y36(y),n.Y36(H._W),n.Y36(I.x),n.Y36(L.R),n.Y36(q.z))},l.\u0275cmp=n.Xpm({type:l,selectors:[["app-torrent"]],viewQuery:function(o,c){if(1&o&&n.Gf(A.YE,7),2&o){let _;n.iGM(_=n.CRH())&&(c.sort=_.first)}},decls:37,vars:13,consts:[["appDragDrop","",1,"h-100",3,"fileDropped"],[1,"container"],[1,"row","pb-3","px-0"],[1,"col-12"],[1,"row"],[1,"col-12","sticky-top","bg-bifeldy"],[1,"pt-3","border-bottom-dotted"],[1,"text-bifeldy"],["hintLabel","Isi Lalu Tekan 'Enter' Untuk Mencari Torrent ...",1,"col-12","col-md-6","col-lg-4","px-3","mb-3",3,"color"],["matInput","","placeholder","Ex. magnet:123qwe...!@#",3,"ngModel","disabled","keyup.enter","ngModelChange"],["input",""],["matSuffix",""],["color","warn","mode","indeterminate",4,"ngIf"],[1,"row","mx-2"],[1,"col-12",2,"overflow-x","auto"],["mat-table","","matSort","","multiTemplateDataRows","",1,"bg-transparent",3,"dataSource"],[3,"matColumnDef",4,"ngFor","ngForOf"],["matColumnDef","expandedDetail"],["mat-cell","",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","","class","element-row",3,"expanded-row","click",4,"matRowDef","matRowDefColumns"],["mat-row","","class","detail-row",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["type","file","id","fileDropRef","multiple","",2,"visibility","hidden",3,"disabled","change"],["fileDropRef",""],["mat-fab","","color","warn","matTooltip","Seed Berkas",1,"me-3","mb-5","fab-button","animate__animated","animate__bounce","animate__infinite","animate__slow",2,"position","fixed","bottom","0","right","0",3,"disabled","click"],["color","warn","mode","indeterminate"],[3,"matColumnDef"],["mat-header-cell","","class","px-3 text-center","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","","class","px-3 text-center","style","cursor: pointer;",4,"matCellDef"],["mat-header-cell","","mat-sort-header","",1,"px-3","text-center"],[1,"m-0"],[3,"color",4,"ngIf"],["mat-cell","",1,"px-3","text-center",2,"cursor","pointer"],[4,"ngIf"],["mat-cell",""],[1,"element-detail"],[1,"py-3","row"],[1,"col-3"],[1,"col-9"],["class","px-2 text-truncate",4,"ngIf"],[1,"px-2","text-truncate"],[1,"text-success","m-0"],[4,"ngFor","ngForOf"],[1,"p-2"],["mat-stroked-button","",1,"m-1","text-warning",3,"click"],[1,"me-1"],["mat-stroked-button","","class","m-1 text-warning",3,"click",4,"ngIf"],[1,"px-2"],["mat-subheader","",1,"p-0"],[3,"multiple"],["class","h-100",4,"ngFor","ngForOf"],[1,"text-success"],["matTooltip","Klik Untuk Menyalin!",1,"text-primary","text-decoration-none",3,"click"],[1,"h-100"],["mat-list-icon","",1,"ps-3"],[2,"cursor","pointer",3,"click"],[1,"text-warning"],["mat-header-row",""],["mat-row","",1,"element-row",3,"click"],["mat-row","",1,"detail-row"],[1,"mat-row"],[1,"mat-cell","text-center","align-items-center","p-0",2,"background-image","url('/assets/img/404-no-data.png')","background-size","contain","background-position","center","background-repeat","no-repeat","height","256px"],[1,"row","align-items-center","h-100"],[1,"col-8","mx-auto","text-light","text-center","rounded","py-3",2,"background-color","rgba(128, 128, 128, 0.875)"]],template:function(o,c){if(1&o){const _=n.EpF();n.TgZ(0,"div",0),n.NdJ("fileDropped",function($){return c.onFileDropped($)}),n._UZ(1,"app-notifications"),n.TgZ(2,"div",1)(3,"div",2)(4,"div",3)(5,"div",4)(6,"div",5)(7,"h2",6)(8,"b",7),n._uU(9,"Web-SocketRTC Torrent"),n.qZA()()(),n.TgZ(10,"div",3)(11,"mat-form-field",8)(12,"mat-label"),n._uU(13,"Unduh Dari Info Hash / Magnet URI"),n.qZA(),n.TgZ(14,"input",9,10),n.NdJ("keyup.enter",function($){return c.downloadFiles($)})("ngModelChange",function($){return c.magnetHash=$}),n.qZA(),n.TgZ(16,"mat-icon",11),n._uU(17,"cloud_download"),n.qZA(),n.YNc(18,mt,1,0,"mat-progress-bar",12),n.qZA(),n.TgZ(19,"div",13)(20,"div",14)(21,"table",15),n.YNc(22,Ut,3,1,"ng-container",16),n.ynx(23,17),n.YNc(24,f,28,12,"td",18),n.BQk(),n.YNc(25,S,1,0,"tr",19),n.YNc(26,Y,1,2,"tr",20),n.YNc(27,Q,1,0,"tr",21),n.YNc(28,J,6,1,"tr",22),n.qZA()(),n.TgZ(29,"div",3)(30,"marquee"),n._uU(31),n.qZA()()()()()()()(),n.TgZ(32,"input",23,24),n.NdJ("change",function($){return c.fileBrowseHandler($)}),n.qZA(),n.TgZ(34,"button",25),n.NdJ("click",function(){return n.CHM(_),n.MAs(33).click()}),n.TgZ(35,"mat-icon"),n._uU(36,"cloud_upload"),n.qZA()()()}2&o&&(n.xp6(11),n.Q6J("color","accent"),n.xp6(3),n.Q6J("ngModel",c.magnetHash)("disabled",c.isProcessing),n.xp6(4),n.Q6J("ngIf",c.isProcessing),n.xp6(3),n.Q6J("dataSource",c.dataSource),n.xp6(1),n.Q6J("ngForOf",c.tableDataColumn),n.xp6(3),n.Q6J("matHeaderRowDef",c.tableDataColumn),n.xp6(1),n.Q6J("matRowDefColumns",c.tableDataColumn),n.xp6(1),n.Q6J("matRowDefColumns",n.DdM(12,G)),n.xp6(4),n.hij("Terhubung Dengan Tracker :: ",c.ENV.trackerAnnounce.join(" :: "),""),n.xp6(1),n.Q6J("disabled",c.isProcessing),n.xp6(2),n.Q6J("disabled",c.isProcessing))},directives:[X,tt.t,K.KE,K.hX,ot.Nt,U.Fj,U.JJ,U.On,nt.Hw,K.R9,p.O5,lt.pW,w.BZ,A.YE,p.sg,w.w1,w.fO,w.ge,A.nU,w.Dz,w.ev,ut.gM,It.lW,j.gs,j.Ub,j.vS,j.Nh,w.as,w.XQ,w.nj,w.Gk,w.Ee],pipes:[et.$,p.JJ],styles:[".p2p-graph[_ngcontent-%COMP%]{background-color:#8d8d8d80!important}tr.detail-row[_ngcontent-%COMP%]{height:0}tr.element-row[_ngcontent-%COMP%]:not(.expanded-row):hover{background-color:#ffffffdf}.element-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-bottom-width:0}.element-detail[_ngcontent-%COMP%]{overflow:hidden;display:flex}.fileover[_ngcontent-%COMP%]{animation:shake 1s;animation-iteration-count:infinite}@keyframes shake{0%{transform:translate(1px,1px) rotate(0)}10%{transform:translate(-1px,-2px) rotate(-1deg)}20%{transform:translate(-3px) rotate(1deg)}30%{transform:translate(3px,2px) rotate(0)}40%{transform:translate(1px,-1px) rotate(1deg)}50%{transform:translate(-1px,2px) rotate(-1deg)}60%{transform:translate(-3px,1px) rotate(0)}70%{transform:translate(3px,1px) rotate(-1deg)}80%{transform:translate(-1px,-1px) rotate(1deg)}90%{transform:translate(1px,2px) rotate(0)}to{transform:translate(1px,-2px) rotate(-1deg)}}"],data:{animation:[(0,g.X$)("detailExpand",[(0,g.SB)("collapsed",(0,g.oB)({height:"0px",minHeight:"0"})),(0,g.SB)("expanded",(0,g.oB)({height:"*"})),(0,g.eR)("expanded <=> collapsed",(0,g.jt)("225ms cubic-bezier(0.4, 0.0, 0.2, 1)"))])]}}),l})();var St=h(210),Pt=h(7355),Zt=h(8613),kt=h(4946),Ht=h(7956);const Gt=[{path:"",pathMatch:"full",component:Mt}];let $t=(()=>{class l{}return l.\u0275fac=function(o){return new(o||l)},l.\u0275mod=n.oAB({type:l}),l.\u0275inj=n.cJS({imports:[[p.ez,P.Bz.forChild(Gt),U.u5,Ht.C,Zt.F,St.m,kt.P,Pt.T]]}),l})()},4946:(z,N,h)=>{"use strict";h.d(N,{P:()=>g});var p=h(9808),P=h(210),U=h(5e3);let g=(()=>{class A{}return A.\u0275fac=function(D){return new(D||A)},A.\u0275mod=U.oAB({type:A}),A.\u0275inj=U.cJS({imports:[[p.ez,P.m]]}),A})()},8616:(z,N,h)=>{"use strict";h.d(N,{t:()=>F});var p=h(5e3),P=h(8406),U=h(8696),g=h(7140),A=h(9808);function w(B,k){if(1&B&&p._UZ(0,"div",4),2&B){const E=p.oxw();p.Udp("background-size",E.GS.sizeContain?"contain":"cover")("background-image","url("+E.GS.bannerImg+")")("background-repeat",E.GS.bgRepeat?"repeat-x":"no-repeat")("height","/home"===E.ROUTER.url||"/berkas"===E.ROUTER.url?"192px":"128px")("background-position-y","/berkas"===E.ROUTER.url?"22.5%":"")}}function D(B,k){if(1&B&&(p.TgZ(0,"strong",10),p._uU(1," -- "),p.TgZ(2,"i")(3,"a",11),p._uU(4),p.qZA()()()),2&B){const E=p.oxw().$implicit;p.xp6(3),p.MGl("routerLink","/user/",E.notifCreator,""),p.xp6(1),p.hij(" ",E.notifCreator," ")}}function s(B,k){if(1&B){const E=p.EpF();p.TgZ(0,"button",12),p.NdJ("click",function(){p.CHM(E);const M=p.oxw().$implicit;return p.oxw().removeNotif(M.notifData.id)}),p.qZA()}}function n(B,k){if(1&B&&(p.TgZ(0,"div",5)(1,"div")(2,"strong",6),p._uU(3),p.qZA(),p._UZ(4,"span",7),p.YNc(5,D,5,2,"strong",8),p.YNc(6,s,1,0,"button",9),p.qZA()()),2&B){const E=k.$implicit;p.xp6(1),p.Gre("alert alert-",E.notifData.type," alert-dismissible fade show"),p.xp6(2),p.Oqu(E.notifData.title),p.xp6(1),p.Q6J("innerHTML",E.notifData.content,p.oJD),p.xp6(1),p.Q6J("ngIf",E.notifCreator),p.xp6(1),p.Q6J("ngIf",E.notifData.dismissible)}}let F=(()=>{class B{constructor(E,R,M){this.router=E,this.gs=R,this.notif=M}ngOnInit(){}get GS(){return this.gs}get ROUTER(){return this.router}get NOTIF(){return this.notif}removeNotif(E){this.notif.removeNotif(E)}}return B.\u0275fac=function(E){return new(E||B)(p.Y36(P.F0),p.Y36(U.U),p.Y36(g.T))},B.\u0275cmp=p.Xpm({type:B,selectors:[["app-notifications"]],decls:4,vars:2,consts:[["class","container-fluid notif-banner align-items-center",3,"background-size","background-image","background-repeat","height","background-position-y",4,"ngIf"],[1,"container"],[1,"row","pt-3"],["class","col-12",4,"ngFor","ngForOf"],[1,"container-fluid","notif-banner","align-items-center"],[1,"col-12"],[1,"me-1"],[3,"innerHTML"],["class","ms-1",4,"ngIf"],["type","button","class","btn-close","data-dismiss","alert",3,"click",4,"ngIf"],[1,"ms-1"],[1,"text-decoration-none",3,"routerLink"],["type","button","data-dismiss","alert",1,"btn-close",3,"click"]],template:function(E,R){1&E&&(p.YNc(0,w,1,10,"div",0),p.TgZ(1,"div",1)(2,"div",2),p.YNc(3,n,7,7,"div",3),p.qZA()()),2&E&&(p.Q6J("ngIf",R.GS.bannerImg&&("/home"===R.ROUTER.url||"/berkas"===R.ROUTER.url||"/fansub"===R.ROUTER.url||"/berkas"===R.ROUTER.url||"/anime"===R.ROUTER.url||R.ROUTER.url.includes("/anime?")||"/dorama"===R.ROUTER.url||R.ROUTER.url.includes("/dorama?"))),p.xp6(3),p.Q6J("ngForOf",R.NOTIF.notifications))},directives:[A.O5,A.sg,P.yS],styles:[".notif-banner[_ngcontent-%COMP%]{width:100%;background-size:cover;background-position:75% 50%;background-image:url(/assets/img/home-banner.png)}"]}),B})()},8613:(z,N,h)=>{"use strict";h.d(N,{F:()=>g});var p=h(9808),P=h(8406),U=h(5e3);let g=(()=>{class A{}return A.\u0275fac=function(D){return new(D||A)},A.\u0275mod=U.oAB({type:A}),A.\u0275inj=U.cJS({imports:[[p.ez,P.Bz]]}),A})()},7956:(z,N,h)=>{"use strict";h.d(N,{C:()=>U});var p=h(9808),P=h(5e3);let U=(()=>{class g{}return g.\u0275fac=function(w){return new(w||g)},g.\u0275mod=P.oAB({type:g}),g.\u0275inj=P.cJS({imports:[[p.ez]]}),g})()},7355:(z,N,h)=>{"use strict";h.d(N,{T:()=>U});var p=h(9808),P=h(5e3);let U=(()=>{class g{}return g.\u0275fac=function(w){return new(w||g)},g.\u0275mod=P.oAB({type:g}),g.\u0275inj=P.cJS({imports:[[p.ez]]}),g})()},5343:(z,N)=>{"use strict";N.byteLength=function D(E){var R=w(E),W=R[1];return 3*(R[0]+W)/4-W},N.toByteArray=function n(E){var R,x,M=w(E),W=M[0],V=M[1],Z=new P(function s(E,R,M){return 3*(R+M)/4-M}(0,W,V)),d=0,m=V>0?W-4:W;for(x=0;x<m;x+=4)R=p[E.charCodeAt(x)]<<18|p[E.charCodeAt(x+1)]<<12|p[E.charCodeAt(x+2)]<<6|p[E.charCodeAt(x+3)],Z[d++]=R>>16&255,Z[d++]=R>>8&255,Z[d++]=255&R;return 2===V&&(R=p[E.charCodeAt(x)]<<2|p[E.charCodeAt(x+1)]>>4,Z[d++]=255&R),1===V&&(R=p[E.charCodeAt(x)]<<10|p[E.charCodeAt(x+1)]<<4|p[E.charCodeAt(x+2)]>>2,Z[d++]=R>>8&255,Z[d++]=255&R),Z},N.fromByteArray=function k(E){for(var R,M=E.length,W=M%3,V=[],Z=16383,d=0,m=M-W;d<m;d+=Z)V.push(B(E,d,d+Z>m?m:d+Z));return 1===W?V.push(h[(R=E[M-1])>>2]+h[R<<4&63]+"=="):2===W&&V.push(h[(R=(E[M-2]<<8)+E[M-1])>>10]+h[R>>4&63]+h[R<<2&63]+"="),V.join("")};for(var h=[],p=[],P="undefined"!=typeof Uint8Array?Uint8Array:Array,U="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",g=0,A=U.length;g<A;++g)h[g]=U[g],p[U.charCodeAt(g)]=g;function w(E){var R=E.length;if(R%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var M=E.indexOf("=");return-1===M&&(M=R),[M,M===R?0:4-M%4]}function F(E){return h[E>>18&63]+h[E>>12&63]+h[E>>6&63]+h[63&E]}function B(E,R,M){for(var V=[],Z=R;Z<M;Z+=3)V.push(F((E[Z]<<16&16711680)+(E[Z+1]<<8&65280)+(255&E[Z+2])));return V.join("")}p["-".charCodeAt(0)]=62,p["_".charCodeAt(0)]=63},3172:(z,N,h)=>{"use strict";const P=h(5343),U=h(8461),g="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;N.lW=s,N.h2=50;const A=2147483647;function D(r){if(r>A)throw new RangeError('The value "'+r+'" is invalid for option "size"');const t=new Uint8Array(r);return Object.setPrototypeOf(t,s.prototype),t}function s(r,t,e){if("number"==typeof r){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return k(r)}return n(r,t,e)}function n(r,t,e){if("string"==typeof r)return function E(r,t){if(("string"!=typeof t||""===t)&&(t="utf8"),!s.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const e=0|m(r,t);let i=D(e);const a=i.write(r,t);return a!==e&&(i=i.slice(0,a)),i}(r,t);if(ArrayBuffer.isView(r))return function M(r){if(rt(r,Uint8Array)){const t=new Uint8Array(r);return W(t.buffer,t.byteOffset,t.byteLength)}return R(r)}(r);if(null==r)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r);if(rt(r,ArrayBuffer)||r&&rt(r.buffer,ArrayBuffer)||"undefined"!=typeof SharedArrayBuffer&&(rt(r,SharedArrayBuffer)||r&&rt(r.buffer,SharedArrayBuffer)))return W(r,t,e);if("number"==typeof r)throw new TypeError('The "value" argument must not be of type number. Received type number');const i=r.valueOf&&r.valueOf();if(null!=i&&i!==r)return s.from(i,t,e);const a=function V(r){if(s.isBuffer(r)){const t=0|Z(r.length),e=D(t);return 0===e.length||r.copy(e,0,0,t),e}return void 0!==r.length?"number"!=typeof r.length||dt(r.length)?D(0):R(r):"Buffer"===r.type&&Array.isArray(r.data)?R(r.data):void 0}(r);if(a)return a;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof r[Symbol.toPrimitive])return s.from(r[Symbol.toPrimitive]("string"),t,e);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r)}function F(r){if("number"!=typeof r)throw new TypeError('"size" argument must be of type number');if(r<0)throw new RangeError('The value "'+r+'" is invalid for option "size"')}function k(r){return F(r),D(r<0?0:0|Z(r))}function R(r){const t=r.length<0?0:0|Z(r.length),e=D(t);for(let i=0;i<t;i+=1)e[i]=255&r[i];return e}function W(r,t,e){if(t<0||r.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(r.byteLength<t+(e||0))throw new RangeError('"length" is outside of buffer bounds');let i;return i=void 0===t&&void 0===e?new Uint8Array(r):void 0===e?new Uint8Array(r,t):new Uint8Array(r,t,e),Object.setPrototypeOf(i,s.prototype),i}function Z(r){if(r>=A)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+A.toString(16)+" bytes");return 0|r}function m(r,t){if(s.isBuffer(r))return r.length;if(ArrayBuffer.isView(r)||rt(r,ArrayBuffer))return r.byteLength;if("string"!=typeof r)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof r);const e=r.length,i=arguments.length>2&&!0===arguments[2];if(!i&&0===e)return 0;let a=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return e;case"utf8":case"utf-8":return ht(r).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*e;case"hex":return e>>>1;case"base64":return wt(r).length;default:if(a)return i?-1:ht(r).length;t=(""+t).toLowerCase(),a=!0}}function x(r,t,e){let i=!1;if((void 0===t||t<0)&&(t=0),t>this.length||((void 0===e||e>this.length)&&(e=this.length),e<=0)||(e>>>=0)<=(t>>>=0))return"";for(r||(r="utf8");;)switch(r){case"hex":return ut(this,t,e);case"utf8":case"utf-8":return tt(this,t,e);case"ascii":return nt(this,t,e);case"latin1":case"binary":return lt(this,t,e);case"base64":return X(this,t,e);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return It(this,t,e);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(r+"").toLowerCase(),i=!0}}function C(r,t,e){const i=r[t];r[t]=r[e],r[e]=i}function v(r,t,e,i,a){if(0===r.length)return-1;if("string"==typeof e?(i=e,e=0):e>2147483647?e=2147483647:e<-2147483648&&(e=-2147483648),dt(e=+e)&&(e=a?0:r.length-1),e<0&&(e=r.length+e),e>=r.length){if(a)return-1;e=r.length-1}else if(e<0){if(!a)return-1;e=0}if("string"==typeof t&&(t=s.from(t,i)),s.isBuffer(t))return 0===t.length?-1:H(r,t,e,i,a);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?a?Uint8Array.prototype.indexOf.call(r,t,e):Uint8Array.prototype.lastIndexOf.call(r,t,e):H(r,[t],e,i,a);throw new TypeError("val must be string, number or Buffer")}function H(r,t,e,i,a){let Q,u=1,f=r.length,S=t.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(r.length<2||t.length<2)return-1;u=2,f/=2,S/=2,e/=2}function Y(J,G){return 1===u?J[G]:J.readUInt16BE(G*u)}if(a){let J=-1;for(Q=e;Q<f;Q++)if(Y(r,Q)===Y(t,-1===J?0:Q-J)){if(-1===J&&(J=Q),Q-J+1===S)return J*u}else-1!==J&&(Q-=Q-J),J=-1}else for(e+S>f&&(e=f-S),Q=e;Q>=0;Q--){let J=!0;for(let G=0;G<S;G++)if(Y(r,Q+G)!==Y(t,G)){J=!1;break}if(J)return Q}return-1}function O(r,t,e,i){e=Number(e)||0;const a=r.length-e;i?(i=Number(i))>a&&(i=a):i=a;const u=t.length;let f;for(i>u/2&&(i=u/2),f=0;f<i;++f){const S=parseInt(t.substr(2*f,2),16);if(dt(S))return f;r[e+f]=S}return f}function y(r,t,e,i){return pt(ht(t,r.length-e),r,e,i)}function I(r,t,e,i){return pt(function Bt(r){const t=[];for(let e=0;e<r.length;++e)t.push(255&r.charCodeAt(e));return t}(t),r,e,i)}function L(r,t,e,i){return pt(wt(t),r,e,i)}function q(r,t,e,i){return pt(function bt(r,t){let e,i,a;const u=[];for(let f=0;f<r.length&&!((t-=2)<0);++f)e=r.charCodeAt(f),i=e>>8,a=e%256,u.push(a),u.push(i);return u}(t,r.length-e),r,e,i)}function X(r,t,e){return P.fromByteArray(0===t&&e===r.length?r:r.slice(t,e))}function tt(r,t,e){e=Math.min(r.length,e);const i=[];let a=t;for(;a<e;){const u=r[a];let f=null,S=u>239?4:u>223?3:u>191?2:1;if(a+S<=e){let Y,Q,J,G;switch(S){case 1:u<128&&(f=u);break;case 2:Y=r[a+1],128==(192&Y)&&(G=(31&u)<<6|63&Y,G>127&&(f=G));break;case 3:Y=r[a+1],Q=r[a+2],128==(192&Y)&&128==(192&Q)&&(G=(15&u)<<12|(63&Y)<<6|63&Q,G>2047&&(G<55296||G>57343)&&(f=G));break;case 4:Y=r[a+1],Q=r[a+2],J=r[a+3],128==(192&Y)&&128==(192&Q)&&128==(192&J)&&(G=(15&u)<<18|(63&Y)<<12|(63&Q)<<6|63&J,G>65535&&G<1114112&&(f=G))}}null===f?(f=65533,S=1):f>65535&&(f-=65536,i.push(f>>>10&1023|55296),f=56320|1023&f),i.push(f),a+=S}return function ot(r){const t=r.length;if(t<=K)return String.fromCharCode.apply(String,r);let e="",i=0;for(;i<t;)e+=String.fromCharCode.apply(String,r.slice(i,i+=K));return e}(i)}!(s.TYPED_ARRAY_SUPPORT=function w(){try{const r=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(r,t),42===r.foo()}catch(r){return!1}}())&&"undefined"!=typeof console&&"function"==typeof console.error&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.buffer}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.byteOffset}}),s.poolSize=8192,s.from=function(r,t,e){return n(r,t,e)},Object.setPrototypeOf(s.prototype,Uint8Array.prototype),Object.setPrototypeOf(s,Uint8Array),s.alloc=function(r,t,e){return function B(r,t,e){return F(r),r<=0?D(r):void 0!==t?"string"==typeof e?D(r).fill(t,e):D(r).fill(t):D(r)}(r,t,e)},s.allocUnsafe=function(r){return k(r)},s.allocUnsafeSlow=function(r){return k(r)},s.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==s.prototype},s.compare=function(t,e){if(rt(t,Uint8Array)&&(t=s.from(t,t.offset,t.byteLength)),rt(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),!s.isBuffer(t)||!s.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;let i=t.length,a=e.length;for(let u=0,f=Math.min(i,a);u<f;++u)if(t[u]!==e[u]){i=t[u],a=e[u];break}return i<a?-1:a<i?1:0},s.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return s.alloc(0);let i;if(void 0===e)for(e=0,i=0;i<t.length;++i)e+=t[i].length;const a=s.allocUnsafe(e);let u=0;for(i=0;i<t.length;++i){let f=t[i];if(rt(f,Uint8Array))u+f.length>a.length?(s.isBuffer(f)||(f=s.from(f)),f.copy(a,u)):Uint8Array.prototype.set.call(a,f,u);else{if(!s.isBuffer(f))throw new TypeError('"list" argument must be an Array of Buffers');f.copy(a,u)}u+=f.length}return a},s.byteLength=m,s.prototype._isBuffer=!0,s.prototype.swap16=function(){const t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let e=0;e<t;e+=2)C(this,e,e+1);return this},s.prototype.swap32=function(){const t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let e=0;e<t;e+=4)C(this,e,e+3),C(this,e+1,e+2);return this},s.prototype.swap64=function(){const t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let e=0;e<t;e+=8)C(this,e,e+7),C(this,e+1,e+6),C(this,e+2,e+5),C(this,e+3,e+4);return this},s.prototype.toLocaleString=s.prototype.toString=function(){const t=this.length;return 0===t?"":0===arguments.length?tt(this,0,t):x.apply(this,arguments)},s.prototype.equals=function(t){if(!s.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===s.compare(this,t)},s.prototype.inspect=function(){let t="";const e=N.h2;return t=this.toString("hex",0,e).replace(/(.{2})/g,"$1 ").trim(),this.length>e&&(t+=" ... "),"<Buffer "+t+">"},g&&(s.prototype[g]=s.prototype.inspect),s.prototype.compare=function(t,e,i,a,u){if(rt(t,Uint8Array)&&(t=s.from(t,t.offset,t.byteLength)),!s.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===i&&(i=t?t.length:0),void 0===a&&(a=0),void 0===u&&(u=this.length),e<0||i>t.length||a<0||u>this.length)throw new RangeError("out of range index");if(a>=u&&e>=i)return 0;if(a>=u)return-1;if(e>=i)return 1;if(this===t)return 0;let f=(u>>>=0)-(a>>>=0),S=(i>>>=0)-(e>>>=0);const Y=Math.min(f,S),Q=this.slice(a,u),J=t.slice(e,i);for(let G=0;G<Y;++G)if(Q[G]!==J[G]){f=Q[G],S=J[G];break}return f<S?-1:S<f?1:0},s.prototype.includes=function(t,e,i){return-1!==this.indexOf(t,e,i)},s.prototype.indexOf=function(t,e,i){return v(this,t,e,i,!0)},s.prototype.lastIndexOf=function(t,e,i){return v(this,t,e,i,!1)},s.prototype.write=function(t,e,i,a){if(void 0===e)a="utf8",i=this.length,e=0;else if(void 0===i&&"string"==typeof e)a=e,i=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(i)?(i>>>=0,void 0===a&&(a="utf8")):(a=i,i=void 0)}const u=this.length-e;if((void 0===i||i>u)&&(i=u),t.length>0&&(i<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");a||(a="utf8");let f=!1;for(;;)switch(a){case"hex":return O(this,t,e,i);case"utf8":case"utf-8":return y(this,t,e,i);case"ascii":case"latin1":case"binary":return I(this,t,e,i);case"base64":return L(this,t,e,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return q(this,t,e,i);default:if(f)throw new TypeError("Unknown encoding: "+a);a=(""+a).toLowerCase(),f=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const K=4096;function nt(r,t,e){let i="";e=Math.min(r.length,e);for(let a=t;a<e;++a)i+=String.fromCharCode(127&r[a]);return i}function lt(r,t,e){let i="";e=Math.min(r.length,e);for(let a=t;a<e;++a)i+=String.fromCharCode(r[a]);return i}function ut(r,t,e){const i=r.length;(!t||t<0)&&(t=0),(!e||e<0||e>i)&&(e=i);let a="";for(let u=t;u<e;++u)a+=vt[r[u]];return a}function It(r,t,e){const i=r.slice(t,e);let a="";for(let u=0;u<i.length-1;u+=2)a+=String.fromCharCode(i[u]+256*i[u+1]);return a}function j(r,t,e){if(r%1!=0||r<0)throw new RangeError("offset is not uint");if(r+t>e)throw new RangeError("Trying to access beyond buffer length")}function et(r,t,e,i,a,u){if(!s.isBuffer(r))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>a||t<u)throw new RangeError('"value" argument is out of bounds');if(e+i>r.length)throw new RangeError("Index out of range")}function mt(r,t,e,i,a){Tt(t,i,a,r,e,7);let u=Number(t&BigInt(4294967295));r[e++]=u,u>>=8,r[e++]=u,u>>=8,r[e++]=u,u>>=8,r[e++]=u;let f=Number(t>>BigInt(32)&BigInt(4294967295));return r[e++]=f,f>>=8,r[e++]=f,f>>=8,r[e++]=f,f>>=8,r[e++]=f,e}function gt(r,t,e,i,a){Tt(t,i,a,r,e,7);let u=Number(t&BigInt(4294967295));r[e+7]=u,u>>=8,r[e+6]=u,u>>=8,r[e+5]=u,u>>=8,r[e+4]=u;let f=Number(t>>BigInt(32)&BigInt(4294967295));return r[e+3]=f,f>>=8,r[e+2]=f,f>>=8,r[e+1]=f,f>>=8,r[e]=f,e+8}function _t(r,t,e,i,a,u){if(e+i>r.length)throw new RangeError("Index out of range");if(e<0)throw new RangeError("Index out of range")}function xt(r,t,e,i,a){return t=+t,e>>>=0,a||_t(r,0,e,4),U.write(r,t,e,i,23,4),e+4}function yt(r,t,e,i,a){return t=+t,e>>>=0,a||_t(r,0,e,8),U.write(r,t,e,i,52,8),e+8}s.prototype.slice=function(t,e){const i=this.length;(t=~~t)<0?(t+=i)<0&&(t=0):t>i&&(t=i),(e=void 0===e?i:~~e)<0?(e+=i)<0&&(e=0):e>i&&(e=i),e<t&&(e=t);const a=this.subarray(t,e);return Object.setPrototypeOf(a,s.prototype),a},s.prototype.readUintLE=s.prototype.readUIntLE=function(t,e,i){t>>>=0,e>>>=0,i||j(t,e,this.length);let a=this[t],u=1,f=0;for(;++f<e&&(u*=256);)a+=this[t+f]*u;return a},s.prototype.readUintBE=s.prototype.readUIntBE=function(t,e,i){t>>>=0,e>>>=0,i||j(t,e,this.length);let a=this[t+--e],u=1;for(;e>0&&(u*=256);)a+=this[t+--e]*u;return a},s.prototype.readUint8=s.prototype.readUInt8=function(t,e){return t>>>=0,e||j(t,1,this.length),this[t]},s.prototype.readUint16LE=s.prototype.readUInt16LE=function(t,e){return t>>>=0,e||j(t,2,this.length),this[t]|this[t+1]<<8},s.prototype.readUint16BE=s.prototype.readUInt16BE=function(t,e){return t>>>=0,e||j(t,2,this.length),this[t]<<8|this[t+1]},s.prototype.readUint32LE=s.prototype.readUInt32LE=function(t,e){return t>>>=0,e||j(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},s.prototype.readUint32BE=s.prototype.readUInt32BE=function(t,e){return t>>>=0,e||j(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},s.prototype.readBigUInt64LE=it(function(t){at(t>>>=0,"offset");const e=this[t],i=this[t+7];(void 0===e||void 0===i)&&ct(t,this.length-8);const a=e+256*this[++t]+65536*this[++t]+this[++t]*2**24,u=this[++t]+256*this[++t]+65536*this[++t]+i*2**24;return BigInt(a)+(BigInt(u)<<BigInt(32))}),s.prototype.readBigUInt64BE=it(function(t){at(t>>>=0,"offset");const e=this[t],i=this[t+7];(void 0===e||void 0===i)&&ct(t,this.length-8);const a=e*2**24+65536*this[++t]+256*this[++t]+this[++t],u=this[++t]*2**24+65536*this[++t]+256*this[++t]+i;return(BigInt(a)<<BigInt(32))+BigInt(u)}),s.prototype.readIntLE=function(t,e,i){t>>>=0,e>>>=0,i||j(t,e,this.length);let a=this[t],u=1,f=0;for(;++f<e&&(u*=256);)a+=this[t+f]*u;return u*=128,a>=u&&(a-=Math.pow(2,8*e)),a},s.prototype.readIntBE=function(t,e,i){t>>>=0,e>>>=0,i||j(t,e,this.length);let a=e,u=1,f=this[t+--a];for(;a>0&&(u*=256);)f+=this[t+--a]*u;return u*=128,f>=u&&(f-=Math.pow(2,8*e)),f},s.prototype.readInt8=function(t,e){return t>>>=0,e||j(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},s.prototype.readInt16LE=function(t,e){t>>>=0,e||j(t,2,this.length);const i=this[t]|this[t+1]<<8;return 32768&i?4294901760|i:i},s.prototype.readInt16BE=function(t,e){t>>>=0,e||j(t,2,this.length);const i=this[t+1]|this[t]<<8;return 32768&i?4294901760|i:i},s.prototype.readInt32LE=function(t,e){return t>>>=0,e||j(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},s.prototype.readInt32BE=function(t,e){return t>>>=0,e||j(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},s.prototype.readBigInt64LE=it(function(t){at(t>>>=0,"offset");const e=this[t],i=this[t+7];return(void 0===e||void 0===i)&&ct(t,this.length-8),(BigInt(this[t+4]+256*this[t+5]+65536*this[t+6]+(i<<24))<<BigInt(32))+BigInt(e+256*this[++t]+65536*this[++t]+this[++t]*2**24)}),s.prototype.readBigInt64BE=it(function(t){at(t>>>=0,"offset");const e=this[t],i=this[t+7];(void 0===e||void 0===i)&&ct(t,this.length-8);const a=(e<<24)+65536*this[++t]+256*this[++t]+this[++t];return(BigInt(a)<<BigInt(32))+BigInt(this[++t]*2**24+65536*this[++t]+256*this[++t]+i)}),s.prototype.readFloatLE=function(t,e){return t>>>=0,e||j(t,4,this.length),U.read(this,t,!0,23,4)},s.prototype.readFloatBE=function(t,e){return t>>>=0,e||j(t,4,this.length),U.read(this,t,!1,23,4)},s.prototype.readDoubleLE=function(t,e){return t>>>=0,e||j(t,8,this.length),U.read(this,t,!0,52,8)},s.prototype.readDoubleBE=function(t,e){return t>>>=0,e||j(t,8,this.length),U.read(this,t,!1,52,8)},s.prototype.writeUintLE=s.prototype.writeUIntLE=function(t,e,i,a){t=+t,e>>>=0,i>>>=0,a||et(this,t,e,i,Math.pow(2,8*i)-1,0);let u=1,f=0;for(this[e]=255&t;++f<i&&(u*=256);)this[e+f]=t/u&255;return e+i},s.prototype.writeUintBE=s.prototype.writeUIntBE=function(t,e,i,a){t=+t,e>>>=0,i>>>=0,a||et(this,t,e,i,Math.pow(2,8*i)-1,0);let u=i-1,f=1;for(this[e+u]=255&t;--u>=0&&(f*=256);)this[e+u]=t/f&255;return e+i},s.prototype.writeUint8=s.prototype.writeUInt8=function(t,e,i){return t=+t,e>>>=0,i||et(this,t,e,1,255,0),this[e]=255&t,e+1},s.prototype.writeUint16LE=s.prototype.writeUInt16LE=function(t,e,i){return t=+t,e>>>=0,i||et(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},s.prototype.writeUint16BE=s.prototype.writeUInt16BE=function(t,e,i){return t=+t,e>>>=0,i||et(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},s.prototype.writeUint32LE=s.prototype.writeUInt32LE=function(t,e,i){return t=+t,e>>>=0,i||et(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},s.prototype.writeUint32BE=s.prototype.writeUInt32BE=function(t,e,i){return t=+t,e>>>=0,i||et(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},s.prototype.writeBigUInt64LE=it(function(t,e=0){return mt(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))}),s.prototype.writeBigUInt64BE=it(function(t,e=0){return gt(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))}),s.prototype.writeIntLE=function(t,e,i,a){if(t=+t,e>>>=0,!a){const Y=Math.pow(2,8*i-1);et(this,t,e,i,Y-1,-Y)}let u=0,f=1,S=0;for(this[e]=255&t;++u<i&&(f*=256);)t<0&&0===S&&0!==this[e+u-1]&&(S=1),this[e+u]=(t/f>>0)-S&255;return e+i},s.prototype.writeIntBE=function(t,e,i,a){if(t=+t,e>>>=0,!a){const Y=Math.pow(2,8*i-1);et(this,t,e,i,Y-1,-Y)}let u=i-1,f=1,S=0;for(this[e+u]=255&t;--u>=0&&(f*=256);)t<0&&0===S&&0!==this[e+u+1]&&(S=1),this[e+u]=(t/f>>0)-S&255;return e+i},s.prototype.writeInt8=function(t,e,i){return t=+t,e>>>=0,i||et(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},s.prototype.writeInt16LE=function(t,e,i){return t=+t,e>>>=0,i||et(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},s.prototype.writeInt16BE=function(t,e,i){return t=+t,e>>>=0,i||et(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},s.prototype.writeInt32LE=function(t,e,i){return t=+t,e>>>=0,i||et(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},s.prototype.writeInt32BE=function(t,e,i){return t=+t,e>>>=0,i||et(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},s.prototype.writeBigInt64LE=it(function(t,e=0){return mt(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),s.prototype.writeBigInt64BE=it(function(t,e=0){return gt(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),s.prototype.writeFloatLE=function(t,e,i){return xt(this,t,e,!0,i)},s.prototype.writeFloatBE=function(t,e,i){return xt(this,t,e,!1,i)},s.prototype.writeDoubleLE=function(t,e,i){return yt(this,t,e,!0,i)},s.prototype.writeDoubleBE=function(t,e,i){return yt(this,t,e,!1,i)},s.prototype.copy=function(t,e,i,a){if(!s.isBuffer(t))throw new TypeError("argument should be a Buffer");if(i||(i=0),!a&&0!==a&&(a=this.length),e>=t.length&&(e=t.length),e||(e=0),a>0&&a<i&&(a=i),a===i||0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("Index out of range");if(a<0)throw new RangeError("sourceEnd out of bounds");a>this.length&&(a=this.length),t.length-e<a-i&&(a=t.length-e+i);const u=a-i;return this===t&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(e,i,a):Uint8Array.prototype.set.call(t,this.subarray(i,a),e),u},s.prototype.fill=function(t,e,i,a){if("string"==typeof t){if("string"==typeof e?(a=e,e=0,i=this.length):"string"==typeof i&&(a=i,i=this.length),void 0!==a&&"string"!=typeof a)throw new TypeError("encoding must be a string");if("string"==typeof a&&!s.isEncoding(a))throw new TypeError("Unknown encoding: "+a);if(1===t.length){const f=t.charCodeAt(0);("utf8"===a&&f<128||"latin1"===a)&&(t=f)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<i)throw new RangeError("Out of range index");if(i<=e)return this;let u;if(e>>>=0,i=void 0===i?this.length:i>>>0,t||(t=0),"number"==typeof t)for(u=e;u<i;++u)this[u]=t;else{const f=s.isBuffer(t)?t:s.from(t,a),S=f.length;if(0===S)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(u=0;u<i-e;++u)this[u+e]=f[u%S]}return this};const st={};function ft(r,t,e){st[r]=class extends e{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${r}]`,delete this.name}get code(){return r}set code(a){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:a,writable:!0})}toString(){return`${this.name} [${r}]: ${this.message}`}}}function Et(r){let t="",e=r.length;const i="-"===r[0]?1:0;for(;e>=i+4;e-=3)t=`_${r.slice(e-3,e)}${t}`;return`${r.slice(0,e)}${t}`}function Tt(r,t,e,i,a,u){if(r>e||r<t){const f="bigint"==typeof t?"n":"";let S;throw S=u>3?0===t||t===BigInt(0)?`>= 0${f} and < 2${f} ** ${8*(u+1)}${f}`:`>= -(2${f} ** ${8*(u+1)-1}${f}) and < 2 ** ${8*(u+1)-1}${f}`:`>= ${t}${f} and <= ${e}${f}`,new st.ERR_OUT_OF_RANGE("value",S,r)}!function Dt(r,t,e){at(t,"offset"),(void 0===r[t]||void 0===r[t+e])&&ct(t,r.length-(e+1))}(i,a,u)}function at(r,t){if("number"!=typeof r)throw new st.ERR_INVALID_ARG_TYPE(t,"number",r)}function ct(r,t,e){throw Math.floor(r)!==r?(at(r,e),new st.ERR_OUT_OF_RANGE(e||"offset","an integer",r)):t<0?new st.ERR_BUFFER_OUT_OF_BOUNDS:new st.ERR_OUT_OF_RANGE(e||"offset",`>= ${e?1:0} and <= ${t}`,r)}ft("ERR_BUFFER_OUT_OF_BOUNDS",function(r){return r?`${r} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),ft("ERR_INVALID_ARG_TYPE",function(r,t){return`The "${r}" argument must be of type number. Received type ${typeof t}`},TypeError),ft("ERR_OUT_OF_RANGE",function(r,t,e){let i=`The value of "${r}" is out of range.`,a=e;return Number.isInteger(e)&&Math.abs(e)>2**32?a=Et(String(e)):"bigint"==typeof e&&(a=String(e),(e>BigInt(2)**BigInt(32)||e<-(BigInt(2)**BigInt(32)))&&(a=Et(a)),a+="n"),i+=` It must be ${t}. Received ${a}`,i},RangeError);const Rt=/[^+/0-9A-Za-z-_]/g;function ht(r,t){let e;t=t||1/0;const i=r.length;let a=null;const u=[];for(let f=0;f<i;++f){if(e=r.charCodeAt(f),e>55295&&e<57344){if(!a){if(e>56319){(t-=3)>-1&&u.push(239,191,189);continue}if(f+1===i){(t-=3)>-1&&u.push(239,191,189);continue}a=e;continue}if(e<56320){(t-=3)>-1&&u.push(239,191,189),a=e;continue}e=65536+(a-55296<<10|e-56320)}else a&&(t-=3)>-1&&u.push(239,191,189);if(a=null,e<128){if((t-=1)<0)break;u.push(e)}else if(e<2048){if((t-=2)<0)break;u.push(e>>6|192,63&e|128)}else if(e<65536){if((t-=3)<0)break;u.push(e>>12|224,e>>6&63|128,63&e|128)}else{if(!(e<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;u.push(e>>18|240,e>>12&63|128,e>>6&63|128,63&e|128)}}return u}function wt(r){return P.toByteArray(function At(r){if((r=(r=r.split("=")[0]).trim().replace(Rt,"")).length<2)return"";for(;r.length%4!=0;)r+="=";return r}(r))}function pt(r,t,e,i){let a;for(a=0;a<i&&!(a+e>=t.length||a>=r.length);++a)t[a+e]=r[a];return a}function rt(r,t){return r instanceof t||null!=r&&null!=r.constructor&&null!=r.constructor.name&&r.constructor.name===t.name}function dt(r){return r!=r}const vt=function(){const r="0123456789abcdef",t=new Array(256);for(let e=0;e<16;++e){const i=16*e;for(let a=0;a<16;++a)t[i+a]=r[e]+r[a]}return t}();function it(r){return"undefined"==typeof BigInt?Ut:r}function Ut(){throw new Error("BigInt not supported")}},9069:z=>{"use strict";var p,N="object"==typeof Reflect?Reflect:null,h=N&&"function"==typeof N.apply?N.apply:function(m,x,C){return Function.prototype.apply.call(m,x,C)};p=N&&"function"==typeof N.ownKeys?N.ownKeys:Object.getOwnPropertySymbols?function(m){return Object.getOwnPropertyNames(m).concat(Object.getOwnPropertySymbols(m))}:function(m){return Object.getOwnPropertyNames(m)};var U=Number.isNaN||function(m){return m!=m};function g(){g.init.call(this)}z.exports=g,z.exports.once=function W(d,m){return new Promise(function(x,C){function v(O){d.removeListener(m,H),C(O)}function H(){"function"==typeof d.removeListener&&d.removeListener("error",v),x([].slice.call(arguments))}Z(d,m,H,{once:!0}),"error"!==m&&function V(d,m,x){"function"==typeof d.on&&Z(d,"error",m,x)}(d,v,{once:!0})})},g.EventEmitter=g,g.prototype._events=void 0,g.prototype._eventsCount=0,g.prototype._maxListeners=void 0;var A=10;function w(d){if("function"!=typeof d)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof d)}function D(d){return void 0===d._maxListeners?g.defaultMaxListeners:d._maxListeners}function s(d,m,x,C){var v,H,O;if(w(x),void 0===(H=d._events)?(H=d._events=Object.create(null),d._eventsCount=0):(void 0!==H.newListener&&(d.emit("newListener",m,x.listener?x.listener:x),H=d._events),O=H[m]),void 0===O)O=H[m]=x,++d._eventsCount;else if("function"==typeof O?O=H[m]=C?[x,O]:[O,x]:C?O.unshift(x):O.push(x),(v=D(d))>0&&O.length>v&&!O.warned){O.warned=!0;var y=new Error("Possible EventEmitter memory leak detected. "+O.length+" "+String(m)+" listeners added. Use emitter.setMaxListeners() to increase limit");y.name="MaxListenersExceededWarning",y.emitter=d,y.type=m,y.count=O.length,function P(d){console&&console.warn&&console.warn(d)}(y)}return d}function n(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function F(d,m,x){var C={fired:!1,wrapFn:void 0,target:d,type:m,listener:x},v=n.bind(C);return v.listener=x,C.wrapFn=v,v}function B(d,m,x){var C=d._events;if(void 0===C)return[];var v=C[m];return void 0===v?[]:"function"==typeof v?x?[v.listener||v]:[v]:x?function M(d){for(var m=new Array(d.length),x=0;x<m.length;++x)m[x]=d[x].listener||d[x];return m}(v):E(v,v.length)}function k(d){var m=this._events;if(void 0!==m){var x=m[d];if("function"==typeof x)return 1;if(void 0!==x)return x.length}return 0}function E(d,m){for(var x=new Array(m),C=0;C<m;++C)x[C]=d[C];return x}function Z(d,m,x,C){if("function"==typeof d.on)C.once?d.once(m,x):d.on(m,x);else{if("function"!=typeof d.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof d);d.addEventListener(m,function v(H){C.once&&d.removeEventListener(m,v),x(H)})}}Object.defineProperty(g,"defaultMaxListeners",{enumerable:!0,get:function(){return A},set:function(d){if("number"!=typeof d||d<0||U(d))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+d+".");A=d}}),g.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},g.prototype.setMaxListeners=function(m){if("number"!=typeof m||m<0||U(m))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+m+".");return this._maxListeners=m,this},g.prototype.getMaxListeners=function(){return D(this)},g.prototype.emit=function(m){for(var x=[],C=1;C<arguments.length;C++)x.push(arguments[C]);var v="error"===m,H=this._events;if(void 0!==H)v=v&&void 0===H.error;else if(!v)return!1;if(v){var O;if(x.length>0&&(O=x[0]),O instanceof Error)throw O;var y=new Error("Unhandled error."+(O?" ("+O.message+")":""));throw y.context=O,y}var I=H[m];if(void 0===I)return!1;if("function"==typeof I)h(I,this,x);else{var L=I.length,q=E(I,L);for(C=0;C<L;++C)h(q[C],this,x)}return!0},g.prototype.on=g.prototype.addListener=function(m,x){return s(this,m,x,!1)},g.prototype.prependListener=function(m,x){return s(this,m,x,!0)},g.prototype.once=function(m,x){return w(x),this.on(m,F(this,m,x)),this},g.prototype.prependOnceListener=function(m,x){return w(x),this.prependListener(m,F(this,m,x)),this},g.prototype.off=g.prototype.removeListener=function(m,x){var C,v,H,O,y;if(w(x),void 0===(v=this._events))return this;if(void 0===(C=v[m]))return this;if(C===x||C.listener===x)0==--this._eventsCount?this._events=Object.create(null):(delete v[m],v.removeListener&&this.emit("removeListener",m,C.listener||x));else if("function"!=typeof C){for(H=-1,O=C.length-1;O>=0;O--)if(C[O]===x||C[O].listener===x){y=C[O].listener,H=O;break}if(H<0)return this;0===H?C.shift():function R(d,m){for(;m+1<d.length;m++)d[m]=d[m+1];d.pop()}(C,H),1===C.length&&(v[m]=C[0]),void 0!==v.removeListener&&this.emit("removeListener",m,y||x)}return this},g.prototype.removeAllListeners=function(m){var x,C,v;if(void 0===(C=this._events))return this;if(void 0===C.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==C[m]&&(0==--this._eventsCount?this._events=Object.create(null):delete C[m]),this;if(0===arguments.length){var O,H=Object.keys(C);for(v=0;v<H.length;++v)"removeListener"!==(O=H[v])&&this.removeAllListeners(O);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(x=C[m]))this.removeListener(m,x);else if(void 0!==x)for(v=x.length-1;v>=0;v--)this.removeListener(m,x[v]);return this},g.prototype.listeners=function(m){return B(this,m,!0)},g.prototype.rawListeners=function(m){return B(this,m,!1)},g.listenerCount=function(d,m){return"function"==typeof d.listenerCount?d.listenerCount(m):k.call(d,m)},g.prototype.listenerCount=k,g.prototype.eventNames=function(){return this._eventsCount>0?p(this._events):[]}},9076:(z,N,h)=>{"use strict";var p=h(8926).default;const P=h(8202),U=h(9069).EventEmitter,g=h(6643);z.exports=class A extends U{constructor(D,s){if(s||(s={}),super(),this.chunkLength=Number(D),!this.chunkLength)throw new Error("First argument must be a chunk length");this.closed=!1,this.destroyed=!1,this.length=Number(s.length)||1/0,this.name=s.name||"idb-chunk-store",this.length!==1/0&&(this.lastChunkLength=this.length%this.chunkLength||this.chunkLength,this.lastChunkIndex=Math.ceil(this.length/this.chunkLength)-1),this.dbPromise=P.openDB(this.name,void 0,{upgrade:n=>{n.createObjectStore("chunks")},blocking:()=>{this.close()},terminated:()=>{this.closed=!0,this.emit("error",new Error("Database unexpectedly closed"))}})}put(D,s,n=(()=>{})){var F=this;if(this.closed)return g(()=>n(new Error("Storage is closed")));const B=D===this.lastChunkIndex;return B&&s.length!==this.lastChunkLength?g(()=>n(new Error("Last chunk length must be "+this.lastChunkLength))):B||s.length===this.chunkLength?((0!==(s=new Uint8Array(s.buffer,s.byteOffset,s.byteLength)).byteOffset||s.byteLength!==s.buffer.byteLength)&&(s=s.slice()),void p(function*(){try{yield(yield F.dbPromise).put("chunks",s,D)}catch(k){return void n(k)}n(null)})()):g(()=>n(new Error("Chunk length must be "+this.chunkLength)))}get(D,s,n=(()=>{})){var F=this;return"function"==typeof s?this.get(D,{},s):(s||(s={}),this.closed?g(()=>n(new Error("Storage is closed"))):void p(function*(){let B;try{B=yield(yield F.dbPromise).get("chunks",D)}catch(M){return void n(M)}if(null==B){const M=new Error("Chunk not found");return M.notFound=!0,void n(M)}let k=Buffer.from(B.buffer,B.byteOffset,B.byteLength);const E=s.offset||0,R=s.length||k.length-E;(0!==E||R!==k.length)&&(k=k.slice(E,R+E)),n(null,k)})())}close(D=(()=>{})){var s=this;if(this.closed)return g(()=>D(new Error("Storage is closed")));this.closed=!0,p(function*(){try{(yield s.dbPromise).close()}catch(n){return void D(n)}D(null)})()}destroy(D=(()=>{})){var s=this;return this.closed?g(()=>D(new Error("Storage is closed"))):this.destroyed?g(()=>D(new Error("Storage is destroyed"))):(this.destroyed=!0,void this.close(function(){var n=p(function*(F){if(F)D(F);else{try{yield P.deleteDB(s.name)}catch(B){return void D(B)}D(null)}});return function(F){return n.apply(this,arguments)}}()))}}},8202:(z,N,h)=>{"use strict";h.r(N),h.d(N,{deleteDB:()=>x,openDB:()=>m,unwrap:()=>d,wrap:()=>Z});var p=h(5861);let U,g;const D=new WeakMap,s=new WeakMap,n=new WeakMap,F=new WeakMap,B=new WeakMap;let R={get(y,I,L){if(y instanceof IDBTransaction){if("done"===I)return s.get(y);if("objectStoreNames"===I)return y.objectStoreNames||n.get(y);if("store"===I)return L.objectStoreNames[1]?void 0:L.objectStore(L.objectStoreNames[0])}return Z(y[I])},set:(y,I,L)=>(y[I]=L,!0),has:(y,I)=>y instanceof IDBTransaction&&("done"===I||"store"===I)||I in y};function V(y){return"function"==typeof y?function W(y){return y!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function w(){return g||(g=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(y)?function(...I){return y.apply(d(this),I),Z(D.get(this))}:function(...I){return Z(y.apply(d(this),I))}:function(I,...L){const q=y.call(d(this),I,...L);return n.set(q,I.sort?I.sort():[I]),Z(q)}}(y):(y instanceof IDBTransaction&&function E(y){if(s.has(y))return;const I=new Promise((L,q)=>{const X=()=>{y.removeEventListener("complete",tt),y.removeEventListener("error",K),y.removeEventListener("abort",K)},tt=()=>{L(),X()},K=()=>{q(y.error||new DOMException("AbortError","AbortError")),X()};y.addEventListener("complete",tt),y.addEventListener("error",K),y.addEventListener("abort",K)});s.set(y,I)}(y),((y,I)=>I.some(L=>y instanceof L))(y,function A(){return U||(U=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(y,R):y)}function Z(y){if(y instanceof IDBRequest)return function k(y){const I=new Promise((L,q)=>{const X=()=>{y.removeEventListener("success",tt),y.removeEventListener("error",K)},tt=()=>{L(Z(y.result)),X()},K=()=>{q(y.error),X()};y.addEventListener("success",tt),y.addEventListener("error",K)});return I.then(L=>{L instanceof IDBCursor&&D.set(L,y)}).catch(()=>{}),B.set(I,y),I}(y);if(F.has(y))return F.get(y);const I=V(y);return I!==y&&(F.set(y,I),B.set(I,y)),I}const d=y=>B.get(y);function m(y,I,{blocked:L,upgrade:q,blocking:X,terminated:tt}={}){const K=indexedDB.open(y,I),ot=Z(K);return q&&K.addEventListener("upgradeneeded",nt=>{q(Z(K.result),nt.oldVersion,nt.newVersion,Z(K.transaction))}),L&&K.addEventListener("blocked",()=>L()),ot.then(nt=>{tt&&nt.addEventListener("close",()=>tt()),X&&nt.addEventListener("versionchange",()=>X())}).catch(()=>{}),ot}function x(y,{blocked:I}={}){const L=indexedDB.deleteDatabase(y);return I&&L.addEventListener("blocked",()=>I()),Z(L).then(()=>{})}const C=["get","getKey","getAll","getAllKeys","count"],v=["put","add","delete","clear"],H=new Map;function O(y,I){if(!(y instanceof IDBDatabase)||I in y||"string"!=typeof I)return;if(H.get(I))return H.get(I);const L=I.replace(/FromIndex$/,""),q=I!==L,X=v.includes(L);if(!(L in(q?IDBIndex:IDBObjectStore).prototype)||!X&&!C.includes(L))return;const tt=function(){var K=(0,p.Z)(function*(ot,...nt){const lt=this.transaction(ot,X?"readwrite":"readonly");let ut=lt.store;return q&&(ut=ut.index(nt.shift())),(yield Promise.all([ut[L](...nt),X&&lt.done]))[0]});return function(nt){return K.apply(this,arguments)}}();return H.set(I,tt),tt}!function M(y){R=y(R)}(y=>({...y,get:(I,L,q)=>O(I,L)||y.get(I,L,q),has:(I,L)=>!!O(I,L)||y.has(I,L)}))},8461:(z,N)=>{N.read=function(h,p,P,U,g){var A,w,D=8*g-U-1,s=(1<<D)-1,n=s>>1,F=-7,B=P?g-1:0,k=P?-1:1,E=h[p+B];for(B+=k,A=E&(1<<-F)-1,E>>=-F,F+=D;F>0;A=256*A+h[p+B],B+=k,F-=8);for(w=A&(1<<-F)-1,A>>=-F,F+=U;F>0;w=256*w+h[p+B],B+=k,F-=8);if(0===A)A=1-n;else{if(A===s)return w?NaN:1/0*(E?-1:1);w+=Math.pow(2,U),A-=n}return(E?-1:1)*w*Math.pow(2,A-U)},N.write=function(h,p,P,U,g,A){var w,D,s,n=8*A-g-1,F=(1<<n)-1,B=F>>1,k=23===g?Math.pow(2,-24)-Math.pow(2,-77):0,E=U?0:A-1,R=U?1:-1,M=p<0||0===p&&1/p<0?1:0;for(p=Math.abs(p),isNaN(p)||p===1/0?(D=isNaN(p)?1:0,w=F):(w=Math.floor(Math.log(p)/Math.LN2),p*(s=Math.pow(2,-w))<1&&(w--,s*=2),(p+=w+B>=1?k/s:k*Math.pow(2,1-B))*s>=2&&(w++,s/=2),w+B>=F?(D=0,w=F):w+B>=1?(D=(p*s-1)*Math.pow(2,g),w+=B):(D=p*Math.pow(2,B-1)*Math.pow(2,g),w=0));g>=8;h[P+E]=255&D,E+=R,D/=256,g-=8);for(w=w<<g|D,n+=g;n>0;h[P+E]=255&w,E+=R,w/=256,n-=8);h[P+E-R]|=128*M}},6643:z=>{let N;z.exports="function"==typeof queueMicrotask?queueMicrotask.bind("undefined"!=typeof window?window:global):h=>(N||(N=Promise.resolve())).then(h).catch(p=>setTimeout(()=>{throw p},0))},8926:z=>{function N(p,P,U,g,A,w,D){try{var s=p[w](D),n=s.value}catch(F){return void U(F)}s.done?P(n):Promise.resolve(n).then(g,A)}z.exports=function h(p){return function(){var P=this,U=arguments;return new Promise(function(g,A){var w=p.apply(P,U);function D(n){N(w,g,A,D,s,"next",n)}function s(n){N(w,g,A,D,s,"throw",n)}D(void 0)})}},z.exports.__esModule=!0,z.exports.default=z.exports}}]);
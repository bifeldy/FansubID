(self.webpackChunkfansubid=self.webpackChunkfansubid||[]).push([[58],{4058:(M,w,s)=>{"use strict";s.r(w),s.d(w,{TorrentModule:()=>kt});var l=s(9808),N=s(8406),L=s(3075),p=s(1777),O=s(4847),x=s(4999),b=s(4327),d=s(5934),t=s(5e3),D=s(7261),R=s(9287),T=s(8696),U=s(5861),v=s(9076),I=s.n(v),H=s(1135),Q=s(8202),S=s(3172),i=s(9731),r=s(6925),u=s(3379);let h=(()=>{class o{constructor(e,n,c,_){this.gs=e,this.api=n,this.toast=c,this.ls=_,this.trackerAnnounce=d.N.torrent.trackerAnnounce,this.clientOptions={maxConns:64,tracker:{announce:this.trackerAnnounce,rtcConfig:{iceServers:d.N.torrent.iceServers}}},this.torrentsQueue={},this.torrentOptions={announce:this.trackerAnnounce,maxWebConns:16,store:I()},this.webClient=null,this.expandedRow=null,this.tableDataRowSubject=new H.X([]),this.tableDataRow=this.tableDataRowSubject.asObservable(),this.error=null,this.refCallback=null,this.flagResurrected=!1,this.gs.isBrowser&&(this.torrentsQueue=this.ls.getItem(this.gs.localStorageKeys.Torrents,!0)||this.torrentsQueue,WebTorrent.WEBRTC_SUPPORT?(this.webClient=new WebTorrent(this.clientOptions),this.gs.log("[TORRENT_CLIENT_WEB_MODE_INITIALIZED]",this.webClient),this.handleWebClient()):this.toast.error("WebRTC Not Supported!","Whoops!",null,!0))}get tableDataRowValue(){var e;return(null===(e=this.tableDataRowSubject)||void 0===e?void 0:e.value)||[]}checkHealthOnTracker(e){return this.api.postData("/torrent",e)}handleWebClient(){this.webClient.on("torrent",e=>{this.gs.log("[TORRENT_CLIENT_ADD_TORRENT_FILE]",e),this.toast.info(e.infoHash,"Woaw, Antrian Baru!",null,!0),this.tableDataRowValue.push(e),this.tableDataRowSubject.next(this.tableDataRowValue),this.refCallback&&this.refCallback(null,e)}),this.webClient.on("error",e=>{this.gs.log("[TORRENT_CLIENT_ERROR]",e,"error"),this.toast.error(e.toString(),"Whoops!",null,!0),this.error=e,this.refCallback&&this.refCallback(this.error,null)})}handleWebTorrent(e,n){e.on("done",()=>{this.gs.log("[TORRENT_FILE_DONE]",e),this.toast.success("Ada Torrent Yang Sudah Selesai Di Download","Yeay, Selesai!",null,!0),this.torrentsQueue[e.infoHash].completed=!0,this.ls.setItem(this.gs.localStorageKeys.Torrents,this.torrentsQueue),n&&n(null,null)}),e.on("warning",c=>{this.gs.log("[TORRENT_FILE_WARNING]",c),this.toast.info(c.toString(),"Yuhuu!",null,!0),n&&n(c,null)}),e.on("error",c=>{this.gs.log("[TORRENT_FILE_ERROR]",c,"error"),this.toast.error(c.toString(),"Whoops!",null,!0),n&&n(c,null)})}handleWebWire(e,n){this.gs.log("[TORRENT_WIRE_CONNECT]",e);let c=e.peerId||"Unknown!";e.remoteAddress&&e.remotePort&&(c=`${e.remoteAddress}:${e.remotePort}`),e.on("close",()=>{this.gs.log("[TORRENT_WIRE_DISCONNECT]",c),n&&n(null,e)}),n&&n(null,e)}resurrectFiles(e){var n=this;if(!this.flagResurrected){this.flagResurrected=!0;for(const c in this.torrentsQueue)this.gs.log("[TORRENT_CLIENT_QUEUE_RESURRECT]",this.torrentsQueue[c]),this.torrentsQueue[c].completed?(0,Q.openDB)(this.torrentsQueue[c].indexedDb,1).then(function(){var _=(0,U.Z)(function*(A){const j=yield A.transaction("chunks","readonly").objectStore("chunks").getAll(),Bt=S.lW.concat(j),z=[];for(const Ht of n.torrentsQueue[c].files){const Y=Ht;z.push(new File([Bt.slice(Y.offset,Y.offset+Y.length)],Y.name))}n.uploadFiles(n.torrentsQueue[c].name,z,e)});return function(A){return _.apply(this,arguments)}}()).catch(_=>this.gs.log("[INDEXDB-OPEN_FAILED]",_,"error")):this.downloadFiles(this.torrentsQueue[c].infoHash,e,{...this.torrentOptions,name:this.torrentsQueue[c].name})}e(null,null)}processTorrent(e,n,c){e.on("wire",_=>this.handleWebWire(_,c)),this.torrentsQueue[e.infoHash]={completed:n,indexedDb:e.name+" - "+e.infoHash.slice(0,8),infoHash:e.infoHash,name:e.name,files:[]};for(const _ of e.files)this.torrentsQueue[e.infoHash].files.push({name:_.name,offset:_.offset,length:_.length});this.ls.setItem(this.gs.localStorageKeys.Torrents,this.torrentsQueue),this.handleWebTorrent(e,c)}downloadFiles(e,n,c=this.torrentOptions){this.gs.log("[TORRENT_CLIENT_QUEUE_DOWNLOAD]",e),this.refCallback=n,this.checkHealthOnTracker({magnetHash:e,trackTimeout:1234}).subscribe({next:_=>{this.gs.log("[TORRENT_CLIENT_HEALTH_SUCCESS]",_.result),_.result.seeds<=0?(this.toast.info("Tidak Ada Seeder!","Whoops!",null,!0),n&&n(null,_.result)):this.webClient.add(e,c,A=>{this.gs.log("[TORRENT_FILE_DOWNLOAD_READY]",A),this.toast.info("Memulai Download ...","Download!",null,!0),this.processTorrent(A,!1,n)})},error:_=>{this.gs.log("[TORRENT_CLIENT_HEALTH_ERROR]",_,"error"),n&&n(_,null)}})}uploadFiles(e,n,c){this.gs.log("[TORRENT_CLIENT_QUEUE_UPLOAD]",n),this.gs.log("[TORRENT_CLIENT_QUEUE_UPLOAD]",e),this.refCallback=c,this.webClient.seed(n,{...this.torrentOptions,name:e},_=>{this.gs.log("[TORRENT_FILE_SEED_READY]",_),this.toast.info("Memulai Seeding ...","Seeding",null,!0),this.processTorrent(_,!0,c)})}removeTorrent(e,n,c=!0){this.tableDataRowSubject.next(this.tableDataRowValue.filter(_=>_.infoHash!==e)),this.webClient.remove(e,{destroyStore:!0},_=>{_&&this.gs.log("[TORRENT_FILE_REMOVE_ERROR]",_,"error"),delete this.torrentsQueue[e],c&&this.ls.setItem(this.gs.localStorageKeys.Torrents,this.torrentsQueue),n&&n(_)})}pauseTorrent(e,n){const c=this.webClient.get(e);c&&(c.pause(),n&&n(c))}resumeTorrent(e,n){const c=this.webClient.get(e);c&&(c.resume(),n&&n(c))}removeAll(){for(const e of this.webClient.torrents)this.removeTorrent(e.infoHash,n=>{n||this.gs.log("[TORRENT_FILE_REMOVE_SUCCESS]",e.infoHash)},!1)}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(T.U),t.LFG(i.s),t.LFG(r.k),t.LFG(u.n))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var g=s(7845),y=s(8381),E=s(3e3);let a=(()=>{class o{constructor(){this.fileDropped=new t.vpe}onDragOver(e){e.preventDefault(),e.stopPropagation(),this.fileOver=!0}onDragLeave(e){e.preventDefault(),e.stopPropagation(),this.fileOver=!1}ondrop(e){e.preventDefault(),e.stopPropagation(),this.fileOver=!1;let n=e.dataTransfer.files;n.length>0&&this.fileDropped.emit(n)}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275dir=t.lG2({type:o,selectors:[["","appDragDrop",""]],hostVars:2,hostBindings:function(e,n){1&e&&t.NdJ("dragover",function(_){return n.onDragOver(_)})("dragleave",function(_){return n.onDragLeave(_)})("drop",function(_){return n.ondrop(_)}),2&e&&t.ekj("fileover",n.fileOver)},outputs:{fileDropped:"fileDropped"}}),o})();var f=s(8616),C=s(7322),Z=s(7531),F=s(5245),B=s(5899),P=s(7238),G=s(7423),k=s(4623),W=s(3626);function J(o,m){1&o&&t._UZ(0,"mat-progress-bar",26)}function V(o,m){1&o&&(t.TgZ(0,"span"),t._uU(1,"\u{1f516} NAME"),t.qZA()),2&o&&t.Udp("color","#ff4081")}function q(o,m){1&o&&(t.TgZ(0,"span"),t._uU(1,"\u{1f4be} SIZE"),t.qZA()),2&o&&t.Udp("color","#ff4081")}function X(o,m){1&o&&(t.TgZ(0,"span"),t._uU(1,"\u{1f4bf} DOWNLOADED"),t.qZA()),2&o&&t.Udp("color","#ff4081")}function tt(o,m){1&o&&(t.TgZ(0,"span"),t._uU(1,"\u{1f4c0} UPLOADED"),t.qZA()),2&o&&t.Udp("color","#ff4081")}function et(o,m){1&o&&(t.TgZ(0,"span"),t._uU(1,"\u{1f504} PROGRESS"),t.qZA()),2&o&&t.Udp("color","#ff4081")}function nt(o,m){1&o&&(t.TgZ(0,"span"),t._uU(1,"\u{1f53d} SPEED"),t.qZA()),2&o&&t.Udp("color","#ff4081")}function ot(o,m){1&o&&(t.TgZ(0,"span"),t._uU(1,"\u{1f53c} SPEED"),t.qZA()),2&o&&t.Udp("color","#ff4081")}function rt(o,m){1&o&&(t.TgZ(0,"span"),t._uU(1,"\u{1f551} ~ETA."),t.qZA()),2&o&&t.Udp("color","#ff4081")}function it(o,m){1&o&&(t.TgZ(0,"span"),t._uU(1,"\u{1f9f2} PEERS"),t.qZA()),2&o&&t.Udp("color","#ff4081")}function st(o,m){1&o&&(t.TgZ(0,"span"),t._uU(1,"\u{1f310} RATIO"),t.qZA()),2&o&&t.Udp("color","#ff4081")}function at(o,m){if(1&o&&(t.TgZ(0,"th",30)(1,"h3",31),t.YNc(2,V,2,2,"span",32),t.YNc(3,q,2,2,"span",32),t.YNc(4,X,2,2,"span",32),t.YNc(5,tt,2,2,"span",32),t.YNc(6,et,2,2,"span",32),t.YNc(7,nt,2,2,"span",32),t.YNc(8,ot,2,2,"span",32),t.YNc(9,rt,2,2,"span",32),t.YNc(10,it,2,2,"span",32),t.YNc(11,st,2,2,"span",32),t.qZA()()),2&o){const e=t.oxw().$implicit;t.xp6(2),t.Q6J("ngIf","NAME"===e.toUpperCase()),t.xp6(1),t.Q6J("ngIf","LENGTH"===e.toUpperCase()),t.xp6(1),t.Q6J("ngIf","DOWNLOADED"===e.toUpperCase()),t.xp6(1),t.Q6J("ngIf","UPLOADED"===e.toUpperCase()),t.xp6(1),t.Q6J("ngIf","PROGRESS"===e.toUpperCase()),t.xp6(1),t.Q6J("ngIf","DOWNLOADSPEED"===e.toUpperCase()),t.xp6(1),t.Q6J("ngIf","UPLOADSPEED"===e.toUpperCase()),t.xp6(1),t.Q6J("ngIf","TIMEREMAINING"===e.toUpperCase()),t.xp6(1),t.Q6J("ngIf","NUMPEERS"===e.toUpperCase()),t.xp6(1),t.Q6J("ngIf","RATIO"===e.toUpperCase())}}function lt(o,m){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit,n=t.oxw().$implicit;t.xp6(1),t.Oqu(e[n])}}function ct(o,m){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"bytes"),t.qZA()),2&o){const e=t.oxw().$implicit,n=t.oxw().$implicit;t.xp6(1),t.Oqu(t.lcZ(2,1,e[n]))}}function ut(o,m){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"bytes"),t.qZA()),2&o){const e=t.oxw().$implicit,n=t.oxw().$implicit;t.xp6(1),t.Oqu(t.lcZ(2,1,e[n]))}}function pt(o,m){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"bytes"),t.qZA()),2&o){const e=t.oxw().$implicit,n=t.oxw().$implicit;t.xp6(1),t.Oqu(t.lcZ(2,1,e[n]))}}function dt(o,m){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"number"),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.hij("",t.xi3(2,1,e.downloaded/e.length*100,"1.2-2")," %")}}function ft(o,m){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"bytes"),t.qZA()),2&o){const e=t.oxw().$implicit,n=t.oxw().$implicit;t.xp6(1),t.hij("",t.lcZ(2,1,e[n]),"/s")}}function ht(o,m){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"bytes"),t.qZA()),2&o){const e=t.oxw().$implicit,n=t.oxw().$implicit;t.xp6(1),t.hij("",t.lcZ(2,1,e[n]),"/s")}}function _t(o,m){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"number"),t.qZA()),2&o){const e=t.oxw().$implicit,n=t.oxw().$implicit;t.xp6(1),t.Oqu(e[n]<=0?"COMPLETED":t.xi3(2,1,e[n]/1e3,"1.0-0")+" s")}}function mt(o,m){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit,n=t.oxw().$implicit;t.xp6(1),t.Oqu(e[n])}}function gt(o,m){if(1&o&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"number"),t.qZA()),2&o){const e=t.oxw().$implicit,n=t.oxw().$implicit;t.xp6(1),t.Oqu(t.xi3(2,1,e[n],"1.4-4"))}}function Tt(o,m){if(1&o&&(t.TgZ(0,"td",33)(1,"h3"),t.YNc(2,lt,2,1,"span",34),t.YNc(3,ct,3,3,"span",34),t.YNc(4,ut,3,3,"span",34),t.YNc(5,pt,3,3,"span",34),t.YNc(6,dt,3,4,"span",34),t.YNc(7,ft,3,3,"span",34),t.YNc(8,ht,3,3,"span",34),t.YNc(9,_t,3,4,"span",34),t.YNc(10,mt,2,1,"span",34),t.YNc(11,gt,3,4,"span",34),t.qZA()()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.Gre("m-0 ","NAME"===e.toUpperCase()?"text-start":"",""),t.xp6(1),t.Q6J("ngIf","NAME"===e.toUpperCase()),t.xp6(1),t.Q6J("ngIf","LENGTH"===e.toUpperCase()),t.xp6(1),t.Q6J("ngIf","DOWNLOADED"===e.toUpperCase()),t.xp6(1),t.Q6J("ngIf","UPLOADED"===e.toUpperCase()),t.xp6(1),t.Q6J("ngIf","PROGRESS"===e.toUpperCase()),t.xp6(1),t.Q6J("ngIf","DOWNLOADSPEED"===e.toUpperCase()),t.xp6(1),t.Q6J("ngIf","UPLOADSPEED"===e.toUpperCase()),t.xp6(1),t.Q6J("ngIf","TIMEREMAINING"===e.toUpperCase()),t.xp6(1),t.Q6J("ngIf","NUMPEERS"===e.toUpperCase()),t.xp6(1),t.Q6J("ngIf","RATIO"===e.toUpperCase())}}function vt(o,m){1&o&&(t.ynx(0,27),t.YNc(1,at,12,10,"th",28),t.YNc(2,Tt,12,13,"td",29),t.BQk()),2&o&&t.s9C("matColumnDef",m.$implicit)}function Ct(o,m){if(1&o&&(t.TgZ(0,"p",41),t._uU(1," Info Hash :: "),t.TgZ(2,"span",52),t._uU(3),t.qZA()()),2&o){const e=t.oxw().$implicit;t.xp6(3),t.hij(" ",e.infoHash," ")}}function Et(o,m){if(1&o){const e=t.EpF();t.TgZ(0,"p",41),t._uU(1," Magnet URI :: "),t.TgZ(2,"span",53),t.NdJ("click",function(){t.CHM(e);const c=t.oxw().$implicit;return t.oxw().copyMagnetHashToClipboard(c.magnetURI)}),t._uU(3),t.qZA()()}if(2&o){const e=t.oxw().$implicit;t.xp6(3),t.hij(" ",e.magnetURI," ")}}function xt(o,m){if(1&o&&(t.TgZ(0,"li"),t._uU(1),t.qZA()),2&o){const e=m.$implicit;t.xp6(1),t.hij(" ",e," ")}}function Dt(o,m){if(1&o){const e=t.EpF();t.TgZ(0,"button",45),t.NdJ("click",function(){t.CHM(e);const c=t.oxw().$implicit;return t.oxw().resumeTorrent(c)}),t.TgZ(1,"mat-icon",46),t._uU(2,"play_arrow"),t.qZA(),t._uU(3," Resume "),t.qZA()}}function bt(o,m){if(1&o){const e=t.EpF();t.TgZ(0,"button",45),t.NdJ("click",function(){t.CHM(e);const c=t.oxw().$implicit;return t.oxw().pauseTorrent(c)}),t.TgZ(1,"mat-icon",46),t._uU(2,"pause"),t.qZA(),t._uU(3," Pause "),t.qZA()}}function Rt(o,m){if(1&o){const e=t.EpF();t.TgZ(0,"mat-list-option",54)(1,"mat-icon",55),t._uU(2,"file_present"),t.qZA(),t.TgZ(3,"div",56),t.NdJ("click",function(){const _=t.CHM(e).$implicit;return t.oxw(2).saveFile(_)}),t.TgZ(4,"span"),t._uU(5),t.qZA(),t._uU(6," -- "),t.TgZ(7,"span",57),t._uU(8),t.ALo(9,"number"),t.qZA(),t._uU(10," :: "),t.TgZ(11,"span",52),t._uU(12),t.ALo(13,"bytes"),t.ALo(14,"bytes"),t.qZA()()()}if(2&o){const e=m.$implicit;t.xp6(4),t.Gre("text-",e.downloaded/e.length>=1?"primary":"bifeldy",""),t.xp6(1),t.hij(" ",e.name," "),t.xp6(3),t.hij(" ",t.xi3(9,7,e.downloaded/e.length*100,"1.2-2")," % "),t.xp6(4),t.AsE(" ",t.lcZ(13,10,e.downloaded)," / ",t.lcZ(14,12,e.length)," ")}}function yt(o,m){if(1&o){const e=t.EpF();t.TgZ(0,"td",35)(1,"div",36)(2,"div",37)(3,"div",38),t._UZ(4,"div"),t.qZA(),t.TgZ(5,"div",39),t.YNc(6,Ct,4,1,"p",40),t.YNc(7,Et,4,1,"p",40),t.TgZ(8,"div",41),t._uU(9," Announce Trackers :: "),t.TgZ(10,"ul",42),t.YNc(11,xt,2,1,"li",43),t.qZA()(),t.TgZ(12,"div",44)(13,"button",45),t.NdJ("click",function(){const _=t.CHM(e).$implicit;return t.oxw().refreshGraph(_)}),t.TgZ(14,"mat-icon",46),t._uU(15,"refresh"),t.qZA(),t._uU(16," Refresh Graph "),t.qZA(),t.TgZ(17,"button",45),t.NdJ("click",function(){const _=t.CHM(e).$implicit;return t.oxw().removeTorrent(_)}),t.TgZ(18,"mat-icon",46),t._uU(19,"delete_outline"),t.qZA(),t._uU(20," Remove "),t.qZA(),t.YNc(21,Dt,4,0,"button",47),t.YNc(22,bt,4,0,"button",47),t.qZA(),t.TgZ(23,"div",48)(24,"div",49),t._uU(25,"Rincian Isi Berkas \u2728"),t.qZA(),t.TgZ(26,"mat-selection-list",50),t.YNc(27,Rt,15,14,"mat-list-option",51),t.qZA()()()()()()}if(2&o){const e=m.$implicit,n=t.oxw();t.uIk("colspan",n.tableDataColumn.length),t.xp6(1),t.Q6J("@detailExpand",e===n.TORRENT.expandedRow?"expanded":"collapsed"),t.xp6(3),t.Gre("p2p-graph graphP2p-",e.infoHash,""),t.xp6(2),t.Q6J("ngIf",e.infoHash),t.xp6(1),t.Q6J("ngIf",e.magnetURI),t.xp6(4),t.Q6J("ngForOf",e.announce),t.xp6(10),t.Q6J("ngIf",e.paused),t.xp6(1),t.Q6J("ngIf",!e.paused),t.xp6(4),t.Q6J("multiple",!1),t.xp6(1),t.Q6J("ngForOf",e.files)}}function Ot(o,m){1&o&&t._UZ(0,"tr",58)}function wt(o,m){if(1&o){const e=t.EpF();t.TgZ(0,"tr",59),t.NdJ("click",function(){const _=t.CHM(e).$implicit;return t.oxw().toggleExpanded(_)}),t.qZA()}if(2&o){const e=m.$implicit,n=t.oxw();t.ekj("expanded-row",n.TORRENT.expandedRow===e)}}function At(o,m){1&o&&t._UZ(0,"tr",60)}function Lt(o,m){if(1&o&&(t.TgZ(0,"tr",61)(1,"td",62)(2,"div",63)(3,"div",64)(4,"h3",31),t._uU(5," Tidak Ada Data \xaf\\_(\u30c4)_/\xaf "),t.qZA()()()()()),2&o){const e=t.oxw();t.xp6(1),t.uIk("colspan",e.tableDataColumn.length)}}const It=function(){return["expandedDetail"]};let Nt=(()=>{class o{constructor(e,n,c,_,A,$,K,j){this.snackBar=e,this.clipboard=n,this.gs=c,this.torrent=_,this.toast=A,this.ds=$,this.ss=K,this.bs=j,this.isProcessing=!1,this.magnetHash=null,this.torrentsGraph={},this.tableDataColumn=["name","length","downloaded","uploaded","progress","downloadSpeed","uploadSpeed","timeRemaining","numPeers","ratio"],this.files=[],this.subsDialog=null,this.subsUser=null,this.subsTableDataRow=null,this.timedOut=null,this.gs.bannerImg=null,this.gs.sizeContain=!1,this.gs.bgRepeat=!1}get ENV(){return d.N}get TORRENT(){return this.torrent}ngOnInit(){this.dataSource=new x.by,this.gs.isBrowser&&(this.dataSource.sort=this.sort,this.subsTableDataRow=this.torrent.tableDataRow.subscribe({next:e=>{this.dataSource.data=e,this.refreshAllGraph()}}),this.reviveTorrent())}ngOnDestroy(){var e,n,c,_,A;null===(n=null===(e=this.sort)||void 0===e?void 0:e.sortChange)||void 0===n||n.unsubscribe(),null===(c=this.subsDialog)||void 0===c||c.unsubscribe(),null===(_=this.subsUser)||void 0===_||_.unsubscribe(),null===(A=this.subsTableDataRow)||void 0===A||A.unsubscribe(),this.timedOut&&(clearTimeout(this.timedOut),this.timedOut=null)}copyMagnetHashToClipboard(e){this.clipboard.copy(e)&&this.snackBar.open("Magnet Link Hash :: Telah Di Salin Pada Clipboard","Ok")}toggleExpanded(e){this.gs.log("[TORRENT_CLICKED]",e),this.torrent.expandedRow=this.torrent.expandedRow===e?null:e,this.refreshGraph(e)}saveFile(e){e.downloaded/e.length>=1?(this.bs.busy(),e.getBlobURL((n,c)=>{n||(this.gs.log("[TORRENT_FILE_BLOBURL]",c),(0,b.saveAs)(c,e.name),this.bs.idle())})):this.toast.info("Berkas Sedang Dalam Proses Unduhan!","Yah, File Belum Siap!",null,!0)}reviveTorrent(){this.torrent.resurrectFiles((e,n)=>{this.refreshAllGraph()})}resumeTorrent(e){this.torrent.resumeTorrent(e.infoHash,n=>{this.refreshAllGraph()})}pauseTorrent(e){this.torrent.pauseTorrent(e.infoHash,n=>{n||this.gs.log("[TORRENT_FILE_PAUSE_SUCCESS]",e.infoHash),this.refreshAllGraph()})}removeTorrent(e){this.torrent.removeTorrent(e.infoHash,n=>{n||this.gs.log("[TORRENT_FILE_REMOVE_SUCCESS]",e.infoHash),this.torrentsGraph[e.infoHash].destroy(),delete this.torrentsGraph[e.infoHash],this.refreshAllGraph()})}downloadFiles(e){this.isProcessing=!0,this.torrent.downloadFiles(this.magnetHash,(n,c)=>{this.magnetHash=null,this.isProcessing=!1,this.refreshAllGraph()})}uploadFiles(e){this.gs.log("[TORRENT_SEED_USER_INFORMATION]",e),this.isProcessing=!0,this.torrent.uploadFiles(e,this.files,(n,c)=>{this.isProcessing=!1,this.refreshAllGraph()})}prepareFilesList(e){this.files=[];for(const c of e)this.files.push(c);const n={torrent_name:{inputLabel:"Nama Torrent",inputPlaceholder:`Torrent # ${this.ss.mySocket.id} @ ${(new Date).toUTCString()}`,inputValue:null,inputRequired:!0}};1===this.files.length?(n.torrent_name.inputPlaceholder=this.files[0].name,this.uploadFiles(n.torrent_name.inputPlaceholder)):this.files.length>1&&(this.subsDialog=this.ds.openInputDialog({data:{title:"Silahkan Masukkan Nama Untuk Torrent Kamu!",input:n,confirmText:"Ya, Mulai SEED",cancelText:"Tidak, Batal"}}).afterClosed().subscribe({next:c=>{this.gs.log("[INPUT_DIALOG_CLOSED]",c),c&&this.uploadFiles(c.torrent_name),this.subsDialog.unsubscribe()}}))}onFileDropped(e){this.prepareFilesList(e)}fileBrowseHandler(e){this.prepareFilesList(e.target.files)}initGraph(e){!this.torrentsGraph[e.infoHash]&&this.dataSource.data.length>0&&(this.gs.log("[TORRENT_WIRE_INIT_GRAPH]",e),this.torrentsGraph[e.infoHash]=new P2PGraph(`.graphP2p-${e.infoHash}`),this.torrentsGraph[e.infoHash].add({id:this.torrent.webClient.peerId,me:!0,name:"Kamu!"}))}addAllGraph(e){this.gs.log("[TORRENT_WIRE_RELOAD_GRAPH]",e);for(const n of e.wires){let c=n.peerId||"Anonim!";n.remoteAddress&&n.remotePort&&(c=`${n.remoteAddress}:${n.remotePort}`),this.torrentsGraph[e.infoHash].add({id:n.peerId,name:c}),this.torrentsGraph[e.infoHash].connect(this.torrent.webClient.peerId,n.peerId)}}deleteAllGraph(e){this.gs.log("[TORRENT_WIRE_DELETE_GRAPH]",e);const n=this.torrentsGraph[e.infoHash].list().filter(c=>c.id!==this.torrent.webClient.peerId);for(const c of n)this.torrentsGraph[e.infoHash].disconnect(this.torrent.webClient.peerId,c.id),this.torrentsGraph[e.infoHash].remove(c.id)}refreshGraph(e){this.gs.log("[TORRENT_WIRE_REFRESH_GRAPH]",e),this.torrentsGraph[e.infoHash]?(this.deleteAllGraph(e),this.addAllGraph(e)):this.initGraph(e)}refreshAllGraph(){for(const e of this.dataSource.data)this.timedOut=setTimeout(()=>{this.refreshGraph(e)},1234)}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(D.ux),t.Y36(R.TU),t.Y36(T.U),t.Y36(h),t.Y36(r.k),t.Y36(g.x),t.Y36(y.R),t.Y36(E.z))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-torrent"]],viewQuery:function(e,n){if(1&e&&t.Gf(O.YE,7),2&e){let c;t.iGM(c=t.CRH())&&(n.sort=c.first)}},decls:37,vars:13,consts:[["appDragDrop","",1,"h-100",3,"fileDropped"],[1,"container"],[1,"row","pb-3","px-0"],[1,"col-12"],[1,"row"],[1,"col-12","sticky-top","bg-bifeldy"],[1,"pt-3","border-bottom-dotted"],[1,"text-bifeldy"],["hintLabel","Isi Lalu Tekan 'Enter' Untuk Mencari Torrent ...",1,"col-12","col-md-6","col-lg-4","px-3","mb-3",3,"color"],["matInput","","placeholder","Ex. magnet:123qwe...!@#",3,"ngModel","disabled","keyup.enter","ngModelChange"],["input",""],["matSuffix",""],["color","warn","mode","indeterminate",4,"ngIf"],[1,"row","mx-2"],[1,"col-12",2,"overflow-x","auto"],["mat-table","","matSort","","multiTemplateDataRows","",1,"bg-transparent",3,"dataSource"],[3,"matColumnDef",4,"ngFor","ngForOf"],["matColumnDef","expandedDetail"],["mat-cell","",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","","class","element-row",3,"expanded-row","click",4,"matRowDef","matRowDefColumns"],["mat-row","","class","detail-row",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["type","file","id","fileDropRef","multiple","",2,"visibility","hidden",3,"disabled","change"],["fileDropRef",""],["type","button","mat-fab","","color","warn","matTooltip","Seed Berkas",1,"me-3","mb-5","fab-button","animate__animated","animate__bounce","animate__infinite","animate__slow",2,"position","fixed","bottom","0","right","0",3,"disabled","click"],["color","warn","mode","indeterminate"],[3,"matColumnDef"],["mat-header-cell","","class","px-3 text-center","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","","class","px-3 text-center","style","cursor: pointer;",4,"matCellDef"],["mat-header-cell","","mat-sort-header","",1,"px-3","text-center"],[1,"m-0"],[3,"color",4,"ngIf"],["mat-cell","",1,"px-3","text-center",2,"cursor","pointer"],[4,"ngIf"],["mat-cell",""],[1,"element-detail"],[1,"py-3","row"],[1,"col-3"],[1,"col-9"],["class","px-2 text-truncate",4,"ngIf"],[1,"px-2","text-truncate"],[1,"text-success","m-0"],[4,"ngFor","ngForOf"],[1,"p-2"],["type","button","mat-stroked-button","",1,"m-1","text-warning",3,"click"],[1,"me-1"],["type","button","mat-stroked-button","","class","m-1 text-warning",3,"click",4,"ngIf"],[1,"px-2"],["mat-subheader","",1,"p-0"],[3,"multiple"],["class","h-100",4,"ngFor","ngForOf"],[1,"text-success"],["matTooltip","Klik Untuk Menyalin!",1,"text-primary","text-decoration-none",3,"click"],[1,"h-100"],["mat-list-icon","",1,"ps-3"],[2,"cursor","pointer",3,"click"],[1,"text-warning"],["mat-header-row",""],["mat-row","",1,"element-row",3,"click"],["mat-row","",1,"detail-row"],[1,"mat-row"],[1,"mat-cell","text-center","align-items-center","p-0",2,"background-image","url('/assets/img/404/no-data.png')","background-size","contain","background-position","center","background-repeat","no-repeat","height","256px"],[1,"row","align-items-center","h-100"],[1,"col-8","mx-auto","text-light","text-center","rounded","py-3",2,"background-color","rgba(128, 128, 128, 0.875)"]],template:function(e,n){if(1&e){const c=t.EpF();t.TgZ(0,"div",0),t.NdJ("fileDropped",function(A){return n.onFileDropped(A)}),t._UZ(1,"app-notifications"),t.TgZ(2,"div",1)(3,"div",2)(4,"div",3)(5,"div",4)(6,"div",5)(7,"h2",6)(8,"b",7),t._uU(9,"Web-SocketRTC Torrent"),t.qZA()()(),t.TgZ(10,"div",3)(11,"mat-form-field",8)(12,"mat-label"),t._uU(13,"Unduh Dari Info Hash / Magnet URI"),t.qZA(),t.TgZ(14,"input",9,10),t.NdJ("keyup.enter",function(A){return n.downloadFiles(A)})("ngModelChange",function(A){return n.magnetHash=A}),t.qZA(),t.TgZ(16,"mat-icon",11),t._uU(17,"cloud_download"),t.qZA(),t.YNc(18,J,1,0,"mat-progress-bar",12),t.qZA(),t.TgZ(19,"div",13)(20,"div",14)(21,"table",15),t.YNc(22,vt,3,1,"ng-container",16),t.ynx(23,17),t.YNc(24,yt,28,12,"td",18),t.BQk(),t.YNc(25,Ot,1,0,"tr",19),t.YNc(26,wt,1,2,"tr",20),t.YNc(27,At,1,0,"tr",21),t.YNc(28,Lt,6,1,"tr",22),t.qZA()(),t.TgZ(29,"div",3)(30,"marquee"),t._uU(31),t.qZA()()()()()()()(),t.TgZ(32,"input",23,24),t.NdJ("change",function(A){return n.fileBrowseHandler(A)}),t.qZA(),t.TgZ(34,"button",25),t.NdJ("click",function(){return t.CHM(c),t.MAs(33).click()}),t.TgZ(35,"mat-icon"),t._uU(36,"cloud_upload"),t.qZA()()()}2&e&&(t.xp6(11),t.Q6J("color","accent"),t.xp6(3),t.Q6J("ngModel",n.magnetHash)("disabled",n.isProcessing),t.xp6(4),t.Q6J("ngIf",n.isProcessing),t.xp6(3),t.Q6J("dataSource",n.dataSource),t.xp6(1),t.Q6J("ngForOf",n.tableDataColumn),t.xp6(3),t.Q6J("matHeaderRowDef",n.tableDataColumn),t.xp6(1),t.Q6J("matRowDefColumns",n.tableDataColumn),t.xp6(1),t.Q6J("matRowDefColumns",t.DdM(12,It)),t.xp6(4),t.hij("Terhubung Dengan Tracker :: ",n.ENV.torrent.trackerAnnounce.join(" :: "),""),t.xp6(1),t.Q6J("disabled",n.isProcessing),t.xp6(2),t.Q6J("disabled",n.isProcessing))},directives:[a,f.t,C.KE,C.hX,Z.Nt,L.Fj,L.JJ,L.On,F.Hw,C.R9,l.O5,B.pW,x.BZ,O.YE,l.sg,x.w1,x.fO,x.ge,O.nU,x.Dz,x.ev,P.gM,G.lW,k.gs,k.Ub,k.vS,k.Nh,x.as,x.XQ,x.nj,x.Gk,x.Ee],pipes:[W.$,l.JJ],styles:[".p2p-graph[_ngcontent-%COMP%]{background-color:#8d8d8d80!important}tr.detail-row[_ngcontent-%COMP%]{height:0}tr.element-row[_ngcontent-%COMP%]:not(.expanded-row):hover{background-color:#ffffffdf}.element-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-bottom-width:0}.element-detail[_ngcontent-%COMP%]{overflow:hidden;display:flex}.fileover[_ngcontent-%COMP%]{animation:shake 1s;animation-iteration-count:infinite}@keyframes shake{0%{transform:translate(1px,1px) rotate(0)}10%{transform:translate(-1px,-2px) rotate(-1deg)}20%{transform:translate(-3px) rotate(1deg)}30%{transform:translate(3px,2px) rotate(0)}40%{transform:translate(1px,-1px) rotate(1deg)}50%{transform:translate(-1px,2px) rotate(-1deg)}60%{transform:translate(-3px,1px) rotate(0)}70%{transform:translate(3px,1px) rotate(-1deg)}80%{transform:translate(-1px,-1px) rotate(1deg)}90%{transform:translate(1px,2px) rotate(0)}to{transform:translate(1px,-2px) rotate(-1deg)}}"],data:{animation:[(0,p.X$)("detailExpand",[(0,p.SB)("collapsed",(0,p.oB)({height:"0px",minHeight:"0"})),(0,p.SB)("expanded",(0,p.oB)({height:"*"})),(0,p.eR)("expanded <=> collapsed",(0,p.jt)("225ms cubic-bezier(0.4, 0.0, 0.2, 1)"))])]}}),o})();var Ut=s(210),Mt=s(7355),Zt=s(8613),Pt=s(4946),St=s(7956);const Ft=[{path:"",pathMatch:"full",component:Nt}];let kt=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[l.ez,N.Bz.forChild(Ft),L.u5,St.C,Zt.F,Ut.m,Pt.P,Mt.T]]}),o})()},4946:(M,w,s)=>{"use strict";s.d(w,{P:()=>p});var l=s(9808),N=s(210),L=s(5e3);let p=(()=>{class O{}return O.\u0275fac=function(b){return new(b||O)},O.\u0275mod=L.oAB({type:O}),O.\u0275inj=L.cJS({imports:[[l.ez,N.m]]}),O})()},8616:(M,w,s)=>{"use strict";s.d(w,{t:()=>R});var l=s(5e3),N=s(8406),L=s(8696),p=s(7140),O=s(9808),x=s(1861);function b(T,U){if(1&T&&l._UZ(0,"div",4),2&T){const v=l.oxw();l.Udp("background-size",v.GS.sizeContain?"contain":"cover")("background-image","url("+v.GS.bannerImg+")")("background-repeat",v.GS.bgRepeat?"repeat-x":"no-repeat")("height","/news"===v.ROUTER.url||v.ROUTER.url.includes("/news?")||"/berkas"===v.ROUTER.url||v.ROUTER.url.includes("/berkas?")||"/fansub"===v.ROUTER.url||v.ROUTER.url.includes("/fansub?")?"192px":"128px")("background-position-y","/berkas"===v.ROUTER.url||v.ROUTER.url.includes("/berkas?")?"22.5%":"")}}function d(T,U){if(1&T&&(l.TgZ(0,"strong",10),l._uU(1," -- "),l.TgZ(2,"i")(3,"a",11),l._uU(4),l.qZA()()()),2&T){const v=l.oxw().$implicit;l.xp6(3),l.MGl("routerLink","/user/",v.notifCreator,""),l.xp6(1),l.hij(" ",v.notifCreator," ")}}function t(T,U){if(1&T){const v=l.EpF();l.TgZ(0,"button",12),l.NdJ("click",function(){l.CHM(v);const H=l.oxw().$implicit;return l.oxw().removeNotif(H.notifData.id)}),l.qZA()}}function D(T,U){if(1&T&&(l.TgZ(0,"div",5)(1,"div")(2,"strong",6),l._uU(3),l.qZA(),l._UZ(4,"span",7),l.ALo(5,"safeInnerHtml"),l.YNc(6,d,5,2,"strong",8),l.YNc(7,t,1,0,"button",9),l.qZA()()),2&T){const v=U.$implicit;l.xp6(1),l.Gre("alert alert-",v.notifData.type," alert-dismissible fade show"),l.xp6(2),l.Oqu(v.notifData.title),l.xp6(1),l.Q6J("innerHTML",l.lcZ(5,7,v.notifData.content),l.oJD),l.xp6(2),l.Q6J("ngIf",v.notifCreator),l.xp6(1),l.Q6J("ngIf",v.notifData.dismissible)}}let R=(()=>{class T{constructor(v,I,H){this.router=v,this.gs=I,this.notif=H}ngOnInit(){}get GS(){return this.gs}get ROUTER(){return this.router}get NOTIF(){return this.notif}removeNotif(v){this.notif.removeNotif(v)}}return T.\u0275fac=function(v){return new(v||T)(l.Y36(N.F0),l.Y36(L.U),l.Y36(p.T))},T.\u0275cmp=l.Xpm({type:T,selectors:[["app-notifications"]],decls:4,vars:2,consts:[["class","container-fluid notif-banner align-items-center",3,"background-size","background-image","background-repeat","height","background-position-y",4,"ngIf"],[1,"container"],[1,"row","pt-3"],["class","col-12",4,"ngFor","ngForOf"],[1,"container-fluid","notif-banner","align-items-center"],[1,"col-12"],[1,"me-1"],[3,"innerHTML"],["class","ms-1",4,"ngIf"],["type","button","class","btn-close","data-dismiss","alert",3,"click",4,"ngIf"],[1,"ms-1"],[1,"text-decoration-none",3,"routerLink"],["type","button","data-dismiss","alert",1,"btn-close",3,"click"]],template:function(v,I){1&v&&(l.YNc(0,b,1,10,"div",0),l.TgZ(1,"div",1)(2,"div",2),l.YNc(3,D,8,9,"div",3),l.qZA()()),2&v&&(l.Q6J("ngIf",I.GS.bannerImg&&("/news"===I.ROUTER.url||I.ROUTER.url.includes("/news?")||"/berkas"===I.ROUTER.url||I.ROUTER.url.includes("/berkas?")||"/fansub"===I.ROUTER.url||I.ROUTER.url.includes("/fansub?")||"/anime"===I.ROUTER.url||I.ROUTER.url.includes("/anime?")||"/dorama"===I.ROUTER.url||I.ROUTER.url.includes("/dorama?"))),l.xp6(3),l.Q6J("ngForOf",I.NOTIF.notifications))},directives:[O.O5,O.sg,N.yS],pipes:[x.H],styles:[".notif-banner[_ngcontent-%COMP%]{width:100%;background-size:cover;background-position:75% 50%}"]}),T})()},8613:(M,w,s)=>{"use strict";s.d(w,{F:()=>O});var l=s(9808),N=s(8406),L=s(7355),p=s(5e3);let O=(()=>{class x{}return x.\u0275fac=function(d){return new(d||x)},x.\u0275mod=p.oAB({type:x}),x.\u0275inj=p.cJS({imports:[[l.ez,N.Bz,L.T]]}),x})()},7956:(M,w,s)=>{"use strict";s.d(w,{C:()=>L});var l=s(9808),N=s(5e3);let L=(()=>{class p{}return p.\u0275fac=function(x){return new(x||p)},p.\u0275mod=N.oAB({type:p}),p.\u0275inj=N.cJS({imports:[[l.ez]]}),p})()},9069:M=>{"use strict";var l,w="object"==typeof Reflect?Reflect:null,s=w&&"function"==typeof w.apply?w.apply:function(r,u,h){return Function.prototype.apply.call(r,u,h)};l=w&&"function"==typeof w.ownKeys?w.ownKeys:Object.getOwnPropertySymbols?function(r){return Object.getOwnPropertyNames(r).concat(Object.getOwnPropertySymbols(r))}:function(r){return Object.getOwnPropertyNames(r)};var L=Number.isNaN||function(r){return r!=r};function p(){p.init.call(this)}M.exports=p,M.exports.once=function H(i,r){return new Promise(function(u,h){function g(E){i.removeListener(r,y),h(E)}function y(){"function"==typeof i.removeListener&&i.removeListener("error",g),u([].slice.call(arguments))}S(i,r,y,{once:!0}),"error"!==r&&function Q(i,r,u){"function"==typeof i.on&&S(i,"error",r,u)}(i,g,{once:!0})})},p.EventEmitter=p,p.prototype._events=void 0,p.prototype._eventsCount=0,p.prototype._maxListeners=void 0;var O=10;function x(i){if("function"!=typeof i)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof i)}function b(i){return void 0===i._maxListeners?p.defaultMaxListeners:i._maxListeners}function d(i,r,u,h){var g,y,E;if(x(u),void 0===(y=i._events)?(y=i._events=Object.create(null),i._eventsCount=0):(void 0!==y.newListener&&(i.emit("newListener",r,u.listener?u.listener:u),y=i._events),E=y[r]),void 0===E)E=y[r]=u,++i._eventsCount;else if("function"==typeof E?E=y[r]=h?[u,E]:[E,u]:h?E.unshift(u):E.push(u),(g=b(i))>0&&E.length>g&&!E.warned){E.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+E.length+" "+String(r)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=i,a.type=r,a.count=E.length,function N(i){console&&console.warn&&console.warn(i)}(a)}return i}function t(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function D(i,r,u){var h={fired:!1,wrapFn:void 0,target:i,type:r,listener:u},g=t.bind(h);return g.listener=u,h.wrapFn=g,g}function R(i,r,u){var h=i._events;if(void 0===h)return[];var g=h[r];return void 0===g?[]:"function"==typeof g?u?[g.listener||g]:[g]:u?function I(i){for(var r=new Array(i.length),u=0;u<r.length;++u)r[u]=i[u].listener||i[u];return r}(g):U(g,g.length)}function T(i){var r=this._events;if(void 0!==r){var u=r[i];if("function"==typeof u)return 1;if(void 0!==u)return u.length}return 0}function U(i,r){for(var u=new Array(r),h=0;h<r;++h)u[h]=i[h];return u}function S(i,r,u,h){if("function"==typeof i.on)h.once?i.once(r,u):i.on(r,u);else{if("function"!=typeof i.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof i);i.addEventListener(r,function g(y){h.once&&i.removeEventListener(r,g),u(y)})}}Object.defineProperty(p,"defaultMaxListeners",{enumerable:!0,get:function(){return O},set:function(i){if("number"!=typeof i||i<0||L(i))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+i+".");O=i}}),p.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},p.prototype.setMaxListeners=function(r){if("number"!=typeof r||r<0||L(r))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+r+".");return this._maxListeners=r,this},p.prototype.getMaxListeners=function(){return b(this)},p.prototype.emit=function(r){for(var u=[],h=1;h<arguments.length;h++)u.push(arguments[h]);var g="error"===r,y=this._events;if(void 0!==y)g=g&&void 0===y.error;else if(!g)return!1;if(g){var E;if(u.length>0&&(E=u[0]),E instanceof Error)throw E;var a=new Error("Unhandled error."+(E?" ("+E.message+")":""));throw a.context=E,a}var f=y[r];if(void 0===f)return!1;if("function"==typeof f)s(f,this,u);else{var C=f.length,Z=U(f,C);for(h=0;h<C;++h)s(Z[h],this,u)}return!0},p.prototype.on=p.prototype.addListener=function(r,u){return d(this,r,u,!1)},p.prototype.prependListener=function(r,u){return d(this,r,u,!0)},p.prototype.once=function(r,u){return x(u),this.on(r,D(this,r,u)),this},p.prototype.prependOnceListener=function(r,u){return x(u),this.prependListener(r,D(this,r,u)),this},p.prototype.off=p.prototype.removeListener=function(r,u){var h,g,y,E,a;if(x(u),void 0===(g=this._events))return this;if(void 0===(h=g[r]))return this;if(h===u||h.listener===u)0==--this._eventsCount?this._events=Object.create(null):(delete g[r],g.removeListener&&this.emit("removeListener",r,h.listener||u));else if("function"!=typeof h){for(y=-1,E=h.length-1;E>=0;E--)if(h[E]===u||h[E].listener===u){a=h[E].listener,y=E;break}if(y<0)return this;0===y?h.shift():function v(i,r){for(;r+1<i.length;r++)i[r]=i[r+1];i.pop()}(h,y),1===h.length&&(g[r]=h[0]),void 0!==g.removeListener&&this.emit("removeListener",r,a||u)}return this},p.prototype.removeAllListeners=function(r){var u,h,g;if(void 0===(h=this._events))return this;if(void 0===h.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==h[r]&&(0==--this._eventsCount?this._events=Object.create(null):delete h[r]),this;if(0===arguments.length){var E,y=Object.keys(h);for(g=0;g<y.length;++g)"removeListener"!==(E=y[g])&&this.removeAllListeners(E);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(u=h[r]))this.removeListener(r,u);else if(void 0!==u)for(g=u.length-1;g>=0;g--)this.removeListener(r,u[g]);return this},p.prototype.listeners=function(r){return R(this,r,!0)},p.prototype.rawListeners=function(r){return R(this,r,!1)},p.listenerCount=function(i,r){return"function"==typeof i.listenerCount?i.listenerCount(r):T.call(i,r)},p.prototype.listenerCount=T,p.prototype.eventNames=function(){return this._eventsCount>0?l(this._events):[]}},9076:(M,w,s)=>{"use strict";var l=s(8926).default;const N=s(8202),L=s(9069).EventEmitter,p=s(6643);M.exports=class O extends L{constructor(b,d){if(d||(d={}),super(),this.chunkLength=Number(b),!this.chunkLength)throw new Error("First argument must be a chunk length");this.closed=!1,this.destroyed=!1,this.length=Number(d.length)||1/0,this.name=d.name||"idb-chunk-store",this.length!==1/0&&(this.lastChunkLength=this.length%this.chunkLength||this.chunkLength,this.lastChunkIndex=Math.ceil(this.length/this.chunkLength)-1),this.dbPromise=N.openDB(this.name,void 0,{upgrade:t=>{t.createObjectStore("chunks")},blocking:()=>{this.close()},terminated:()=>{this.closed=!0,this.emit("error",new Error("Database unexpectedly closed"))}})}put(b,d,t=(()=>{})){var D=this;if(this.closed)return p(()=>t(new Error("Storage is closed")));const R=b===this.lastChunkIndex;return R&&d.length!==this.lastChunkLength?p(()=>t(new Error("Last chunk length must be "+this.lastChunkLength))):R||d.length===this.chunkLength?((0!==(d=new Uint8Array(d.buffer,d.byteOffset,d.byteLength)).byteOffset||d.byteLength!==d.buffer.byteLength)&&(d=d.slice()),void l(function*(){try{yield(yield D.dbPromise).put("chunks",d,b)}catch(T){return void t(T)}t(null)})()):p(()=>t(new Error("Chunk length must be "+this.chunkLength)))}get(b,d,t=(()=>{})){var D=this;return"function"==typeof d?this.get(b,{},d):(d||(d={}),this.closed?p(()=>t(new Error("Storage is closed"))):void l(function*(){let R;try{R=yield(yield D.dbPromise).get("chunks",b)}catch(I){return void t(I)}if(null==R){const I=new Error("Chunk not found");return I.notFound=!0,void t(I)}let T=Buffer.from(R.buffer,R.byteOffset,R.byteLength);const U=d.offset||0,v=d.length||T.length-U;(0!==U||v!==T.length)&&(T=T.slice(U,v+U)),t(null,T)})())}close(b=(()=>{})){var d=this;if(this.closed)return p(()=>b(new Error("Storage is closed")));this.closed=!0,l(function*(){try{(yield d.dbPromise).close()}catch(t){return void b(t)}b(null)})()}destroy(b=(()=>{})){var d=this;return this.closed?p(()=>b(new Error("Storage is closed"))):this.destroyed?p(()=>b(new Error("Storage is destroyed"))):(this.destroyed=!0,void this.close(function(){var t=l(function*(D){if(D)b(D);else{try{yield N.deleteDB(d.name)}catch(R){return void b(R)}b(null)}});return function(D){return t.apply(this,arguments)}}()))}}},8202:(M,w,s)=>{"use strict";s.r(w),s.d(w,{deleteDB:()=>u,openDB:()=>r,unwrap:()=>i,wrap:()=>S});var l=s(5861);let L,p;const b=new WeakMap,d=new WeakMap,t=new WeakMap,D=new WeakMap,R=new WeakMap;let v={get(a,f,C){if(a instanceof IDBTransaction){if("done"===f)return d.get(a);if("objectStoreNames"===f)return a.objectStoreNames||t.get(a);if("store"===f)return C.objectStoreNames[1]?void 0:C.objectStore(C.objectStoreNames[0])}return S(a[f])},set:(a,f,C)=>(a[f]=C,!0),has:(a,f)=>a instanceof IDBTransaction&&("done"===f||"store"===f)||f in a};function Q(a){return"function"==typeof a?function H(a){return a!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function x(){return p||(p=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(a)?function(...f){return a.apply(i(this),f),S(b.get(this))}:function(...f){return S(a.apply(i(this),f))}:function(f,...C){const Z=a.call(i(this),f,...C);return t.set(Z,f.sort?f.sort():[f]),S(Z)}}(a):(a instanceof IDBTransaction&&function U(a){if(d.has(a))return;const f=new Promise((C,Z)=>{const F=()=>{a.removeEventListener("complete",B),a.removeEventListener("error",P),a.removeEventListener("abort",P)},B=()=>{C(),F()},P=()=>{Z(a.error||new DOMException("AbortError","AbortError")),F()};a.addEventListener("complete",B),a.addEventListener("error",P),a.addEventListener("abort",P)});d.set(a,f)}(a),((a,f)=>f.some(C=>a instanceof C))(a,function O(){return L||(L=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(a,v):a)}function S(a){if(a instanceof IDBRequest)return function T(a){const f=new Promise((C,Z)=>{const F=()=>{a.removeEventListener("success",B),a.removeEventListener("error",P)},B=()=>{C(S(a.result)),F()},P=()=>{Z(a.error),F()};a.addEventListener("success",B),a.addEventListener("error",P)});return f.then(C=>{C instanceof IDBCursor&&b.set(C,a)}).catch(()=>{}),R.set(f,a),f}(a);if(D.has(a))return D.get(a);const f=Q(a);return f!==a&&(D.set(a,f),R.set(f,a)),f}const i=a=>R.get(a);function r(a,f,{blocked:C,upgrade:Z,blocking:F,terminated:B}={}){const P=indexedDB.open(a,f),G=S(P);return Z&&P.addEventListener("upgradeneeded",k=>{Z(S(P.result),k.oldVersion,k.newVersion,S(P.transaction))}),C&&P.addEventListener("blocked",()=>C()),G.then(k=>{B&&k.addEventListener("close",()=>B()),F&&k.addEventListener("versionchange",()=>F())}).catch(()=>{}),G}function u(a,{blocked:f}={}){const C=indexedDB.deleteDatabase(a);return f&&C.addEventListener("blocked",()=>f()),S(C).then(()=>{})}const h=["get","getKey","getAll","getAllKeys","count"],g=["put","add","delete","clear"],y=new Map;function E(a,f){if(!(a instanceof IDBDatabase)||f in a||"string"!=typeof f)return;if(y.get(f))return y.get(f);const C=f.replace(/FromIndex$/,""),Z=f!==C,F=g.includes(C);if(!(C in(Z?IDBIndex:IDBObjectStore).prototype)||!F&&!h.includes(C))return;const B=function(){var P=(0,l.Z)(function*(G,...k){const W=this.transaction(G,F?"readwrite":"readonly");let J=W.store;return Z&&(J=J.index(k.shift())),(yield Promise.all([J[C](...k),F&&W.done]))[0]});return function(k){return P.apply(this,arguments)}}();return y.set(f,B),B}!function I(a){v=a(v)}(a=>({...a,get:(f,C,Z)=>E(f,C)||a.get(f,C,Z),has:(f,C)=>!!E(f,C)||a.has(f,C)}))},6643:M=>{let w;M.exports="function"==typeof queueMicrotask?queueMicrotask.bind("undefined"!=typeof window?window:global):s=>(w||(w=Promise.resolve())).then(s).catch(l=>setTimeout(()=>{throw l},0))},8926:M=>{function w(l,N,L,p,O,x,b){try{var d=l[x](b),t=d.value}catch(D){return void L(D)}d.done?N(t):Promise.resolve(t).then(p,O)}M.exports=function s(l){return function(){var N=this,L=arguments;return new Promise(function(p,O){var x=l.apply(N,L);function b(t){w(x,p,O,b,d,"next",t)}function d(t){w(x,p,O,b,d,"throw",t)}b(void 0)})}},M.exports.__esModule=!0,M.exports.default=M.exports},9287:(M,w,s)=>{"use strict";s.d(w,{TU:()=>p});var l=s(9808),N=s(5e3);class L{constructor(t,D){this._document=D;const R=this._textarea=this._document.createElement("textarea"),T=R.style;T.position="fixed",T.top=T.opacity="0",T.left="-999em",R.setAttribute("aria-hidden","true"),R.value=t,this._document.body.appendChild(R)}copy(){const t=this._textarea;let D=!1;try{if(t){const R=this._document.activeElement;t.select(),t.setSelectionRange(0,t.value.length),D=this._document.execCommand("copy"),R&&R.focus()}}catch(R){}return D}destroy(){const t=this._textarea;t&&(t.remove(),this._textarea=void 0)}}let p=(()=>{class d{constructor(D){this._document=D}copy(D){const R=this.beginCopy(D),T=R.copy();return R.destroy(),T}beginCopy(D){return new L(D,this._document)}}return d.\u0275fac=function(D){return new(D||d)(N.LFG(l.K0))},d.\u0275prov=N.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"}),d})()}}]);
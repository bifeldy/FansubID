(self.webpackChunkfansubid=self.webpackChunkfansubid||[]).push([[58],{4058:(Z,L,s)=>{"use strict";s.r(L),s.d(L,{TorrentModule:()=>kt});var a=s(6895),I=s(1390),A=s(4006),p=s(7340),w=s(6308),v=s(7155),b=s(4327),d=s(5934),t=s(4650),E=s(7009),y=s(4425),T=s(257),U=s(5861),x=s(9076),N=s.n(x),H=s(1135),G=s(8202),F=s(3172),i=s(9731),r=s(6925),u=s(3379);let h=(()=>{class n{constructor(e,o,c,m){if(this.gs=e,this.api=o,this.toast=c,this.ls=m,this.trackerAnnounce=d.N.torrent.trackerAnnounce,this.clientOptions={maxConns:64,tracker:{announce:this.trackerAnnounce,rtcConfig:{iceServers:d.N.torrent.iceServers}}},this.torrentsQueue={},this.torrentOptions={announce:this.trackerAnnounce,maxWebConns:16,store:N()},this.webClient=null,this.expandedRow=null,this.tableDataRowSubject=new H.X([]),this.tableDataRow=this.tableDataRowSubject.asObservable(),this.error=null,this.refCallback=null,this.flagResurrected=!1,this.gs.isBrowser){const O=this.ls.getItem(this.gs.localStorageKeys.Torrents,!0);if(O)for(const[Y,j]of Object.entries(O))this.torrentsQueue[Y]=j;WebTorrent.WEBRTC_SUPPORT?(this.webClient=new WebTorrent(this.clientOptions),this.gs.log("[TORRENT_CLIENT_WEB_MODE_INITIALIZED]",this.webClient),this.handleWebClient()):this.toast.error("WebRTC Not Supported!","Whoops!",null,!0)}}get tableDataRowValue(){return this.tableDataRowSubject?.value||[]}checkHealthOnTracker(e){return this.api.postData("/torrent",e)}handleWebClient(){this.webClient.on("torrent",e=>{this.gs.log("[TORRENT_CLIENT_ADD_TORRENT_FILE]",e),this.toast.info(e.infoHash,"Woaw, Antrian Baru!",null,!0),this.tableDataRowValue.push(e),this.tableDataRowSubject.next(this.tableDataRowValue),this.refCallback&&this.refCallback(null,e)}),this.webClient.on("error",e=>{this.gs.log("[TORRENT_CLIENT_ERROR]",e,"error"),this.toast.error(e.toString(),"Whoops!",null,!0),this.error=e,this.refCallback&&this.refCallback(this.error,null)})}handleWebTorrent(e,o){e.on("done",()=>{this.gs.log("[TORRENT_FILE_DONE]",e),this.toast.success("Ada Torrent Yang Sudah Selesai Di Download","Yeay, Selesai!",null,!0),this.torrentsQueue[e.infoHash].completed=!0,this.ls.setItem(this.gs.localStorageKeys.Torrents,this.torrentsQueue),o&&o(null,null)}),e.on("warning",c=>{this.gs.log("[TORRENT_FILE_WARNING]",c),this.toast.info(c.toString(),"Yuhuu!",null,!0),o&&o(c,null)}),e.on("error",c=>{this.gs.log("[TORRENT_FILE_ERROR]",c,"error"),this.toast.error(c.toString(),"Whoops!",null,!0),o&&o(c,null)})}handleWebWire(e,o){this.gs.log("[TORRENT_WIRE_CONNECT]",e);let c=e.peerId||"Unknown!";e.remoteAddress&&e.remotePort&&(c=`${e.remoteAddress}:${e.remotePort}`),e.on("close",()=>{this.gs.log("[TORRENT_WIRE_DISCONNECT]",c),o&&o(null,e)}),o&&o(null,e)}resurrectFiles(e){var o=this;if(!this.flagResurrected){this.flagResurrected=!0;for(const c in this.torrentsQueue)this.gs.log("[TORRENT_CLIENT_QUEUE_RESURRECT]",this.torrentsQueue[c]),this.torrentsQueue[c].completed?(0,G.openDB)(this.torrentsQueue[c].indexedDb,1).then(function(){var m=(0,U.Z)(function*(O){const K=yield O.transaction("chunks","readonly").objectStore("chunks").getAll(),Bt=F.lW.concat(K),z=[];for(const Ht of o.torrentsQueue[c].files){const $=Ht;z.push(new File([Bt.slice($.offset,$.offset+$.length)],$.name))}o.uploadFiles(o.torrentsQueue[c].name,z,e)});return function(O){return m.apply(this,arguments)}}()).catch(m=>this.gs.log("[INDEXDB-OPEN_FAILED]",m,"error")):this.downloadFiles(this.torrentsQueue[c].infoHash,e,{...this.torrentOptions,name:this.torrentsQueue[c].name})}e(null,null)}processTorrent(e,o,c){e.on("wire",m=>this.handleWebWire(m,c)),this.torrentsQueue[e.infoHash]={completed:o,indexedDb:e.name+" - "+e.infoHash.slice(0,8),infoHash:e.infoHash,name:e.name,files:[]};for(const m of e.files)this.torrentsQueue[e.infoHash].files.push({name:m.name,offset:m.offset,length:m.length});this.ls.setItem(this.gs.localStorageKeys.Torrents,this.torrentsQueue),this.handleWebTorrent(e,c)}downloadFiles(e,o,c=this.torrentOptions){this.gs.log("[TORRENT_CLIENT_QUEUE_DOWNLOAD]",e),this.refCallback=o,this.checkHealthOnTracker({magnetHash:e,trackTimeout:1234,trackList:d.N.torrent.trackerAnnounce,iceServers:d.N.torrent.iceServers}).subscribe({next:m=>{this.gs.log("[TORRENT_CLIENT_HEALTH_SUCCESS]",m.result),m.result.seeds<=0?(this.toast.info("Tidak Ada Seeder!","Whoops!",null,!0),o&&o(null,m.result)):this.webClient.add(e,c,O=>{this.gs.log("[TORRENT_FILE_DOWNLOAD_READY]",O),this.toast.info("Memulai Download ...","Download!",null,!0),this.processTorrent(O,!1,o)})},error:m=>{this.gs.log("[TORRENT_CLIENT_HEALTH_ERROR]",m,"error"),o&&o(m,null)}})}uploadFiles(e,o,c){this.gs.log("[TORRENT_CLIENT_QUEUE_UPLOAD]",o),this.gs.log("[TORRENT_CLIENT_QUEUE_UPLOAD]",e),this.refCallback=c,this.webClient.seed(o,{...this.torrentOptions,name:e},m=>{this.gs.log("[TORRENT_FILE_SEED_READY]",m),this.toast.info("Memulai Seeding ...","Seeding",null,!0),this.processTorrent(m,!0,c)})}removeTorrent(e,o,c=!0){this.tableDataRowSubject.next(this.tableDataRowValue.filter(m=>m.infoHash!==e)),this.webClient.remove(e,{destroyStore:!0},m=>{m&&this.gs.log("[TORRENT_FILE_REMOVE_ERROR]",m,"error"),delete this.torrentsQueue[e],c&&this.ls.setItem(this.gs.localStorageKeys.Torrents,this.torrentsQueue),o&&o(m)})}pauseTorrent(e,o){const c=this.webClient.get(e);c&&(c.pause(),o&&o(c))}resumeTorrent(e,o){const c=this.webClient.get(e);c&&(c.resume(),o&&o(c))}removeAll(){for(const e of this.webClient.torrents)this.removeTorrent(e.infoHash,o=>{o||this.gs.log("[TORRENT_FILE_REMOVE_SUCCESS]",e.infoHash)},!1)}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(T.U),t.LFG(i.s),t.LFG(r.k),t.LFG(u.n))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var g=s(7845),R=s(8381),C=s(3e3);let l=(()=>{class n{constructor(){this.fileDropped=new t.vpe}onDragOver(e){e.preventDefault(),e.stopPropagation(),this.fileOver=!0}onDragLeave(e){e.preventDefault(),e.stopPropagation(),this.fileOver=!1}ondrop(e){e.preventDefault(),e.stopPropagation(),this.fileOver=!1;let o=e.dataTransfer.files;o.length>0&&this.fileDropped.emit(o)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=t.lG2({type:n,selectors:[["","appDragDrop",""]],hostVars:2,hostBindings:function(e,o){1&e&&t.NdJ("dragover",function(m){return o.onDragOver(m)})("dragleave",function(m){return o.onDragLeave(m)})("drop",function(m){return o.ondrop(m)}),2&e&&t.ekj("fileover",o.fileOver)},outputs:{fileDropped:"fileDropped"}}),n})();var f=s(8616),D=s(4859),P=s(7392),S=s(9549),k=s(4144),M=s(6338),W=s(3162),B=s(266),J=s(3626);function Q(n,_){1&n&&t._UZ(0,"mat-progress-bar",27)}function V(n,_){1&n&&(t.TgZ(0,"span"),t._uU(1,"\u{1f516} NAME"),t.qZA()),2&n&&t.Udp("color","#ff4081")}function X(n,_){1&n&&(t.TgZ(0,"span"),t._uU(1,"\u{1f4be} SIZE"),t.qZA()),2&n&&t.Udp("color","#ff4081")}function q(n,_){1&n&&(t.TgZ(0,"span"),t._uU(1,"\u{1f4bf} DOWNLOADED"),t.qZA()),2&n&&t.Udp("color","#ff4081")}function tt(n,_){1&n&&(t.TgZ(0,"span"),t._uU(1,"\u{1f4c0} UPLOADED"),t.qZA()),2&n&&t.Udp("color","#ff4081")}function et(n,_){1&n&&(t.TgZ(0,"span"),t._uU(1,"\u{1f504} PROGRESS"),t.qZA()),2&n&&t.Udp("color","#ff4081")}function nt(n,_){1&n&&(t.TgZ(0,"span"),t._uU(1,"\u{1f53d} SPEED"),t.qZA()),2&n&&t.Udp("color","#ff4081")}function ot(n,_){1&n&&(t.TgZ(0,"span"),t._uU(1,"\u{1f53c} SPEED"),t.qZA()),2&n&&t.Udp("color","#ff4081")}function rt(n,_){1&n&&(t.TgZ(0,"span"),t._uU(1,"\u{1f551} ~ETA."),t.qZA()),2&n&&t.Udp("color","#ff4081")}function it(n,_){1&n&&(t.TgZ(0,"span"),t._uU(1,"\u{1f9f2} PEERS"),t.qZA()),2&n&&t.Udp("color","#ff4081")}function st(n,_){1&n&&(t.TgZ(0,"span"),t._uU(1,"\u{1f310} RATIO"),t.qZA()),2&n&&t.Udp("color","#ff4081")}function at(n,_){if(1&n&&(t.TgZ(0,"th",31)(1,"h3",32),t.YNc(2,V,2,2,"span",33),t.YNc(3,X,2,2,"span",33),t.YNc(4,q,2,2,"span",33),t.YNc(5,tt,2,2,"span",33),t.YNc(6,et,2,2,"span",33),t.YNc(7,nt,2,2,"span",33),t.YNc(8,ot,2,2,"span",33),t.YNc(9,rt,2,2,"span",33),t.YNc(10,it,2,2,"span",33),t.YNc(11,st,2,2,"span",33),t.qZA()()),2&n){const e=t.oxw().$implicit;t.xp6(2),t.Q6J("ngIf","NAME"===e.toUpperCase()),t.xp6(1),t.Q6J("ngIf","LENGTH"===e.toUpperCase()),t.xp6(1),t.Q6J("ngIf","DOWNLOADED"===e.toUpperCase()),t.xp6(1),t.Q6J("ngIf","UPLOADED"===e.toUpperCase()),t.xp6(1),t.Q6J("ngIf","PROGRESS"===e.toUpperCase()),t.xp6(1),t.Q6J("ngIf","DOWNLOADSPEED"===e.toUpperCase()),t.xp6(1),t.Q6J("ngIf","UPLOADSPEED"===e.toUpperCase()),t.xp6(1),t.Q6J("ngIf","TIMEREMAINING"===e.toUpperCase()),t.xp6(1),t.Q6J("ngIf","NUMPEERS"===e.toUpperCase()),t.xp6(1),t.Q6J("ngIf","RATIO"===e.toUpperCase())}}function lt(n,_){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&n){const e=t.oxw().$implicit,o=t.oxw().$implicit;t.xp6(1),t.Oqu(e[o])}}function ct(n,_){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"bytes"),t.qZA()),2&n){const e=t.oxw().$implicit,o=t.oxw().$implicit;t.xp6(1),t.Oqu(t.lcZ(2,1,e[o]))}}function ut(n,_){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"bytes"),t.qZA()),2&n){const e=t.oxw().$implicit,o=t.oxw().$implicit;t.xp6(1),t.Oqu(t.lcZ(2,1,e[o]))}}function pt(n,_){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"bytes"),t.qZA()),2&n){const e=t.oxw().$implicit,o=t.oxw().$implicit;t.xp6(1),t.Oqu(t.lcZ(2,1,e[o]))}}function dt(n,_){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"number"),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.hij("",t.xi3(2,1,e.downloaded/e.length*100,"1.2-2")," %")}}function ft(n,_){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"bytes"),t.qZA()),2&n){const e=t.oxw().$implicit,o=t.oxw().$implicit;t.xp6(1),t.hij("",t.lcZ(2,1,e[o]),"/s")}}function ht(n,_){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"bytes"),t.qZA()),2&n){const e=t.oxw().$implicit,o=t.oxw().$implicit;t.xp6(1),t.hij("",t.lcZ(2,1,e[o]),"/s")}}function mt(n,_){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"number"),t.qZA()),2&n){const e=t.oxw().$implicit,o=t.oxw().$implicit;t.xp6(1),t.Oqu(e[o]<=0?"COMPLETED":t.xi3(2,1,e[o]/1e3,"1.0-0")+" s")}}function _t(n,_){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&n){const e=t.oxw().$implicit,o=t.oxw().$implicit;t.xp6(1),t.Oqu(e[o])}}function gt(n,_){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"number"),t.qZA()),2&n){const e=t.oxw().$implicit,o=t.oxw().$implicit;t.xp6(1),t.Oqu(t.xi3(2,1,e[o],"1.4-4"))}}function Tt(n,_){if(1&n&&(t.TgZ(0,"td",34)(1,"h3"),t.YNc(2,lt,2,1,"span",35),t.YNc(3,ct,3,3,"span",35),t.YNc(4,ut,3,3,"span",35),t.YNc(5,pt,3,3,"span",35),t.YNc(6,dt,3,4,"span",35),t.YNc(7,ft,3,3,"span",35),t.YNc(8,ht,3,3,"span",35),t.YNc(9,mt,3,4,"span",35),t.YNc(10,_t,2,1,"span",35),t.YNc(11,gt,3,4,"span",35),t.qZA()()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.Gre("m-0 ","NAME"===e.toUpperCase()?"text-start":"",""),t.xp6(1),t.Q6J("ngIf","NAME"===e.toUpperCase()),t.xp6(1),t.Q6J("ngIf","LENGTH"===e.toUpperCase()),t.xp6(1),t.Q6J("ngIf","DOWNLOADED"===e.toUpperCase()),t.xp6(1),t.Q6J("ngIf","UPLOADED"===e.toUpperCase()),t.xp6(1),t.Q6J("ngIf","PROGRESS"===e.toUpperCase()),t.xp6(1),t.Q6J("ngIf","DOWNLOADSPEED"===e.toUpperCase()),t.xp6(1),t.Q6J("ngIf","UPLOADSPEED"===e.toUpperCase()),t.xp6(1),t.Q6J("ngIf","TIMEREMAINING"===e.toUpperCase()),t.xp6(1),t.Q6J("ngIf","NUMPEERS"===e.toUpperCase()),t.xp6(1),t.Q6J("ngIf","RATIO"===e.toUpperCase())}}function Ct(n,_){1&n&&(t.ynx(0,28),t.YNc(1,at,12,10,"th",29),t.YNc(2,Tt,12,13,"td",30),t.BQk()),2&n&&t.s9C("matColumnDef",_.$implicit)}function vt(n,_){if(1&n&&(t.TgZ(0,"p",42),t._uU(1," Info Hash :: "),t.TgZ(2,"span",54),t._uU(3),t.qZA()()),2&n){const e=t.oxw().$implicit;t.xp6(3),t.hij(" ",e.infoHash," ")}}function Et(n,_){if(1&n){const e=t.EpF();t.TgZ(0,"p",42),t._uU(1," Magnet URI :: "),t.TgZ(2,"span",55),t.NdJ("click",function(){t.CHM(e);const c=t.oxw().$implicit,m=t.oxw();return t.KtG(m.copyMagnetHashToClipboard(c.magnetURI))}),t._uU(3),t.qZA()()}if(2&n){const e=t.oxw().$implicit;t.xp6(3),t.hij(" ",e.magnetURI," ")}}function xt(n,_){if(1&n&&(t.TgZ(0,"li"),t._uU(1),t.qZA()),2&n){const e=_.$implicit;t.xp6(1),t.hij(" ",e," ")}}function Dt(n,_){if(1&n){const e=t.EpF();t.TgZ(0,"button",46),t.NdJ("click",function(){t.CHM(e);const c=t.oxw().$implicit,m=t.oxw();return t.KtG(m.resumeTorrent(c))}),t._UZ(1,"mat-icon",56),t._uU(2," Resume "),t.qZA()}}function bt(n,_){if(1&n){const e=t.EpF();t.TgZ(0,"button",46),t.NdJ("click",function(){t.CHM(e);const c=t.oxw().$implicit,m=t.oxw();return t.KtG(m.pauseTorrent(c))}),t._UZ(1,"mat-icon",57),t._uU(2," Pause "),t.qZA()}}function yt(n,_){if(1&n){const e=t.EpF();t.TgZ(0,"mat-list-option",58),t._UZ(1,"mat-icon",59),t.TgZ(2,"div",60),t.NdJ("click",function(){const m=t.CHM(e).$implicit,O=t.oxw(2);return t.KtG(O.saveFile(m))}),t.TgZ(3,"span"),t._uU(4),t.qZA(),t._uU(5," -- "),t.TgZ(6,"span",61),t._uU(7),t.ALo(8,"number"),t.qZA(),t._uU(9," :: "),t.TgZ(10,"span",54),t._uU(11),t.ALo(12,"bytes"),t.ALo(13,"bytes"),t.qZA()()()}if(2&n){const e=_.$implicit;t.xp6(3),t.Gre("text-",e.downloaded/e.length>=1?"primary":"bifeldy",""),t.xp6(1),t.hij(" ",e.name," "),t.xp6(3),t.hij(" ",t.xi3(8,7,e.downloaded/e.length*100,"1.2-2")," % "),t.xp6(4),t.AsE(" ",t.lcZ(12,10,e.downloaded)," / ",t.lcZ(13,12,e.length)," ")}}function Rt(n,_){if(1&n){const e=t.EpF();t.TgZ(0,"td",36)(1,"div",37)(2,"div",38)(3,"div",39),t._UZ(4,"div"),t.qZA(),t.TgZ(5,"div",40),t.YNc(6,vt,4,1,"p",41),t.YNc(7,Et,4,1,"p",41),t.TgZ(8,"div",42),t._uU(9," Announce Trackers :: "),t.TgZ(10,"ul",43),t.YNc(11,xt,2,1,"li",44),t.qZA()(),t.TgZ(12,"div",45)(13,"button",46),t.NdJ("click",function(){const m=t.CHM(e).$implicit,O=t.oxw();return t.KtG(O.refreshGraph(m))}),t._UZ(14,"mat-icon",47),t._uU(15," Refresh Graph "),t.qZA(),t.TgZ(16,"button",46),t.NdJ("click",function(){const m=t.CHM(e).$implicit,O=t.oxw();return t.KtG(O.removeTorrent(m))}),t._UZ(17,"mat-icon",48),t._uU(18," Remove "),t.qZA(),t.YNc(19,Dt,3,0,"button",49),t.YNc(20,bt,3,0,"button",49),t.qZA(),t.TgZ(21,"div",50)(22,"div",51),t._uU(23,"Rincian Isi Berkas \u2728"),t.qZA(),t.TgZ(24,"mat-selection-list",52),t.YNc(25,yt,14,14,"mat-list-option",53),t.qZA()()()()()()}if(2&n){const e=_.$implicit,o=t.oxw();t.uIk("colspan",o.tableDataColumn.length),t.xp6(1),t.Q6J("@detailExpand",e===o.TORRENT.expandedRow?"expanded":"collapsed"),t.xp6(3),t.Gre("p2p-graph graphP2p-",e.infoHash,""),t.xp6(2),t.Q6J("ngIf",e.infoHash),t.xp6(1),t.Q6J("ngIf",e.magnetURI),t.xp6(4),t.Q6J("ngForOf",e.announce),t.xp6(8),t.Q6J("ngIf",e.paused),t.xp6(1),t.Q6J("ngIf",!e.paused),t.xp6(4),t.Q6J("multiple",!1),t.xp6(1),t.Q6J("ngForOf",e.files)}}function Ot(n,_){1&n&&t._UZ(0,"tr",62)}function wt(n,_){if(1&n){const e=t.EpF();t.TgZ(0,"tr",63),t.NdJ("click",function(){const m=t.CHM(e).$implicit,O=t.oxw();return t.KtG(O.toggleExpanded(m))}),t.qZA()}if(2&n){const e=_.$implicit,o=t.oxw();t.ekj("expanded-row",o.TORRENT.expandedRow===e)}}function Lt(n,_){1&n&&t._UZ(0,"tr",64)}function At(n,_){if(1&n&&(t.TgZ(0,"tr",65)(1,"td",66)(2,"div",67)(3,"div",68)(4,"h3",32),t._uU(5," Tidak Ada Data \xaf\\_(\u30c4)_/\xaf "),t.qZA()()()()()),2&n){const e=t.oxw();t.xp6(1),t.uIk("colspan",e.tableDataColumn.length)}}const It=function(){return["expandedDetail"]};let Nt=(()=>{class n{constructor(e,o,c,m,O,Y,j,K){this.snackBar=e,this.clipboard=o,this.gs=c,this.torrent=m,this.toast=O,this.ds=Y,this.ss=j,this.bs=K,this.isProcessing=!1,this.magnetHash=null,this.torrentsGraph={},this.tableDataColumn=["name","length","downloaded","uploaded","progress","downloadSpeed","uploadSpeed","timeRemaining","numPeers","ratio"],this.files=[],this.subsDialog=null,this.subsUser=null,this.subsTableDataRow=null,this.gs.bannerImg=null,this.gs.sizeContain=!1,this.gs.bgRepeat=!1}get ENV(){return d.N}get TORRENT(){return this.torrent}ngOnInit(){this.dataSource=new v.by,this.gs.isBrowser&&(this.dataSource.sort=this.sort,this.subsTableDataRow=this.torrent.tableDataRow.subscribe({next:e=>{this.dataSource.data=e,this.refreshAllGraph()}}),this.reviveTorrent())}ngOnDestroy(){this.sort?.sortChange?.unsubscribe(),this.subsDialog?.unsubscribe(),this.subsUser?.unsubscribe(),this.subsTableDataRow?.unsubscribe()}copyMagnetHashToClipboard(e){this.clipboard.copy(e)&&this.snackBar.open("Magnet Link Hash :: Telah Di Salin Pada Clipboard","Ok")}toggleExpanded(e){this.gs.log("[TORRENT_CLICKED]",e),this.torrent.expandedRow=this.torrent.expandedRow===e?null:e,this.refreshGraph(e)}saveFile(e){e.downloaded/e.length>=1?(this.bs.busy(),e.getBlobURL((o,c)=>{o||(this.gs.log("[TORRENT_FILE_BLOBURL]",c),(0,b.saveAs)(c,e.name),this.bs.idle())})):this.toast.info("Berkas Sedang Dalam Proses Unduhan!","Yah, File Belum Siap!",null,!0)}reviveTorrent(){this.bs.busy(),this.torrent.resurrectFiles((e,o)=>{this.refreshAllGraph(),this.bs.idle()})}resumeTorrent(e){this.torrent.resumeTorrent(e.infoHash,o=>{this.refreshAllGraph()})}pauseTorrent(e){this.torrent.pauseTorrent(e.infoHash,o=>{o||this.gs.log("[TORRENT_FILE_PAUSE_SUCCESS]",e.infoHash),this.refreshAllGraph()})}removeTorrent(e){this.torrent.removeTorrent(e.infoHash,o=>{o||this.gs.log("[TORRENT_FILE_REMOVE_SUCCESS]",e.infoHash),this.torrentsGraph[e.infoHash].destroy(),delete this.torrentsGraph[e.infoHash],this.refreshAllGraph()})}downloadFiles(e){this.isProcessing=!0,this.torrent.downloadFiles(this.magnetHash,(o,c)=>{this.magnetHash=null,this.isProcessing=!1,this.refreshAllGraph()})}uploadFiles(e){this.gs.log("[TORRENT_SEED_USER_INFORMATION]",e),this.isProcessing=!0,this.torrent.uploadFiles(e,this.files,(o,c)=>{this.isProcessing=!1,this.refreshAllGraph()})}prepareFilesList(e){this.files=[];for(const c of e)this.files.push(c);const o={torrent_name:{inputLabel:"Nama Torrent",inputPlaceholder:`Torrent # ${this.ss.mySocket.id} @ ${(new Date).toUTCString()}`,inputValue:null,inputRequired:!0}};1===this.files.length?(o.torrent_name.inputPlaceholder=this.files[0].name,this.uploadFiles(o.torrent_name.inputPlaceholder)):this.files.length>1&&(this.subsDialog=this.ds.openInputDialog({data:{title:"Silahkan Masukkan Nama Untuk Torrent Kamu!",input:o,confirmText:"Ya, Mulai SEED",cancelText:"Tidak, Batal"}}).afterClosed().subscribe({next:c=>{this.gs.log("[INPUT_DIALOG_CLOSED]",c),c&&this.uploadFiles(c.torrent_name),this.subsDialog.unsubscribe()}}))}onFileDropped(e){this.prepareFilesList(e)}fileBrowseHandler(e){this.prepareFilesList(e.target.files)}initGraph(e){!this.torrentsGraph[e.infoHash]&&this.dataSource.data.length>0&&(this.gs.log("[TORRENT_WIRE_INIT_GRAPH]",e),this.torrentsGraph[e.infoHash]=new P2PGraph(`.graphP2p-${e.infoHash}`),this.torrentsGraph[e.infoHash].add({id:this.torrent.webClient.peerId,me:!0,name:"Kamu!"}))}addAllGraph(e){this.gs.log("[TORRENT_WIRE_RELOAD_GRAPH]",e);for(const o of e.wires){let c=o.peerId||"Anonim!";o.remoteAddress&&o.remotePort&&(c=`${o.remoteAddress}:${o.remotePort}`),this.torrentsGraph[e.infoHash].add({id:o.peerId,name:c}),this.torrentsGraph[e.infoHash].connect(this.torrent.webClient.peerId,o.peerId)}}deleteAllGraph(e){this.gs.log("[TORRENT_WIRE_DELETE_GRAPH]",e);const o=this.torrentsGraph[e.infoHash].list().filter(c=>c.id!==this.torrent.webClient.peerId);for(const c of o)this.torrentsGraph[e.infoHash].disconnect(this.torrent.webClient.peerId,c.id),this.torrentsGraph[e.infoHash].remove(c.id)}refreshGraph(e){this.gs.log("[TORRENT_WIRE_REFRESH_GRAPH]",e),this.torrentsGraph[e.infoHash]?(this.deleteAllGraph(e),this.addAllGraph(e)):this.initGraph(e)}refreshAllGraph(){for(const e of this.dataSource.data)setTimeout(()=>{this.refreshGraph(e)},1234)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(E.ux),t.Y36(y.TU),t.Y36(T.U),t.Y36(h),t.Y36(r.k),t.Y36(g.x),t.Y36(R.R),t.Y36(C.z))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-torrent"]],viewQuery:function(e,o){if(1&e&&t.Gf(w.YE,7),2&e){let c;t.iGM(c=t.CRH())&&(o.sort=c.first)}},decls:35,vars:13,consts:[["appDragDrop","",1,"h-100",3,"fileDropped"],[1,"container"],[1,"row","pb-3","px-0"],[1,"col-12"],[1,"row"],[1,"col-12","sticky-top","bg-bifeldy"],[1,"pt-3","border-bottom-dotted"],[1,"text-bifeldy"],["hintLabel","Isi Lalu Tekan 'Enter' Untuk Mencari Torrent ...",1,"col-12","col-md-6","col-lg-4","px-3","mb-3",3,"color"],["matInput","","placeholder","Ex. magnet:123qwe...!@#",3,"ngModel","disabled","keyup.enter","ngModelChange"],["input",""],["fontIcon","cloud_download","matSuffix",""],["color","warn","mode","indeterminate",4,"ngIf"],[1,"row","mx-2"],[1,"col-12",2,"overflow-x","auto"],["mat-table","","matSort","","multiTemplateDataRows","",1,"bg-transparent",3,"dataSource"],[3,"matColumnDef",4,"ngFor","ngForOf"],["matColumnDef","expandedDetail"],["mat-cell","",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","","class","element-row",3,"expanded-row","click",4,"matRowDef","matRowDefColumns"],["mat-row","","class","detail-row",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["type","file","id","fileDropRef","multiple","",2,"visibility","hidden",3,"disabled","change"],["fileDropRef",""],["type","button","mat-fab","","color","warn","matTooltip","Seed Berkas",1,"me-3","mb-5","fab-button","animate__animated","animate__bounce","animate__infinite","animate__slow",2,"position","fixed","bottom","0","right","0",3,"disabled","click"],["fontIcon","cloud_upload"],["color","warn","mode","indeterminate"],[3,"matColumnDef"],["mat-header-cell","","class","px-3 text-center","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","","class","px-3 text-center","style","cursor: pointer;",4,"matCellDef"],["mat-header-cell","","mat-sort-header","",1,"px-3","text-center"],[1,"m-0"],[3,"color",4,"ngIf"],["mat-cell","",1,"px-3","text-center",2,"cursor","pointer"],[4,"ngIf"],["mat-cell",""],[1,"element-detail"],[1,"py-3","row"],[1,"col-3"],[1,"col-9"],["class","px-2 text-truncate",4,"ngIf"],[1,"px-2","text-truncate"],[1,"text-success","m-0"],[4,"ngFor","ngForOf"],[1,"p-2"],["type","button","mat-stroked-button","",1,"m-1","text-warning",3,"click"],["fontIcon","refresh",1,"me-1"],["fontIcon","delete_outline",1,"me-1"],["type","button","mat-stroked-button","","class","m-1 text-warning",3,"click",4,"ngIf"],[1,"px-2"],["mat-subheader","",1,"p-0"],[3,"multiple"],["class","h-100",4,"ngFor","ngForOf"],[1,"text-success"],["matTooltip","Klik Untuk Menyalin!",1,"text-primary","text-decoration-none",3,"click"],["fontIcon","play_arrow",1,"me-1"],["fontIcon","pause",1,"me-1"],[1,"h-100"],["fontIcon","file_present","mat-list-icon","",1,"ps-3"],[2,"cursor","pointer",3,"click"],[1,"text-warning"],["mat-header-row",""],["mat-row","",1,"element-row",3,"click"],["mat-row","",1,"detail-row"],[1,"mat-row"],[1,"mat-cell","text-center","align-items-center","p-0",2,"background-image","url('/assets/img/404/no-data.png')","background-size","contain","background-position","center","background-repeat","no-repeat","height","256px"],[1,"row","align-items-center","h-100"],[1,"col-8","mx-auto","text-light","text-center","rounded","py-3",2,"background-color","rgba(128, 128, 128, 0.875)"]],template:function(e,o){if(1&e){const c=t.EpF();t.TgZ(0,"div",0),t.NdJ("fileDropped",function(O){return o.onFileDropped(O)}),t._UZ(1,"app-notifications"),t.TgZ(2,"div",1)(3,"div",2)(4,"div",3)(5,"div",4)(6,"div",5)(7,"h2",6)(8,"b",7),t._uU(9,"Web-SocketRTC Torrent"),t.qZA()()(),t.TgZ(10,"div",3)(11,"mat-form-field",8)(12,"mat-label"),t._uU(13,"Unduh Dari Info Hash / Magnet URI"),t.qZA(),t.TgZ(14,"input",9,10),t.NdJ("keyup.enter",function(O){return o.downloadFiles(O)})("ngModelChange",function(O){return o.magnetHash=O}),t.qZA(),t._UZ(16,"mat-icon",11),t.YNc(17,Q,1,0,"mat-progress-bar",12),t.qZA(),t.TgZ(18,"div",13)(19,"div",14)(20,"table",15),t.YNc(21,Ct,3,1,"ng-container",16),t.ynx(22,17),t.YNc(23,Rt,26,12,"td",18),t.BQk(),t.YNc(24,Ot,1,0,"tr",19),t.YNc(25,wt,1,2,"tr",20),t.YNc(26,Lt,1,0,"tr",21),t.YNc(27,At,6,1,"tr",22),t.qZA()(),t.TgZ(28,"div",3)(29,"marquee"),t._uU(30),t.qZA()()()()()()()(),t.TgZ(31,"input",23,24),t.NdJ("change",function(O){return o.fileBrowseHandler(O)}),t.qZA(),t.TgZ(33,"button",25),t.NdJ("click",function(){t.CHM(c);const O=t.MAs(32);return t.KtG(O.click())}),t._UZ(34,"mat-icon",26),t.qZA()()}2&e&&(t.xp6(11),t.Q6J("color","accent"),t.xp6(3),t.Q6J("ngModel",o.magnetHash)("disabled",o.isProcessing),t.xp6(3),t.Q6J("ngIf",o.isProcessing),t.xp6(3),t.Q6J("dataSource",o.dataSource),t.xp6(1),t.Q6J("ngForOf",o.tableDataColumn),t.xp6(3),t.Q6J("matHeaderRowDef",o.tableDataColumn),t.xp6(1),t.Q6J("matRowDefColumns",o.tableDataColumn),t.xp6(1),t.Q6J("matRowDefColumns",t.DdM(12,It)),t.xp6(4),t.hij("Terhubung Dengan Tracker :: ",o.ENV.torrent.trackerAnnounce.join(" :: "),""),t.xp6(1),t.Q6J("disabled",o.isProcessing),t.xp6(2),t.Q6J("disabled",o.isProcessing))},dependencies:[a.sg,a.O5,A.Fj,A.JJ,A.On,l,f.t,D.lW,P.Hw,S.KE,S.hX,S.R9,k.Nt,M.Nh,M.gs,M.Ub,M.vS,W.pW,v.BZ,v.fO,v.as,v.w1,v.Dz,v.nj,v.ge,v.ev,v.XQ,v.Gk,v.Ee,B.gM,w.YE,w.nU,a.JJ,J.$],styles:[".p2p-graph[_ngcontent-%COMP%]{background-color:#8d8d8d80!important}tr.detail-row[_ngcontent-%COMP%]{height:0}tr.element-row[_ngcontent-%COMP%]:not(.expanded-row):hover{background-color:#ffffffdf}.element-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-bottom-width:0}.element-detail[_ngcontent-%COMP%]{overflow:hidden;display:flex}.fileover[_ngcontent-%COMP%]{animation:shake 1s;animation-iteration-count:infinite}@keyframes shake{0%{transform:translate(1px,1px) rotate(0)}10%{transform:translate(-1px,-2px) rotate(-1deg)}20%{transform:translate(-3px) rotate(1deg)}30%{transform:translate(3px,2px) rotate(0)}40%{transform:translate(1px,-1px) rotate(1deg)}50%{transform:translate(-1px,2px) rotate(-1deg)}60%{transform:translate(-3px,1px) rotate(0)}70%{transform:translate(3px,1px) rotate(-1deg)}80%{transform:translate(-1px,-1px) rotate(1deg)}90%{transform:translate(1px,2px) rotate(0)}to{transform:translate(1px,-2px) rotate(-1deg)}}"],data:{animation:[(0,p.X$)("detailExpand",[(0,p.SB)("collapsed",(0,p.oB)({height:"0px",minHeight:"0"})),(0,p.SB)("expanded",(0,p.oB)({height:"*"})),(0,p.eR)("expanded <=> collapsed",(0,p.jt)("225ms cubic-bezier(0.4, 0.0, 0.2, 1)"))])]}}),n})();var Ut=s(210),Mt=s(7355),Zt=s(8613),Pt=s(4946),St=s(7956);const Ft=[{path:"",pathMatch:"full",component:Nt}];let kt=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[a.ez,I.Bz.forChild(Ft),A.u5,St.C,Zt.F,Ut.m,Pt.P,Mt.T]}),n})()},4946:(Z,L,s)=>{"use strict";s.d(L,{P:()=>p});var a=s(6895),I=s(210),A=s(4650);let p=(()=>{class w{}return w.\u0275fac=function(b){return new(b||w)},w.\u0275mod=A.oAB({type:w}),w.\u0275inj=A.cJS({imports:[a.ez,I.m]}),w})()},8616:(Z,L,s)=>{"use strict";s.d(L,{t:()=>y});var a=s(4650),I=s(1390),A=s(257),p=s(7140),w=s(6895),v=s(1861);function b(T,U){if(1&T&&a._UZ(0,"div",4),2&T){const x=a.oxw();a.Udp("background-size",x.GS.sizeContain?"contain":"cover")("background-image","url("+x.GS.bannerImg+")")("background-repeat",x.GS.bgRepeat?"repeat-x":"no-repeat")("height",x.ROUTER.url.startsWith("/news")||x.ROUTER.url.startsWith("/berkas")||x.ROUTER.url.startsWith("/fansub")?"192px":"128px")("background-position-y",x.ROUTER.url.startsWith("/berkas")?"22.5%":"")}}function d(T,U){if(1&T&&(a.TgZ(0,"strong",10),a._uU(1," -- "),a.TgZ(2,"i")(3,"a",11),a._uU(4),a.qZA()()()),2&T){const x=a.oxw().$implicit;a.xp6(3),a.MGl("routerLink","/user/",x.notifCreator,""),a.xp6(1),a.hij(" ",x.notifCreator," ")}}function t(T,U){if(1&T){const x=a.EpF();a.TgZ(0,"button",12),a.NdJ("click",function(){a.CHM(x);const H=a.oxw().$implicit,G=a.oxw();return a.KtG(G.removeNotif(H.notifData.id))}),a.qZA()}}function E(T,U){if(1&T&&(a.TgZ(0,"div",5)(1,"div")(2,"strong",6),a._uU(3),a.qZA(),a._UZ(4,"span",7),a.ALo(5,"safeInnerHtml"),a.YNc(6,d,5,2,"strong",8),a.YNc(7,t,1,0,"button",9),a.qZA()()),2&T){const x=U.$implicit;a.xp6(1),a.Gre("alert alert-",x.notifData.type," alert-dismissible fade show"),a.xp6(2),a.Oqu(x.notifData.title),a.xp6(1),a.Q6J("innerHTML",a.lcZ(5,7,x.notifData.content),a.oJD),a.xp6(2),a.Q6J("ngIf",x.notifCreator),a.xp6(1),a.Q6J("ngIf",x.notifData.dismissible)}}let y=(()=>{class T{constructor(x,N,H){this.router=x,this.gs=N,this.notif=H}ngOnInit(){}get GS(){return this.gs}get ROUTER(){return this.router}get NOTIF(){return this.notif}removeNotif(x){this.notif.removeNotif(x)}}return T.\u0275fac=function(x){return new(x||T)(a.Y36(I.F0),a.Y36(A.U),a.Y36(p.T))},T.\u0275cmp=a.Xpm({type:T,selectors:[["app-notifications"]],decls:4,vars:2,consts:[["class","container-fluid notif-banner align-items-center",3,"background-size","background-image","background-repeat","height","background-position-y",4,"ngIf"],[1,"container"],[1,"row","pt-3"],["class","col-12",4,"ngFor","ngForOf"],[1,"container-fluid","notif-banner","align-items-center"],[1,"col-12"],[1,"me-1"],[3,"innerHTML"],["class","ms-1",4,"ngIf"],["type","button","class","btn-close","data-dismiss","alert",3,"click",4,"ngIf"],[1,"ms-1"],[1,"text-decoration-none",3,"routerLink"],["type","button","data-dismiss","alert",1,"btn-close",3,"click"]],template:function(x,N){1&x&&(a.YNc(0,b,1,10,"div",0),a.TgZ(1,"div",1)(2,"div",2),a.YNc(3,E,8,9,"div",3),a.qZA()()),2&x&&(a.Q6J("ngIf",N.GS.bannerImg&&(N.ROUTER.url.startsWith("/news")||N.ROUTER.url.startsWith("/berkas")||N.ROUTER.url.startsWith("/fansub")||N.ROUTER.url.startsWith("/anime")||N.ROUTER.url.startsWith("/dorama"))),a.xp6(3),a.Q6J("ngForOf",N.NOTIF.notifications))},dependencies:[w.sg,w.O5,I.yS,v.H],styles:[".notif-banner[_ngcontent-%COMP%]{width:100%;background-size:cover;background-position:75% 50%}"]}),T})()},8613:(Z,L,s)=>{"use strict";s.d(L,{F:()=>w});var a=s(6895),I=s(1390),A=s(7355),p=s(4650);let w=(()=>{class v{}return v.\u0275fac=function(d){return new(d||v)},v.\u0275mod=p.oAB({type:v}),v.\u0275inj=p.cJS({imports:[a.ez,I.Bz,A.T]}),v})()},7956:(Z,L,s)=>{"use strict";s.d(L,{C:()=>A});var a=s(6895),I=s(4650);let A=(()=>{class p{}return p.\u0275fac=function(v){return new(v||p)},p.\u0275mod=I.oAB({type:p}),p.\u0275inj=I.cJS({imports:[a.ez]}),p})()},9069:Z=>{"use strict";var a,L="object"==typeof Reflect?Reflect:null,s=L&&"function"==typeof L.apply?L.apply:function(r,u,h){return Function.prototype.apply.call(r,u,h)};a=L&&"function"==typeof L.ownKeys?L.ownKeys:Object.getOwnPropertySymbols?function(r){return Object.getOwnPropertyNames(r).concat(Object.getOwnPropertySymbols(r))}:function(r){return Object.getOwnPropertyNames(r)};var A=Number.isNaN||function(r){return r!=r};function p(){p.init.call(this)}Z.exports=p,Z.exports.once=function H(i,r){return new Promise(function(u,h){function g(C){i.removeListener(r,R),h(C)}function R(){"function"==typeof i.removeListener&&i.removeListener("error",g),u([].slice.call(arguments))}F(i,r,R,{once:!0}),"error"!==r&&function G(i,r,u){"function"==typeof i.on&&F(i,"error",r,u)}(i,g,{once:!0})})},p.EventEmitter=p,p.prototype._events=void 0,p.prototype._eventsCount=0,p.prototype._maxListeners=void 0;var w=10;function v(i){if("function"!=typeof i)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof i)}function b(i){return void 0===i._maxListeners?p.defaultMaxListeners:i._maxListeners}function d(i,r,u,h){var g,R,C;if(v(u),void 0===(R=i._events)?(R=i._events=Object.create(null),i._eventsCount=0):(void 0!==R.newListener&&(i.emit("newListener",r,u.listener?u.listener:u),R=i._events),C=R[r]),void 0===C)C=R[r]=u,++i._eventsCount;else if("function"==typeof C?C=R[r]=h?[u,C]:[C,u]:h?C.unshift(u):C.push(u),(g=b(i))>0&&C.length>g&&!C.warned){C.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+C.length+" "+String(r)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=i,l.type=r,l.count=C.length,function I(i){console&&console.warn&&console.warn(i)}(l)}return i}function t(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function E(i,r,u){var h={fired:!1,wrapFn:void 0,target:i,type:r,listener:u},g=t.bind(h);return g.listener=u,h.wrapFn=g,g}function y(i,r,u){var h=i._events;if(void 0===h)return[];var g=h[r];return void 0===g?[]:"function"==typeof g?u?[g.listener||g]:[g]:u?function N(i){for(var r=new Array(i.length),u=0;u<r.length;++u)r[u]=i[u].listener||i[u];return r}(g):U(g,g.length)}function T(i){var r=this._events;if(void 0!==r){var u=r[i];if("function"==typeof u)return 1;if(void 0!==u)return u.length}return 0}function U(i,r){for(var u=new Array(r),h=0;h<r;++h)u[h]=i[h];return u}function F(i,r,u,h){if("function"==typeof i.on)h.once?i.once(r,u):i.on(r,u);else{if("function"!=typeof i.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof i);i.addEventListener(r,function g(R){h.once&&i.removeEventListener(r,g),u(R)})}}Object.defineProperty(p,"defaultMaxListeners",{enumerable:!0,get:function(){return w},set:function(i){if("number"!=typeof i||i<0||A(i))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+i+".");w=i}}),p.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},p.prototype.setMaxListeners=function(r){if("number"!=typeof r||r<0||A(r))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+r+".");return this._maxListeners=r,this},p.prototype.getMaxListeners=function(){return b(this)},p.prototype.emit=function(r){for(var u=[],h=1;h<arguments.length;h++)u.push(arguments[h]);var g="error"===r,R=this._events;if(void 0!==R)g=g&&void 0===R.error;else if(!g)return!1;if(g){var C;if(u.length>0&&(C=u[0]),C instanceof Error)throw C;var l=new Error("Unhandled error."+(C?" ("+C.message+")":""));throw l.context=C,l}var f=R[r];if(void 0===f)return!1;if("function"==typeof f)s(f,this,u);else{var D=f.length,P=U(f,D);for(h=0;h<D;++h)s(P[h],this,u)}return!0},p.prototype.on=p.prototype.addListener=function(r,u){return d(this,r,u,!1)},p.prototype.prependListener=function(r,u){return d(this,r,u,!0)},p.prototype.once=function(r,u){return v(u),this.on(r,E(this,r,u)),this},p.prototype.prependOnceListener=function(r,u){return v(u),this.prependListener(r,E(this,r,u)),this},p.prototype.off=p.prototype.removeListener=function(r,u){var h,g,R,C,l;if(v(u),void 0===(g=this._events))return this;if(void 0===(h=g[r]))return this;if(h===u||h.listener===u)0==--this._eventsCount?this._events=Object.create(null):(delete g[r],g.removeListener&&this.emit("removeListener",r,h.listener||u));else if("function"!=typeof h){for(R=-1,C=h.length-1;C>=0;C--)if(h[C]===u||h[C].listener===u){l=h[C].listener,R=C;break}if(R<0)return this;0===R?h.shift():function x(i,r){for(;r+1<i.length;r++)i[r]=i[r+1];i.pop()}(h,R),1===h.length&&(g[r]=h[0]),void 0!==g.removeListener&&this.emit("removeListener",r,l||u)}return this},p.prototype.removeAllListeners=function(r){var u,h,g;if(void 0===(h=this._events))return this;if(void 0===h.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==h[r]&&(0==--this._eventsCount?this._events=Object.create(null):delete h[r]),this;if(0===arguments.length){var C,R=Object.keys(h);for(g=0;g<R.length;++g)"removeListener"!==(C=R[g])&&this.removeAllListeners(C);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(u=h[r]))this.removeListener(r,u);else if(void 0!==u)for(g=u.length-1;g>=0;g--)this.removeListener(r,u[g]);return this},p.prototype.listeners=function(r){return y(this,r,!0)},p.prototype.rawListeners=function(r){return y(this,r,!1)},p.listenerCount=function(i,r){return"function"==typeof i.listenerCount?i.listenerCount(r):T.call(i,r)},p.prototype.listenerCount=T,p.prototype.eventNames=function(){return this._eventsCount>0?a(this._events):[]}},9076:(Z,L,s)=>{"use strict";var a=s(7156).default;const I=s(8202),A=s(9069).EventEmitter,p=s(6643);Z.exports=class w extends A{constructor(b,d){if(d||(d={}),super(),this.chunkLength=Number(b),!this.chunkLength)throw new Error("First argument must be a chunk length");this.closed=!1,this.destroyed=!1,this.length=Number(d.length)||1/0,this.name=d.name||"idb-chunk-store",this.length!==1/0&&(this.lastChunkLength=this.length%this.chunkLength||this.chunkLength,this.lastChunkIndex=Math.ceil(this.length/this.chunkLength)-1),this.dbPromise=I.openDB(this.name,void 0,{upgrade:t=>{t.createObjectStore("chunks")},blocking:()=>{this.close()},terminated:()=>{this.closed=!0,this.emit("error",new Error("Database unexpectedly closed"))}})}put(b,d,t=(()=>{})){var E=this;if(this.closed)return p(()=>t(new Error("Storage is closed")));const y=b===this.lastChunkIndex;return y&&d.length!==this.lastChunkLength?p(()=>t(new Error("Last chunk length must be "+this.lastChunkLength))):y||d.length===this.chunkLength?((0!==(d=new Uint8Array(d.buffer,d.byteOffset,d.byteLength)).byteOffset||d.byteLength!==d.buffer.byteLength)&&(d=d.slice()),void a(function*(){try{yield(yield E.dbPromise).put("chunks",d,b)}catch(T){return void t(T)}t(null)})()):p(()=>t(new Error("Chunk length must be "+this.chunkLength)))}get(b,d,t=(()=>{})){var E=this;return"function"==typeof d?this.get(b,{},d):(d||(d={}),this.closed?p(()=>t(new Error("Storage is closed"))):void a(function*(){let y;try{y=yield(yield E.dbPromise).get("chunks",b)}catch(N){return void t(N)}if(null==y){const N=new Error("Chunk not found");return N.notFound=!0,void t(N)}let T=Buffer.from(y.buffer,y.byteOffset,y.byteLength);const U=d.offset||0,x=d.length||T.length-U;(0!==U||x!==T.length)&&(T=T.slice(U,x+U)),t(null,T)})())}close(b=(()=>{})){var d=this;if(this.closed)return p(()=>b(new Error("Storage is closed")));this.closed=!0,a(function*(){try{(yield d.dbPromise).close()}catch(t){return void b(t)}b(null)})()}destroy(b=(()=>{})){var d=this;return this.closed?p(()=>b(new Error("Storage is closed"))):this.destroyed?p(()=>b(new Error("Storage is destroyed"))):(this.destroyed=!0,void this.close(function(){var t=a(function*(E){if(E)b(E);else{try{yield I.deleteDB(d.name)}catch(y){return void b(y)}b(null)}});return function(E){return t.apply(this,arguments)}}()))}}},8202:(Z,L,s)=>{"use strict";s.r(L),s.d(L,{deleteDB:()=>u,openDB:()=>r,unwrap:()=>i,wrap:()=>F});var a=s(5861);let A,p;const b=new WeakMap,d=new WeakMap,t=new WeakMap,E=new WeakMap,y=new WeakMap;let x={get(l,f,D){if(l instanceof IDBTransaction){if("done"===f)return d.get(l);if("objectStoreNames"===f)return l.objectStoreNames||t.get(l);if("store"===f)return D.objectStoreNames[1]?void 0:D.objectStore(D.objectStoreNames[0])}return F(l[f])},set:(l,f,D)=>(l[f]=D,!0),has:(l,f)=>l instanceof IDBTransaction&&("done"===f||"store"===f)||f in l};function G(l){return"function"==typeof l?function H(l){return l!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function v(){return p||(p=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(l)?function(...f){return l.apply(i(this),f),F(b.get(this))}:function(...f){return F(l.apply(i(this),f))}:function(f,...D){const P=l.call(i(this),f,...D);return t.set(P,f.sort?f.sort():[f]),F(P)}}(l):(l instanceof IDBTransaction&&function U(l){if(d.has(l))return;const f=new Promise((D,P)=>{const S=()=>{l.removeEventListener("complete",k),l.removeEventListener("error",M),l.removeEventListener("abort",M)},k=()=>{D(),S()},M=()=>{P(l.error||new DOMException("AbortError","AbortError")),S()};l.addEventListener("complete",k),l.addEventListener("error",M),l.addEventListener("abort",M)});d.set(l,f)}(l),((l,f)=>f.some(D=>l instanceof D))(l,function w(){return A||(A=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(l,x):l)}function F(l){if(l instanceof IDBRequest)return function T(l){const f=new Promise((D,P)=>{const S=()=>{l.removeEventListener("success",k),l.removeEventListener("error",M)},k=()=>{D(F(l.result)),S()},M=()=>{P(l.error),S()};l.addEventListener("success",k),l.addEventListener("error",M)});return f.then(D=>{D instanceof IDBCursor&&b.set(D,l)}).catch(()=>{}),y.set(f,l),f}(l);if(E.has(l))return E.get(l);const f=G(l);return f!==l&&(E.set(l,f),y.set(f,l)),f}const i=l=>y.get(l);function r(l,f,{blocked:D,upgrade:P,blocking:S,terminated:k}={}){const M=indexedDB.open(l,f),W=F(M);return P&&M.addEventListener("upgradeneeded",B=>{P(F(M.result),B.oldVersion,B.newVersion,F(M.transaction))}),D&&M.addEventListener("blocked",()=>D()),W.then(B=>{k&&B.addEventListener("close",()=>k()),S&&B.addEventListener("versionchange",()=>S())}).catch(()=>{}),W}function u(l,{blocked:f}={}){const D=indexedDB.deleteDatabase(l);return f&&D.addEventListener("blocked",()=>f()),F(D).then(()=>{})}const h=["get","getKey","getAll","getAllKeys","count"],g=["put","add","delete","clear"],R=new Map;function C(l,f){if(!(l instanceof IDBDatabase)||f in l||"string"!=typeof f)return;if(R.get(f))return R.get(f);const D=f.replace(/FromIndex$/,""),P=f!==D,S=g.includes(D);if(!(D in(P?IDBIndex:IDBObjectStore).prototype)||!S&&!h.includes(D))return;const k=function(){var M=(0,a.Z)(function*(W,...B){const J=this.transaction(W,S?"readwrite":"readonly");let Q=J.store;return P&&(Q=Q.index(B.shift())),(yield Promise.all([Q[D](...B),S&&J.done]))[0]});return function(B){return M.apply(this,arguments)}}();return R.set(f,k),k}!function N(l){x=l(x)}(l=>({...l,get:(f,D,P)=>C(f,D)||l.get(f,D,P),has:(f,D)=>!!C(f,D)||l.has(f,D)}))},6643:Z=>{let L;Z.exports="function"==typeof queueMicrotask?queueMicrotask.bind(typeof window<"u"?window:global):s=>(L||(L=Promise.resolve())).then(s).catch(a=>setTimeout(()=>{throw a},0))},7156:Z=>{function L(a,I,A,p,w,v,b){try{var d=a[v](b),t=d.value}catch(E){return void A(E)}d.done?I(t):Promise.resolve(t).then(p,w)}Z.exports=function s(a){return function(){var I=this,A=arguments;return new Promise(function(p,w){var v=a.apply(I,A);function b(t){L(v,p,w,b,d,"next",t)}function d(t){L(v,p,w,b,d,"throw",t)}b(void 0)})}},Z.exports.__esModule=!0,Z.exports.default=Z.exports},4425:(Z,L,s)=>{"use strict";s.d(L,{TU:()=>p});var a=s(6895),I=s(4650);class A{constructor(t,E){this._document=E;const y=this._textarea=this._document.createElement("textarea"),T=y.style;T.position="fixed",T.top=T.opacity="0",T.left="-999em",y.setAttribute("aria-hidden","true"),y.value=t,y.readOnly=!0,this._document.body.appendChild(y)}copy(){const t=this._textarea;let E=!1;try{if(t){const y=this._document.activeElement;t.select(),t.setSelectionRange(0,t.value.length),E=this._document.execCommand("copy"),y&&y.focus()}}catch{}return E}destroy(){const t=this._textarea;t&&(t.remove(),this._textarea=void 0)}}let p=(()=>{class d{constructor(E){this._document=E}copy(E){const y=this.beginCopy(E),T=y.copy();return y.destroy(),T}beginCopy(E){return new A(E,this._document)}}return d.\u0275fac=function(E){return new(E||d)(I.LFG(a.K0))},d.\u0275prov=I.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"}),d})()}}]);
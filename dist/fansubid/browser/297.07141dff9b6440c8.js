"use strict";(self.webpackChunkfansubid=self.webpackChunkfansubid||[]).push([[297],{2297:(j,g,o)=>{o.r(g),o.d(g,{MailboxModule:()=>X});var r=o(9808),c=o(8406),u=o(3075),T=o(210),Z=o(7355),h=o(5934),t=o(5e3),p=o(3e3),f=o(6382),x=o(8696),_=o(7358),P=o(8020),v=o(8616),m=o(4623),M=o(5245),C=o(508),A=o(3626);function y(e,a){if(1&e&&(t.TgZ(0,"mat-list-option")(1,"mat-icon",21),t._uU(2,"account_circle"),t.qZA(),t.TgZ(3,"h4"),t._uU(4),t.qZA()()),2&e){const i=a.$implicit;t.xp6(4),t.Oqu(i)}}function D(e,a){if(1&e&&(t.TgZ(0,"div",15)(1,"div",16)(2,"h2",17)(3,"b",18),t._uU(4,"Penerima Utama"),t.qZA()()(),t.TgZ(5,"div",19)(6,"mat-selection-list",20),t.YNc(7,y,5,1,"mat-list-option",25),t.qZA()()()),2&e){const i=t.oxw(2);t.xp6(6),t.Q6J("multiple",!1),t.xp6(1),t.Q6J("ngForOf",i.filterAddress(i.mailData.to))}}function w(e,a){if(1&e&&(t.TgZ(0,"mat-list-option")(1,"mat-icon",21),t._uU(2,"account_circle"),t.qZA(),t.TgZ(3,"h4"),t._uU(4),t.qZA()()),2&e){const i=a.$implicit;t.xp6(4),t.Oqu(i)}}function U(e,a){if(1&e&&(t.TgZ(0,"div",15)(1,"div",16)(2,"h2",17)(3,"b",18),t._uU(4,"Penerima CC"),t.qZA()()(),t.TgZ(5,"div",19)(6,"mat-selection-list",20),t.YNc(7,w,5,1,"mat-list-option",25),t.qZA()()()),2&e){const i=t.oxw(2);t.xp6(6),t.Q6J("multiple",!1),t.xp6(1),t.Q6J("ngForOf",i.filterAddress(i.mailData.cc))}}function I(e,a){if(1&e&&(t.TgZ(0,"mat-list-option")(1,"mat-icon",21),t._uU(2,"account_circle"),t.qZA(),t.TgZ(3,"h4"),t._uU(4),t.qZA()()),2&e){const i=a.$implicit;t.xp6(4),t.Oqu(i)}}function S(e,a){if(1&e&&(t.TgZ(0,"div",15)(1,"div",16)(2,"h2",17)(3,"b",18),t._uU(4,"Penerima BCC"),t.qZA()()(),t.TgZ(5,"div",19)(6,"mat-selection-list",20),t.YNc(7,I,5,1,"mat-list-option",25),t.qZA()()()),2&e){const i=t.oxw(2);t.xp6(6),t.Q6J("multiple",!1),t.xp6(1),t.Q6J("ngForOf",i.filterAddress(i.mailData.bcc))}}function L(e,a){if(1&e){const i=t.EpF();t.TgZ(0,"mat-list-option",27),t.NdJ("click",function(){const s=t.CHM(i).$implicit;return t.oxw(3).downloadAttachment(s.id)}),t.TgZ(1,"mat-icon",21),t._uU(2,"attach_file"),t.qZA(),t.TgZ(3,"div",28),t._uU(4),t.qZA(),t.TgZ(5,"div",28),t._uU(6),t.ALo(7,"bytes"),t.qZA()()}if(2&e){const i=a.$implicit;t.xp6(4),t.Oqu(i.name),t.xp6(2),t.Oqu(t.lcZ(7,2,i.size))}}function k(e,a){if(1&e&&(t.TgZ(0,"div",15)(1,"div",16)(2,"h2",17)(3,"b",18),t._uU(4,"Lampiran"),t.qZA()()(),t.TgZ(5,"div",19)(6,"mat-selection-list",20),t.YNc(7,L,8,4,"mat-list-option",26),t.qZA()()()),2&e){const i=t.oxw(2);t.xp6(6),t.Q6J("multiple",!1),t.xp6(1),t.Q6J("ngForOf",i.mailData.attachment_)}}function Y(e,a){if(1&e&&(t.TgZ(0,"div",1)(1,"div",2)(2,"div",3)(3,"ul",4),t._UZ(4,"li")(5,"li")(6,"li")(7,"li")(8,"li")(9,"li")(10,"li")(11,"li")(12,"li")(13,"li"),t.TgZ(14,"div",5)(15,"div",6)(16,"div",7)(17,"h2",8),t._uU(18),t.qZA(),t.TgZ(19,"p",9),t._uU(20),t.ALo(21,"date"),t.qZA()()()()()()(),t._UZ(22,"app-notifications"),t.TgZ(23,"div",10)(24,"div",11)(25,"div",12)(26,"div",13)(27,"div",14)(28,"div",15)(29,"div",16)(30,"h2",17)(31,"b",18),t._uU(32,"Pengirim"),t.qZA()()(),t.TgZ(33,"div",19)(34,"mat-selection-list",20)(35,"mat-list-option")(36,"mat-icon",21),t._uU(37,"account_circle"),t.qZA(),t.TgZ(38,"h4"),t._uU(39),t.qZA()()()()(),t.YNc(40,D,8,2,"div",22),t.YNc(41,U,8,2,"div",22),t.YNc(42,S,8,2,"div",22),t.YNc(43,k,8,2,"div",22),t.qZA()()(),t.TgZ(44,"div",23)(45,"div",13)(46,"div",14)(47,"div",15)(48,"div",16)(49,"h2",17)(50,"b",18),t._uU(51,"Isi Konten Pesan"),t.qZA()()(),t.TgZ(52,"div",19),t._UZ(53,"div",24),t.qZA()()()()()()()()),2&e){const i=t.oxw();t.xp6(2),t.Udp("background","url(/assets/img/banner/mailbox-detail.png), linear-gradient(to bottom, "+(i.GS.isDarkMode?"#673ab7":"#3f51b5")+" 0%, #ee0dfd 100%)"),t.xp6(16),t.hij(" ",i.mailData.subject," "),t.xp6(2),t.Oqu(t.xi3(21,11,i.mailData.date,"d MMMM y, hh:mm:ss a z")),t.xp6(14),t.Q6J("multiple",!1),t.xp6(5),t.Oqu(i.mailData.from),t.xp6(1),t.Q6J("ngIf",i.mailData.to),t.xp6(1),t.Q6J("ngIf",i.mailData.cc),t.xp6(1),t.Q6J("ngIf",i.mailData.bcc),t.xp6(1),t.Q6J("ngIf",i.mailData.attachment_.length>0),t.xp6(10),t.Q6J("innerHTML",i.mailData.html||i.mailData.text,t.oJD)}}let B=(()=>{class e{constructor(i,n,l,s,d,b,$){this.activatedRoute=i,this.router=n,this.bs=l,this.fs=s,this.gs=d,this.ms=b,this.wb=$,this.mailId="",this.mailData=null,this.subsParam=null,this.subsMail=null,this.gs.bannerImg=null,this.gs.sizeContain=!1,this.gs.bgRepeat=!1}get GS(){return this.gs}ngOnInit(){this.gs.isBrowser&&this.getMail()}ngOnDestroy(){var i,n;null===(i=this.subsParam)||void 0===i||i.unsubscribe(),null===(n=this.subsMail)||void 0===n||n.unsubscribe()}filterAddress(i){return i?i.split(",").map(n=>n.trim()):[]}getMail(){this.subsParam=this.activatedRoute.params.subscribe({next:i=>{this.mailId=i.mailId,this.bs.busy(),this.subsMail&&(this.subsMail.unsubscribe(),this.bs.idle()),this.subsMail=this.ms.getMail(this.mailId).subscribe({next:n=>{this.gs.log("[MAIL_DETAIL_SUCCESS]",n),this.mailData=n.result,this.fs.initializeFab("outgoing_mail",null,"Balas Email","/create/mailbox",!1),this.bs.idle()},error:n=>{this.gs.log("[MAIL_DETAIL_ERROR]",n,"error"),this.bs.idle(),this.router.navigate(["/error"],{queryParams:{returnUrl:"/mailbox"}})}})}})}downloadAttachment(i){this.wb.winboxOpenUri(`${h.N.apiUrl}/attachment/${i}?ngsw-bypass=true`)}}return e.\u0275fac=function(i){return new(i||e)(t.Y36(c.gz),t.Y36(c.F0),t.Y36(p.z),t.Y36(f.r),t.Y36(x.U),t.Y36(_.Y),t.Y36(P.N))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-mailbox-detail"]],decls:1,vars:1,consts:[["class","p-0 m-0",4,"ngIf"],[1,"p-0","m-0"],[1,"container-fluid","p-0"],[1,"wrapper"],[1,"bg-bubbles","align-items-center","p-0"],[1,"row","align-items-center","h-100"],[1,"col-12","mx-auto"],[1,"container","text-light"],[1,"mb-1",2,"line-height","normal"],[1,"mb-0"],[1,"container"],[1,"row"],[1,"col-md-5","col-xl-4","p-3"],[1,"row","sticky-top"],[1,"col"],[1,"row","py-3"],[1,"col-12","pt-3","sticky-top","bg-bifeldy"],[1,"border-bottom-dotted"],[1,"text-bifeldy"],[1,"col-12"],[3,"multiple"],["mat-list-icon","",1,"ms-3"],["class","row py-3",4,"ngIf"],[1,"col-md-7","col-xl-8","p-3","sticky-top"],[1,"py-2","px-3",2,"white-space","pre-line !important",3,"innerHTML"],[4,"ngFor","ngForOf"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],["mat-line",""]],template:function(i,n){1&i&&t.YNc(0,Y,54,14,"div",0),2&i&&t.Q6J("ngIf",n.mailData)},directives:[r.O5,v.t,m.Ub,m.vS,M.Hw,m.Nh,r.sg,C.X2],pipes:[r.uU,A.$],styles:[".wrapper[_ngcontent-%COMP%]{position:sticky;left:0;width:100%;height:128px;overflow:hidden;background-size:128px,auto!important;background-repeat:no-repeat,repeat!important;background-position-x:100%,0%!important}.bg-bubbles[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%}.bg-bubbles[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{position:absolute;list-style:none;display:block;width:40px;height:40px;background-color:#ffffff26;bottom:-160px;animation:square 25s infinite;transition-timing-function:linear}.bg-bubbles[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:nth-child(1){left:10%}.bg-bubbles[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:nth-child(2){left:20%;width:80px;height:80px;animation-delay:2s;animation-duration:17s}.bg-bubbles[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:nth-child(3){left:25%;animation-delay:4s}.bg-bubbles[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:nth-child(4){left:40%;width:60px;height:60px;animation-duration:22s;background-color:#ffffff40}.bg-bubbles[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:nth-child(5){left:70%}.bg-bubbles[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:nth-child(6){left:80%;width:120px;height:120px;animation-delay:3s;background-color:#fff3}.bg-bubbles[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:nth-child(7){left:32%;width:160px;height:160px;animation-delay:7s}.bg-bubbles[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:nth-child(8){left:55%;width:20px;height:20px;animation-delay:15s;animation-duration:40s}.bg-bubbles[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:nth-child(9){left:25%;width:10px;height:10px;animation-delay:2s;animation-duration:40s;background-color:#ffffff4d}.bg-bubbles[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:nth-child(10){left:90%;width:160px;height:160px;animation-delay:11s}@keyframes square{0%{transform:translateY(0)}to{transform:translateY(-512px) rotate(512deg)}}"]}),e})();var q=o(4137),O=o(7322),J=o(4107),F=o(7423),N=o(578);let R=(()=>{class e{constructor(i,n,l,s,d,b){this.router=i,this.as=n,this.bs=l,this.fs=s,this.gs=d,this.ms=b,this.mailData={inbox:{column:["Tanggal","Pengirim","Topik","Lampiran"],row:[],count:0},outbox:{column:["Tanggal","Penerima","Topik","Lampiran"],row:[],count:0}},this.selectedMailBox="inbox",this.page=1,this.row=10,this.q="",this.sort="",this.order="",this.subsMailbox=null,this.gs.bannerImg=null,this.gs.sizeContain=!1,this.gs.bgRepeat=!1}get GS(){return this.gs}get AS(){return this.as}get ENV(){return h.N}ngOnInit(){this.gs.isBrowser&&this.getMailbox()}ngOnDestroy(){var i;null===(i=this.subsMailbox)||void 0===i||i.unsubscribe()}filterAddress(i){let n="";if(i)for(const l of i.split(","))n&&(n+=", "),l.includes("<")&&l.includes(">")?n+=l.split("<")[1].split(">")[0].trim():n+=l.trim();return n}getMailbox(){this.bs.busy(),this.subsMailbox&&(this.subsMailbox.unsubscribe(),this.bs.idle()),this.subsMailbox=this.ms.getMailbox(this.selectedMailBox,this.q,this.page,this.row,this.sort,this.order).subscribe({next:i=>{this.gs.log("[MAILBOX_LIST_SUCCESS]",i),this.mailData[this.selectedMailBox].count=i.count,this.mailData[this.selectedMailBox].row=[];for(const n of i.results)this.mailData[this.selectedMailBox].row.push({id:n.id,Tanggal:n.date,Pengirim:this.filterAddress(n.from),Penerima:this.filterAddress(n.to),Topik:n.subject,Lampiran:`${n.attachment_count} Berkas`});this.fs.initializeFab("outgoing_mail",null,"Buat Email Baru","/create/mailbox",!1),this.bs.idle()},error:i=>{this.gs.log("[MAILBOX_LIST_ERROR]",i,"error"),this.bs.idle()}})}changeMailbox(){this.getMailbox()}onRowClicked(i){this.gs.log("[MAILBOX_LIST_CLICK_EMAIL]",i),this.router.navigateByUrl(`/mailbox/${i.id}`)}onPaginatorClicked(i){this.gs.log("[MAILBOX_LIST_CLICK_PAGINATOR]",i),this.page=i.pageIndex+1,this.row=i.pageSize,this.getMailbox()}onServerSideFilter(i){this.gs.log("[MAILBOX_LIST_ENTER_FILTER]",i),this.q=i,this.getMailbox()}onServerSideOrder(i){this.gs.log("[MAILBOX_LIST_CLICK_ORDER]",i),this.q=i.q,this.sort=i.active,"created_at"===this.sort?this.sort="date":"title"===this.sort&&(this.sort="subject"),this.order=i.direction,this.getMailbox()}}return e.\u0275fac=function(i){return new(i||e)(t.Y36(c.F0),t.Y36(q.e),t.Y36(p.z),t.Y36(f.r),t.Y36(x.U),t.Y36(_.Y))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-mailbox-list"]],decls:42,vars:12,consts:[[1,"container-fluid","p-0"],[1,"wrapper"],[1,"bg-bubbles","align-items-center","p-0"],[1,"row","align-items-center","h-100"],[1,"col-12","mx-auto"],[1,"container","text-light"],[1,"mb-1",2,"line-height","normal"],[1,"mb-0"],[1,"container"],[1,"row","sticky-top","bg-bifeldy"],[1,"col-12"],[1,"row"],[1,"col-12","pb-3"],[1,"m-0","border-bottom","border-primary","row"],[1,"pt-3","col-6","col-md-4","col-lg-2",3,"color"],[3,"value","valueChange"],["value","inbox"],["value","outbox"],[1,"ms-auto","p-3","col-6","col-md-4","col-lg-2"],["type","button","mat-flat-button","","color","accent",1,"w-100","h-100",3,"click"],[1,"me-1"],[1,"row","p-3"],[3,"tableDataColumn","tableDataRow","count","serverSide","serverSideFilter","rowClicked","paginatorClicked","serverSideOrder"]],template:function(i,n){1&i&&(t.TgZ(0,"div",0)(1,"div",1)(2,"ul",2),t._UZ(3,"li")(4,"li")(5,"li")(6,"li")(7,"li")(8,"li")(9,"li")(10,"li")(11,"li")(12,"li"),t.TgZ(13,"div",3)(14,"div",4)(15,"div",5)(16,"h2",6),t._uU(17),t.qZA(),t.TgZ(18,"p",7),t._uU(19),t.qZA()()()()()()(),t._UZ(20,"app-notifications"),t.TgZ(21,"div",8)(22,"div",9)(23,"div",10)(24,"div",11)(25,"div",12)(26,"h3",13)(27,"mat-form-field",14)(28,"mat-label"),t._uU(29,"Kotak Pesan"),t.qZA(),t.TgZ(30,"mat-select",15),t.NdJ("valueChange",function(s){return n.selectedMailBox=s})("valueChange",function(){return n.changeMailbox()}),t.TgZ(31,"mat-option",16),t._uU(32,"Masuk"),t.qZA(),t.TgZ(33,"mat-option",17),t._uU(34,"Keluar"),t.qZA()()(),t.TgZ(35,"div",18)(36,"button",19),t.NdJ("click",function(){return n.changeMailbox()}),t.TgZ(37,"mat-icon",20),t._uU(38,"loop"),t.qZA(),t._uU(39," Refresh "),t.qZA()()()()()()(),t.TgZ(40,"div",21)(41,"app-material-table",22),t.NdJ("serverSideFilter",function(s){return n.onServerSideFilter(s)})("rowClicked",function(s){return n.onRowClicked(s)})("paginatorClicked",function(s){return n.onPaginatorClicked(s)})("serverSideOrder",function(s){return n.onServerSideOrder(s)}),t.qZA()()()),2&i&&(t.xp6(1),t.Udp("background","url(/assets/img/banner/mailbox.png), linear-gradient(to bottom, "+(n.GS.isDarkMode?"#673ab7":"#3f51b5")+" 0%, #ee0dfd 100%)"),t.xp6(16),t.AsE(" ",null==n.AS.currentUserSubject||null==n.AS.currentUserSubject.value?null:n.AS.currentUserSubject.value.username," @ ",n.ENV.domain," "),t.xp6(2),t.AsE(" ",n.mailData.inbox.count," Inbox ~ ",n.mailData.outbox.count," Outbox "),t.xp6(8),t.Q6J("color","accent"),t.xp6(3),t.Q6J("value",n.selectedMailBox),t.xp6(11),t.Q6J("tableDataColumn",n.mailData[n.selectedMailBox].column)("tableDataRow",n.mailData[n.selectedMailBox].row)("count",n.mailData[n.selectedMailBox].count)("serverSide",!0))},directives:[v.t,O.KE,O.hX,J.gD,C.ey,F.lW,M.Hw,N.I],styles:[".wrapper[_ngcontent-%COMP%]{position:sticky;left:0;width:100%;height:128px;overflow:hidden;background-size:200px,auto!important;background-repeat:no-repeat,repeat!important;background-position-x:100%,0%!important}.bg-bubbles[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%}.bg-bubbles[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{position:absolute;list-style:none;display:block;width:40px;height:40px;background-color:#ffffff26;bottom:-160px;animation:square 25s infinite;transition-timing-function:linear}.bg-bubbles[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:nth-child(1){left:10%}.bg-bubbles[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:nth-child(2){left:20%;width:80px;height:80px;animation-delay:2s;animation-duration:17s}.bg-bubbles[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:nth-child(3){left:25%;animation-delay:4s}.bg-bubbles[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:nth-child(4){left:40%;width:60px;height:60px;animation-duration:22s;background-color:#ffffff40}.bg-bubbles[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:nth-child(5){left:70%}.bg-bubbles[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:nth-child(6){left:80%;width:120px;height:120px;animation-delay:3s;background-color:#fff3}.bg-bubbles[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:nth-child(7){left:32%;width:160px;height:160px;animation-delay:7s}.bg-bubbles[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:nth-child(8){left:55%;width:20px;height:20px;animation-delay:15s;animation-duration:40s}.bg-bubbles[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:nth-child(9){left:25%;width:10px;height:10px;animation-delay:2s;animation-duration:40s;background-color:#ffffff4d}.bg-bubbles[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:nth-child(10){left:90%;width:160px;height:160px;animation-delay:11s}@keyframes square{0%{transform:translateY(0)}to{transform:translateY(-512px) rotate(512deg)}}"]}),e})();var E=o(8613),Q=o(617);const z=[{path:"",pathMatch:"full",component:R},{path:":mailId",children:[{path:"",pathMatch:"full",component:B}]}];let X=(()=>{class e{}return e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[r.ez,c.Bz.forChild(z),u.u5,u.UX,T.m,E.F,Q.H,Z.T]]}),e})()}}]);
"use strict";(self.webpackChunkfansubid=self.webpackChunkfansubid||[]).push([[628],{7628:(B,b,o)=>{o.r(b),o.d(b,{VerifyModule:()=>$});var p=o(9808),d=o(8406),r=o(3075),h=o(3290),y=o(210),k=o(5861),U=o(4249),v=o(5934),u=o(6271),e=o(5e3),I=o(8058),V=o(3e3),C=o(7845),K=o(8696),T=o(4137),D=o(8020),f=o(5615),Z=o(7423),N=o(5245);function E(n,l){1&n&&e._uU(0,"Cari Tanda Pengenal")}function R(n,l){1&n&&(e.TgZ(0,"strong"),e._uU(1," Nomor NIK Tidak Boleh Kosong! "),e._UZ(2,"br"),e.qZA())}function A(n,l){1&n&&(e.TgZ(0,"strong"),e._uU(1," Nomor NIK Hanya Boleh Angka "),e._UZ(2,"br"),e.qZA())}function S(n,l){1&n&&(e.TgZ(0,"strong"),e._uU(1," Nama Depan Tidak Boleh Kosong! "),e._UZ(2,"br"),e.qZA())}function x(n,l){1&n&&(e.TgZ(0,"strong"),e._uU(1," Nama Depan Hanya Boleh Huruf "),e._UZ(2,"br"),e.qZA())}function Y(n,l){1&n&&e._uU(0,"Periksa Data Identitas")}const O=function(n){return{"background-position":"center","background-size":"cover","background-image":n}},_=[{path:"",pathMatch:"full",component:(()=>{class n{constructor(s,t,i,a,g,m,c,P,J){this.fb=s,this.router=t,this.us=i,this.bs=a,this.ds=g,this.gs=m,this.route=c,this.as=P,this.wb=J,this.submitted=!1,this.returnUrl="/",this.verifyImg="/assets/img/verify.png",this.verifyInfo="Verifikasi akunmu dan dapatkan fitur menarik lainnya~",this.kpuRiUserData=null,this.subsCekNik=null,this.subsVerify1=null,this.subsVerify2=null,this.subsSosmed=null,this.subsDialog=null,this.gs.bannerImg=null,this.gs.sizeContain=!1,this.gs.bgRepeat=!1}get ENV(){return v.N}ngOnDestroy(){var s,t,i,a,g;null===(s=this.subsCekNik)||void 0===s||s.unsubscribe(),null===(t=this.subsVerify1)||void 0===t||t.unsubscribe(),null===(i=this.subsVerify2)||void 0===i||i.unsubscribe(),null===(a=this.subsSosmed)||void 0===a||a.unsubscribe(),null===(g=this.subsDialog)||void 0===g||g.unsubscribe()}ngOnInit(){var s,t;if(this.returnUrl=this.route.snapshot.queryParams.returnUrl||this.gs.previousUrl||"/home",this.returnUrl.includes("/login")&&(this.returnUrl="/"),this.gs.isBrowser){this.initKTP();const i=this.route.snapshot.queryParamMap.get("app"),a=this.route.snapshot.queryParamMap.get("code");i&&a?this.sosmedVerify(i,a):(null===(t=null===(s=this.as.currentUserSubject)||void 0===s?void 0:s.value)||void 0===t?void 0:t.verified)?this.router.navigateByUrl(this.returnUrl):this.verifyByKtpDisabled()}}get G_CAPTCHA_SITE_KEY(){return u.t.gCaptchaSiteKey}sosmedVerify(s,t){this.bs.busy(),this.subsSosmed=this.us.sosmedLogin({app:s.toUpperCase(),code:t}).subscribe({next:i=>{this.gs.log("[SOSMED]",i),this.bs.idle(),this.sosmedVerifyResult(i,s)},error:i=>{this.gs.log("[SOSMED]",i,"error"),this.bs.idle(),this.sosmedVerifyResult(i,s)}})}sosmedVerifyResult(s,t){var i;this.subsDialog=this.ds.openInfoDialog({data:{title:(null===(i=s.result)||void 0===i?void 0:i.title)||"Whoops, Terjadi Kesalahan!",htmlMessage:s.result.message,confirmText:"Tutup",cancelText:"Ulangi"}}).afterClosed().subscribe({next:a=>{this.gs.log("[INFO_DIALOG_CLOSED]",a),!0===a?(this.as.removeUser(),this.router.navigate(["/login"],{queryParams:{returnUrl:this.returnUrl}})):!1===a&&t.toUpperCase()===U.Bp.DISCORD&&this.openVerifyDiscordUrl(),this.subsDialog.unsubscribe()}})}verifyByKtpDisabled(){var s=this;return(0,k.Z)(function*(){s.subsDialog=(yield s.ds.openVerifikasiDiscord()).afterClosed().subscribe({next:t=>{s.gs.log("[INFO_DIALOG_CLOSED]",t),!0===t?s.openVerifyDiscordUrl():!1===t&&s.router.navigateByUrl(s.returnUrl),s.subsDialog.unsubscribe()}})})()}openVerifyDiscordUrl(){this.wb.winboxOpenUri(`${v.N.baseUrl}/api/discord-verifikasi`,"_self")}initKTP(){this.fg1=this.fb.group({nik:[null,[r.kI.required,r.kI.pattern(/^\d+$/)]],nama:[null,[r.kI.required,r.kI.pattern("^[a-zA-Z. ]+$")]],completed:[null,[r.kI.required]],"g-recaptcha-response":[null,[r.kI.required,r.kI.pattern(u.t.regexEnglishKeyboardKeys)]]}),this.fg2=this.fb.group({nik:[null,[r.kI.pattern(/^\d+$/)]],nama:[null,[r.kI.pattern("^[a-zA-Z. ]+$")]],tempat_lahir:[null,[r.kI.pattern("^[a-zA-Z ]+$")]],tanggal_lahir:[null,[r.kI.pattern(u.t.regexEnglishKeyboardKeys)]],jenis_kelamin:[null,[r.kI.pattern("^[LP]+$")]],golongan_darah:[null,[r.kI.pattern("^[ABO]+$")]],alamat:[null,[r.kI.pattern(u.t.regexEnglishKeyboardKeys)]],rt:[null,[r.kI.pattern(/^\d+$/)]],rw:[null,[r.kI.pattern(/^\d+$/)]],kelurahan_desa:[null,[r.kI.pattern(u.t.regexEnglishKeyboardKeys)]],kecamatan:[null,[r.kI.pattern(u.t.regexEnglishKeyboardKeys)]],agama:[null,[r.kI.pattern(u.t.regexEnglishKeyboardKeys)]],status_perkawinan:[null,[r.kI.pattern(u.t.regexEnglishKeyboardKeys)]],pekerjaan:[null,[r.kI.pattern(u.t.regexEnglishKeyboardKeys)]],kewarganegaraan:[null,[r.kI.pattern("^[WNIA]+$")]]})}cekNIK(s,t,i){this.gs.log(`[GOOGLE_CAPTCHA] ${s}`),s&&(this.fg1.controls["g-recaptcha-response"].patchValue(s),this.subsCekNik=this.us.cekNik({nik:this.fg1.value.nik,nama:this.fg1.value.nama,"g-recaptcha-response":this.fg1.value["g-recaptcha-response"]}).subscribe({next:a=>{this.gs.log("[KPU_RI-CEK_NIK]",a),"success"===a.result.message?(this.kpuRiUserData={...a.result.data,nik:this.fg1.value.nik},this.verifyInfo=`\n              ${this.kpuRiUserData.nama} - ${this.kpuRiUserData.jenis_kelamin} - ${this.kpuRiUserData.tempat_lahir} -\n              ${this.kpuRiUserData.nik} - ${this.kpuRiUserData.namaKel} - ${this.kpuRiUserData.namaKec} -\n              ${this.kpuRiUserData.namaKabko} - ${this.kpuRiUserData.namaPropinsi}\n            `.replace(/\n/g," ").replace(/ +(?= )/g,"").trim(),this.fg2.controls.nik.patchValue(this.kpuRiUserData.nik),this.fg2.controls.nama.patchValue(this.kpuRiUserData.nama),this.fg2.controls.jenis_kelamin.patchValue(this.kpuRiUserData.jenis_kelamin),this.fg2.controls.tempat_lahir.patchValue(this.kpuRiUserData.tempat_lahir),this.fg2.controls.kelurahan_desa.patchValue(this.kpuRiUserData.namaKel),this.fg2.controls.kecamatan.patchValue(this.kpuRiUserData.namaKec),this.fg1.controls.completed.patchValue(!0),i.next(),t.reset()):(this.verifyInfo=a.result.data.pesan,this.fg1.controls["g-recaptcha-response"].patchValue(null),this.fg1.controls.completed.patchValue(null),this.kpuRiUserData=null,t.reset())}}))}submitKTP(s){this.bs.busy(),this.submitted=!0;const t=this.fg2.value;for(const i in t)null==t[i]&&delete t[i];this.subsVerify1=this.us.verifyKTP({...t}).subscribe({next:i=>{this.gs.log("[USER_VERIFIKASI_SUCCESS]",i),this.bs.idle(),this.submitted=!1,this.as.removeUser(),this.bs.busy(),this.subsVerify2=this.as.verify(this.as.token).subscribe({next:a=>{this.gs.log("[VERIFY_LOGIN_SUCCESS]",a),this.bs.idle(),this.router.navigateByUrl(this.returnUrl)},error:a=>{this.gs.log("[VERIFY_LOGIN_ERROR]",a,"error"),this.bs.idle(),this.as.removeUser(),this.router.navigateByUrl(this.returnUrl)}})},error:i=>{var a;this.gs.log("[USER_VERIFIKASI_ERROR]",i,"error"),this.bs.idle(),this.submitted=!1,this.verifyInfo=(null===(a=i.result)||void 0===a?void 0:a.message)||i.info,s.reset()}})}}return n.\u0275fac=function(s){return new(s||n)(e.Y36(r.qu),e.Y36(d.F0),e.Y36(I.K),e.Y36(V.z),e.Y36(C.x),e.Y36(K.U),e.Y36(d.gz),e.Y36(T.e),e.Y36(D.N))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-verify"]],decls:48,vars:23,consts:[[1,"container-fluid","align-items-center","w-100","h-100"],[1,"row","align-items-center","h-100","m-0"],[1,"col-12","col-md-10","m-auto","py-3"],[1,"row","rgb-border","rounded","bg-bifeldy"],[1,"col-lg-5","col-md-3","ms-auto","p-0",3,"ngStyle"],[1,"col-lg-7","col-md-9","me-auto","p-0"],[1,"card","bg-transparent","border-0"],[1,"card-body","p-0"],[1,"text-center","p-3"],[1,"mb-4",2,"max-width","128px",3,"src"],[1,"h3","mb-3","font-weight-normal"],[1,"text-warning"],["linear","",2,"background-color","transparent"],["stepper",""],[3,"stepControl","editable"],["matStepLabel",""],[1,"m-2",3,"formGroup"],[1,"form-group","row","py-2"],["for","nik",1,"col-md-4","col-form-label","text-md-end"],[1,"col-md-8"],["type","text","id","nik","placeholder","Nomor Induk Kependudukan","required","","autofocus","","formControlName","nik","autocomplete","nik"],["role","alert",1,"invalid-feedback"],[4,"ngIf"],["for","nama",1,"col-md-4","col-form-label","text-md-end"],["type","text","id","nama","placeholder","Nama Depan","required","","autofocus","","formControlName","nama","autocomplete","nama"],[1,"form-group","row","mb-0","py-2"],[1,"col","offset-md-4"],["formControlName","g-recaptcha-response",3,"siteKey","resolved"],["captchaRef",""],[1,"col-12"],["mat-flat-button","","color","primary","type","button",1,"w-100",3,"disabled","click"],[1,"ms-1"]],template:function(s,t){if(1&s){const i=e.EpF();e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),e._UZ(4,"div",4),e.TgZ(5,"div",5)(6,"div",6)(7,"div",7)(8,"div",8),e._UZ(9,"img",9),e.TgZ(10,"h1",10),e._uU(11,'Yuhu~, Ayo Verifikasi! >_<"'),e.qZA(),e.TgZ(12,"p",11),e._uU(13),e.qZA()(),e.TgZ(14,"mat-vertical-stepper",12,13)(16,"mat-step",14),e.YNc(17,E,1,0,"ng-template",15),e.TgZ(18,"form",16)(19,"div",17)(20,"label",18),e._uU(21,"NIK KTP"),e.qZA(),e.TgZ(22,"div",19),e._UZ(23,"input",20),e.TgZ(24,"span",21),e.YNc(25,R,3,0,"strong",22),e.YNc(26,A,3,0,"strong",22),e.qZA()()(),e.TgZ(27,"div",17)(28,"label",23),e._uU(29,"Nama Depan"),e.qZA(),e.TgZ(30,"div",19),e._UZ(31,"input",24),e.TgZ(32,"span",21),e.YNc(33,S,3,0,"strong",22),e.YNc(34,x,3,0,"strong",22),e.qZA()()(),e.TgZ(35,"div",25)(36,"div",26)(37,"re-captcha",27,28),e.NdJ("resolved",function(g){e.CHM(i);const m=e.MAs(38),c=e.MAs(15);return t.cekNIK(g,m,c)}),e.qZA()()()()(),e.TgZ(39,"mat-step",14),e.YNc(40,Y,1,0,"ng-template",15),e.TgZ(41,"form",16)(42,"div",25)(43,"div",29)(44,"button",30),e.NdJ("click",function(){e.CHM(i);const g=e.MAs(15);return t.submitKTP(g)}),e._uU(45," Data Saya Diatas Sudah Benar "),e.TgZ(46,"mat-icon",31),e._uU(47,"check_circle_outline"),e.qZA()()()()()()()()()()()()()()}2&s&&(e.xp6(4),e.Q6J("ngStyle",e.VKq(21,O,"url("+t.verifyImg+")")),e.xp6(5),e.MGl("src","",t.ENV.baseUrl,"/assets/img/logo/verify.png",e.LSH),e.xp6(4),e.Oqu(t.verifyInfo),e.xp6(3),e.Q6J("stepControl",t.fg1)("editable",!1),e.xp6(2),e.Q6J("formGroup",t.fg1),e.xp6(5),e.Gre("form-control ",!t.fg1.get("nik").valid&&t.fg1.get("nik").touched?"is-invalid":"",""),e.xp6(2),e.Q6J("ngIf",t.fg1.get("nik").hasError("required")),e.xp6(1),e.Q6J("ngIf",t.fg1.get("nik").hasError("pattern")),e.xp6(5),e.Gre("form-control ",!t.fg1.get("nama").valid&&t.fg1.get("nama").touched?"is-invalid":"",""),e.xp6(2),e.Q6J("ngIf",t.fg1.get("nama").hasError("required")),e.xp6(1),e.Q6J("ngIf",t.fg1.get("nama").hasError("pattern")),e.xp6(3),e.Q6J("siteKey",t.G_CAPTCHA_SITE_KEY),e.xp6(2),e.Q6J("stepControl",t.fg2)("editable",!1),e.xp6(2),e.Q6J("formGroup",t.fg2),e.xp6(3),e.Q6J("disabled",t.submitted))},directives:[p.PC,f.Vq,f.C0,f.VY,r._Y,r.JL,r.sg,r.Fj,r.Q7,r.JJ,r.u,p.O5,h.wT,h.Vd,Z.lW,N.Hw],styles:[""]}),n})()}];let $=(()=>{class n{}return n.\u0275fac=function(s){return new(s||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[p.ez,d.Bz.forChild(_),r.u5,r.UX,y.m,h.a,h.lQ]]}),n})()}}]);
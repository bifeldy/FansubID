"use strict";(self.webpackChunkmain_site=self.webpackChunkmain_site||[]).push([[767],{8124:(M,y,r)=>{r.d(y,{S:()=>V});var t=r(4650),m=r(9816),C=r(1390),g=r(4674),T=r(4425),x=r(2972),a=r(293),p=r(80),s=r(6895),l=r(4006),_=r(9818),u=r(7392),f=r(8455),R=r(9203),b=r(6255),v=r(7462),A=r(1883),O=r(7397),Z=r(1105);function I(i,h){if(1&i){const e=t.EpF();t.TgZ(0,"div",4)(1,"mat-form-field",5)(2,"mat-label"),t._uU(3,"Buat Komentar Baru"),t.qZA(),t.TgZ(4,"input",6),t.NdJ("ngModelChange",function(o){t.CHM(e);const c=t.oxw();return t.KtG(c.commentToSend=o)}),t.qZA(),t._UZ(5,"mat-icon",7),t.qZA(),t.TgZ(6,"div",8)(7,"button",9),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.sendComment(null))}),t._uU(8," Kirim "),t._UZ(9,"mat-icon",10),t.qZA()()()}if(2&i){const e=t.oxw();t.xp6(1),t.Q6J("color","accent"),t.xp6(3),t.Q6J("ngModel",e.commentToSend)}}function N(i,h){if(1&i){const e=t.EpF();t.TgZ(0,"mat-form-field",34)(1,"mat-label"),t._uU(2,"Balas / Tanggapi"),t.qZA(),t.TgZ(3,"input",35),t.NdJ("ngModelChange",function(o){t.CHM(e);const c=t.oxw().$implicit;return t.KtG(c.reply_to_send=o)}),t.qZA(),t._UZ(4,"mat-icon",7),t.qZA()}if(2&i){const e=t.oxw().$implicit;t.Q6J("color","accent"),t.xp6(3),t.Q6J("ngModel",e.reply_to_send)}}function H(i,h){1&i&&t._UZ(0,"mat-icon",39)}function K(i,h){1&i&&t._UZ(0,"mat-icon",40)}function P(i,h){if(1&i){const e=t.EpF();t.TgZ(0,"button",36),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().$implicit,c=t.oxw();return t.KtG(c.showHideComment(o))}),t.YNc(1,H,1,0,"mat-icon",37),t.YNc(2,K,1,0,"mat-icon",38),t._uU(3),t.qZA()}if(2&i){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",!e.show_reply),t.xp6(1),t.Q6J("ngIf",e.show_reply),t.xp6(1),t.AsE(" ",e.show_reply?"Sembunyikan":"Tampilkan"," ",e.reply_count," balasan ")}}function D(i,h){if(1&i){const e=t.EpF();t.TgZ(0,"button",9),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().$implicit,c=t.oxw();return t.KtG(c.sendComment(o))}),t._uU(1," Kirim "),t._UZ(2,"mat-icon",10),t.qZA()}}function w(i,h){if(1&i&&t._UZ(0,"app-comment",41),2&i){const e=t.oxw().$implicit,n=t.oxw();t.Q6J("parent",e)("komentar",e.reply)("recursionCount",n.recursionCount+1)}}function S(i,h){if(1&i){const e=t.EpF();t.TgZ(0,"div",11)(1,"div",12),t._UZ(2,"img",13),t.qZA(),t.TgZ(3,"div")(4,"div",14),t.NdJ("click",function(){const c=t.CHM(e).$implicit,d=t.oxw();return t.KtG(d.showHideCommentBox(c))}),t.TgZ(5,"p",15)(6,"b",16),t.NdJ("click",function(o){const d=t.CHM(e).$implicit,E=t.oxw();return o.stopPropagation(),t.KtG(E.openUserProfile(d))}),t._uU(7),t.qZA(),t.TgZ(8,"small",17),t.ALo(9,"date"),t._uU(10),t.ALo(11,"dateAgo"),t.qZA()(),t._UZ(12,"p",18),t.qZA(),t.TgZ(13,"div",19)(14,"button",20),t._UZ(15,"mat-icon",21),t.qZA(),t.TgZ(16,"mat-menu",null,22)(18,"button",23),t.NdJ("click",function(){const c=t.CHM(e).$implicit,d=t.oxw();return t.KtG(d.reportComment(c))}),t._UZ(19,"mat-icon",24),t._uU(20," Laporkan "),t.qZA(),t.TgZ(21,"button",23),t.NdJ("click",function(){const c=t.CHM(e).$implicit,d=t.oxw();return t.KtG(d.deleteComment(c))}),t._UZ(22,"mat-icon",25),t._uU(23," Hapus "),t.qZA(),t.TgZ(24,"button",23),t.NdJ("click",function(){const c=t.CHM(e).$implicit,d=t.oxw();return t.KtG(d.copyCommentLink(c))}),t._UZ(25,"mat-icon",26),t._uU(26," Salin URL "),t.qZA()()(),t.YNc(27,N,5,2,"mat-form-field",27),t.TgZ(28,"div",28)(29,"div",4)(30,"div",29),t.YNc(31,P,4,4,"button",30),t.qZA(),t.TgZ(32,"div",31),t.YNc(33,D,3,0,"button",32),t.qZA()()(),t.YNc(34,w,1,3,"app-comment",33),t.qZA()()}if(2&i){const e=h.$implicit,n=t.MAs(17),o=t.oxw();t.xp6(2),t.s9C("src",e.user_.image_url,t.LSH),t.xp6(1),t.Gre("flex-grow-1 ms-3 row ",0===o.recursionCount?"me-2":"",""),t.xp6(4),t.hij(" ",e.user_.username," "),t.xp6(1),t.s9C("matTooltip",t.xi3(9,13,e.created_at,"d MMMM y, hh:mm:ss a z")),t.xp6(2),t.hij(" ",t.lcZ(11,16,e.created_at)," "),t.xp6(2),t.Q6J("innerHTML",e.comment,t.oJD),t.xp6(2),t.Q6J("matMenuTriggerFor",n),t.xp6(13),t.Q6J("ngIf",e.reply_mode&&(null==o.AS.currentUserSubject?null:o.AS.currentUserSubject.value)&&0===o.recursionCount),t.xp6(4),t.Q6J("ngIf",e.reply_count>0),t.xp6(2),t.Q6J("ngIf",e.reply_mode&&(null==o.AS.currentUserSubject?null:o.AS.currentUserSubject.value)&&0===o.recursionCount),t.xp6(1),t.Q6J("ngIf",e.show_reply)}}function L(i,h){if(1&i){const e=t.EpF();t.TgZ(0,"div",42)(1,"button",9),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.loadNextPage())}),t._UZ(2,"mat-icon",43),t._uU(3," Load More ... "),t.qZA()()}}function k(i,h){1&i&&(t.TgZ(0,"div",4),t._UZ(1,"app-no-data",44),t.qZA())}let U=(()=>{class i{constructor(e,n,o,c,d,E){this.clipboard=e,this.router=n,this.snackBar=o,this.komen=c,this.gs=d,this.as=E,this.urlPath=null,this.count=0,this.page=1,this.row=10,this.pageFinished=!1,this.recursionCount=0,this.rootCommentBox=!1,this.commentToSend=null,this.parent=null,this.komentar=[],this.subsKomenSend=null,this.subsKomenGetKomen=null,this.subsKomenGetReply=null,this.subsDelete=null,this.subsRouter=null}get AS(){return this.as}ngOnInit(){this.gs.isBrowser&&(0===this.recursionCount&&this.reloadComponent(),this.subsRouter=this.router.events.subscribe({next:e=>{e instanceof C.m2&&this.reloadComponent()}}))}ngOnDestroy(){this.subsKomenSend?.unsubscribe(),this.subsKomenGetKomen?.unsubscribe(),this.subsKomenGetReply?.unsubscribe(),this.subsDelete?.unsubscribe(),this.subsRouter?.unsubscribe(),this.urlPath=null}reloadComponent(){this.urlPath=this.router.url.split("?")[0],this.getComment(!0)}sendComment(e){this.gs.log("[KOMENTAR_PARENT_CREATE_REPLY]",e),this.subsKomenSend=this.komen.sendComment(e?{path:this.urlPath,comment:e.reply_to_send,parent:e.id}:{path:this.urlPath,comment:this.commentToSend}).subscribe({next:o=>{this.gs.log("[KOMENTAR_CREATE_REPLY_SUCCESS]",o),e?(e.reply_to_send=null,e.reply_mode=!1,this.getReply(e,!0)):(this.commentToSend=null,this.getComment(!0))},error:o=>{this.gs.log("[KOMENTAR_CREATE_REPLY_ERROR]",o,"error")}})}getComment(e=!1){this.parent||(e&&(this.page=1,this.pageFinished=!1),this.subsKomenGetKomen=this.komen.getComment(this.urlPath,"",this.page,this.row).subscribe({next:n=>{this.gs.log("[KOMENTAR_LIST_SUCCESS]",n),this.count=n.count,this.komentar=e?n.results:[...this.komentar,...n.results],n.results.length<=0&&(this.pageFinished=!0)},error:n=>{this.gs.log("[KOMENTAR_LIST_ERROR]",n,"error")}}))}getReply(e,n=!1){this.gs.log("[KOMENTAR_PARENT_LOAD_REPLY]",e),n&&(e.reply_page=1,e.reply_page_finised=!1),this.subsKomenGetReply=this.komen.getReply(e.id,"",e.reply_page,this.row).subscribe({next:o=>{this.gs.log("[REPLY_LIST_SUCCESS]",o),e.reply=n?o.results:[...e.reply,...o.results],e.reply_count=o.count,o.results.length<=0&&(e.reply_page_finised=!0)},error:o=>{this.gs.log("[REPLY_LIST_ERROR]",o,"error"),e.reply=[]}})}showHideComment(e){e.show_reply=null==e.show_reply||!e.show_reply,e.show_reply&&this.getReply(e,!0)}showHideCommentBox(e){e.reply_mode=null==e.reply_mode||!e.reply_mode}loadNextPage(){this.parent?this.loadNextPageReply(this.parent):this.loadNextPageComment()}loadNextPageComment(){this.pageFinished||(this.page++,this.getComment())}loadNextPageReply(e){e.reply_page_finised||(e.reply_page||(e.reply_page=1),e.reply_page++,this.getReply(e))}openUserProfile(e){this.router.navigateByUrl(`/user/${e.user_.username}`)}copyCommentLink(e){const n=(e.path.startsWith("/")?g.N.baseUrl:"")+e.path;this.clipboard.copy(`${n}?comment=${e.id}`)&&this.snackBar.open("URL Komentar :: Telah Di Salin Pada Clipboard","OK")}deleteComment(e){this.gs.log("[KOMENTAR_DELETE_COMMENT]",e),this.subsDelete=this.komen.deleteComment(e.id).subscribe({next:n=>{this.gs.log("[KOMENTAR_DELETE_SUCCESS]",n),this.parent?this.getReply(this.parent,!0):this.getComment(!0)},error:n=>{this.gs.log("[KOMENTAR_DELETE_ERROR]",n,"error"),this.parent?this.getReply(this.parent,!0):this.getComment(!0)}})}reportComment(e){this.gs.log("[KOMENTAR_REPORT_COMMENT]",e);const n=(e.path.startsWith("/")?g.N.baseUrl:"")+e.path;this.router.navigate(["/create/ticket"],{queryParams:{url:`${n}?comment=${e.id}`}})}static#t=this.\u0275fac=function(n){return new(n||i)(t.Y36(T.TU),t.Y36(C.F0),t.Y36(x.pl),t.Y36(a.k),t.Y36(m.U),t.Y36(p.e))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-comment"]],inputs:{row:"row",recursionCount:"recursionCount",rootCommentBox:"rootCommentBox",parent:"parent",komentar:"komentar"},decls:5,vars:4,consts:[["class","row",4,"ngIf"],["appDomChange","",1,"row"],["class","d-flex my-1",4,"ngFor","ngForOf"],["class","col-12",4,"ngIf"],[1,"row"],["appearance","outline",1,"col-12",3,"color"],["matInput","","placeholder","Buat Baru ...",3,"ngModel","ngModelChange"],["fontIcon","quickreply","matSuffix",""],[1,"col-12","text-end","pe-0","mb-3"],["type","button","mat-button","","color","accent",3,"click"],["fontIcon","send",1,"ms-1"],[1,"d-flex","my-1"],[1,"flex-shrink-0"],["width","40","height","40",2,"object-fit","cover","object-position","center",3,"src"],[1,"col-8","p-0",3,"click"],[1,"m-0"],[1,"text-warning",2,"cursor","pointer",3,"click"],[1,"ms-3","text-bifeldy",3,"matTooltip"],[1,"mb-1",2,"line-height","normal",3,"innerHTML"],[1,"col","p-0","text-end"],["type","button","mat-icon-button","","color","accent","matTooltip","Opsi",3,"matMenuTriggerFor"],["fontIcon","more_vert"],["komentarMenu","matMenu"],["type","button","mat-menu-item","",3,"click"],["fontIcon","flag",1,"me-1"],["fontIcon","delete",1,"me-1"],["fontIcon","link",1,"me-1"],["appearance","outline","class","mt-2 col-12",3,"color",4,"ngIf"],[1,"col-12","p-0"],[1,"col-6"],["type","button","mat-button","","class","ps-1 pe-2","color","accent",3,"click",4,"ngIf"],[1,"col-6","text-end"],["type","button","mat-button","","color","accent",3,"click",4,"ngIf"],[3,"parent","komentar","recursionCount",4,"ngIf"],["appearance","outline",1,"mt-2","col-12",3,"color"],["matInput","","placeholder","Balas ...",3,"ngModel","ngModelChange"],["type","button","mat-button","","color","accent",1,"ps-1","pe-2",3,"click"],["fontIcon","expand_more","class","me-1",4,"ngIf"],["fontIcon","expand_less","class","me-1",4,"ngIf"],["fontIcon","expand_more",1,"me-1"],["fontIcon","expand_less",1,"me-1"],[3,"parent","komentar","recursionCount"],[1,"col-12"],["fontIcon","subdirectory_arrow_right",1,"me-1"],[1,"col-12","p-3"]],template:function(n,o){1&n&&(t.YNc(0,I,10,2,"div",0),t.TgZ(1,"div",1),t.YNc(2,S,35,18,"div",2),t.YNc(3,L,4,0,"div",3),t.qZA(),t.YNc(4,k,2,0,"div",0)),2&n&&(t.Q6J("ngIf",o.rootCommentBox&&(null==o.AS.currentUserSubject?null:o.AS.currentUserSubject.value)),t.xp6(2),t.Q6J("ngForOf",o.komentar),t.xp6(1),t.Q6J("ngIf",o.count>=10&&!o.pageFinished||(null==o.parent?null:o.parent.reply_count)>=10&&!(null!=o.parent&&o.parent.reply_page_finised)),t.xp6(1),t.Q6J("ngIf",o.komentar&&o.komentar.length<=0))},dependencies:[s.sg,s.O5,l.Fj,l.JJ,l.On,_.eB,u.Hw,f.v_,f.$V,f.nX,R.k0,b.W0,b.tN,b.D8,v.Kd,A.S,O.d,i,s.uU,Z.R]})}return i})();function J(i,h){if(1&i){const e=t.EpF();t.TgZ(0,"div",24)(1,"div",30)(2,"div",5),t._UZ(3,"img",6),t.qZA(),t.TgZ(4,"div",7)(5,"div",31)(6,"p",9)(7,"b",10),t.NdJ("click",function(o){t.CHM(e);const c=t.oxw(3);return o.stopPropagation(),t.KtG(c.openUserProfile(c.komentarHighlight))}),t._uU(8),t.qZA(),t.TgZ(9,"small",11),t.ALo(10,"date"),t._uU(11),t.ALo(12,"dateAgo"),t.qZA()(),t._UZ(13,"p",12),t.qZA(),t.TgZ(14,"div",13)(15,"button",14),t._UZ(16,"mat-icon",15),t.qZA(),t.TgZ(17,"mat-menu",null,16)(19,"button",17),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().$implicit,c=t.oxw(2);return t.KtG(c.reportComment(o))}),t._UZ(20,"mat-icon",18),t._uU(21," Laporkan "),t.qZA(),t.TgZ(22,"button",17),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().$implicit,c=t.oxw(2);return t.KtG(c.deleteComment(o))}),t._UZ(23,"mat-icon",19),t._uU(24," Hapus "),t.qZA(),t.TgZ(25,"button",17),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().$implicit,c=t.oxw(2);return t.KtG(c.copyCommentLink(o))}),t._UZ(26,"mat-icon",20),t._uU(27," Salin URL "),t.qZA()()()()()()}if(2&i){const e=t.MAs(18),n=t.oxw(3);t.xp6(3),t.s9C("src",n.komentarHighlight.user_.image_url,t.LSH),t.xp6(5),t.hij(" ",n.komentarHighlight.user_.username," "),t.xp6(1),t.s9C("matTooltip",t.xi3(10,6,n.komentarHighlight.created_at,"d MMMM y, hh:mm:ss a z")),t.xp6(2),t.hij(" ",t.lcZ(12,9,n.komentarHighlight.created_at)," "),t.xp6(2),t.Q6J("innerHTML",n.komentarHighlight.comment,t.oJD),t.xp6(2),t.Q6J("matMenuTriggerFor",e)}}function B(i,h){if(1&i){const e=t.EpF();t.TgZ(0,"mat-form-field",32)(1,"mat-label"),t._uU(2,"Balas / Tanggapi"),t.qZA(),t.TgZ(3,"input",33),t.NdJ("ngModelChange",function(o){t.CHM(e);const c=t.oxw().$implicit;return t.KtG(c.reply_to_send=o)}),t.qZA(),t._UZ(4,"mat-icon",34),t.qZA()}if(2&i){const e=t.oxw().$implicit;t.Q6J("color","accent"),t.xp6(3),t.Q6J("ngModel",e.reply_to_send)}}function F(i,h){1&i&&t._UZ(0,"mat-icon",38)}function Y(i,h){1&i&&t._UZ(0,"mat-icon",39)}function $(i,h){if(1&i){const e=t.EpF();t.TgZ(0,"button",35),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().$implicit,c=t.oxw(2);return t.KtG(c.showHideComment(o))}),t.YNc(1,F,1,0,"mat-icon",36),t.YNc(2,Y,1,0,"mat-icon",37),t._uU(3),t.qZA()}if(2&i){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",!e.show_reply),t.xp6(1),t.Q6J("ngIf",e.show_reply),t.xp6(1),t.AsE(" ",e.show_reply?"Sembunyikan":"Tampilkan"," ",e.reply_count," balasan ")}}function G(i,h){if(1&i){const e=t.EpF();t.TgZ(0,"button",40),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().$implicit,c=t.oxw(2);return t.KtG(c.sendComment(o))}),t._uU(1," Kirim "),t._UZ(2,"mat-icon",41),t.qZA()}}function Q(i,h){if(1&i&&t._UZ(0,"app-comment",42),2&i){const e=t.oxw().$implicit,n=t.oxw(2);t.Q6J("parent",e)("komentar",e.reply)("recursionCount",n.recursionCount+1)("row",5)}}function j(i,h){if(1&i){const e=t.EpF();t.TgZ(0,"div",4)(1,"div",5),t._UZ(2,"img",6),t.qZA(),t.TgZ(3,"div",7)(4,"div",8),t.NdJ("click",function(){const c=t.CHM(e).$implicit,d=t.oxw(2);return t.KtG(d.showHideCommentBox(c))}),t.TgZ(5,"p",9)(6,"b",10),t.NdJ("click",function(o){const d=t.CHM(e).$implicit,E=t.oxw(2);return o.stopPropagation(),t.KtG(E.openUserProfile(d))}),t._uU(7),t.qZA(),t.TgZ(8,"small",11),t.ALo(9,"date"),t._uU(10),t.ALo(11,"dateAgo"),t.qZA()(),t._UZ(12,"p",12),t.qZA(),t.TgZ(13,"div",13)(14,"button",14),t._UZ(15,"mat-icon",15),t.qZA(),t.TgZ(16,"mat-menu",null,16)(18,"button",17),t.NdJ("click",function(){const c=t.CHM(e).$implicit,d=t.oxw(2);return t.KtG(d.reportComment(c))}),t._UZ(19,"mat-icon",18),t._uU(20," Laporkan "),t.qZA(),t.TgZ(21,"button",17),t.NdJ("click",function(){const c=t.CHM(e).$implicit,d=t.oxw(2);return t.KtG(d.deleteComment(c))}),t._UZ(22,"mat-icon",19),t._uU(23," Hapus "),t.qZA(),t.TgZ(24,"button",17),t.NdJ("click",function(){const c=t.CHM(e).$implicit,d=t.oxw(2);return t.KtG(d.copyCommentLink(c))}),t._UZ(25,"mat-icon",20),t._uU(26," Salin URL "),t.qZA()()(),t.TgZ(27,"div",21),t.YNc(28,J,28,11,"div",22),t.qZA(),t.YNc(29,B,5,2,"mat-form-field",23),t.TgZ(30,"div",21)(31,"div",24)(32,"div",25),t.YNc(33,$,4,4,"button",26),t.qZA(),t.TgZ(34,"div",27),t.YNc(35,G,3,0,"button",28),t.qZA()()(),t.YNc(36,Q,1,4,"app-comment",29),t.qZA()()}if(2&i){const e=h.$implicit,n=t.MAs(17),o=t.oxw(2);t.xp6(2),t.s9C("src",e.user_.image_url,t.LSH),t.xp6(5),t.hij(" ",e.user_.username," "),t.xp6(1),t.s9C("matTooltip",t.xi3(9,11,e.created_at,"d MMMM y, hh:mm:ss a z")),t.xp6(2),t.hij(" ",t.lcZ(11,14,e.created_at)," "),t.xp6(2),t.Q6J("innerHTML",e.comment,t.oJD),t.xp6(2),t.Q6J("matMenuTriggerFor",n),t.xp6(14),t.Q6J("ngIf",o.komentarHighlight),t.xp6(1),t.Q6J("ngIf",e.reply_mode&&(null==o.AS.currentUserSubject?null:o.AS.currentUserSubject.value)&&0===o.recursionCount),t.xp6(4),t.Q6J("ngIf",e.reply_count>0),t.xp6(2),t.Q6J("ngIf",e.reply_mode&&(null==o.AS.currentUserSubject?null:o.AS.currentUserSubject.value)&&0===o.recursionCount),t.xp6(1),t.Q6J("ngIf",e.show_reply)}}function W(i,h){if(1&i){const e=t.EpF();t.TgZ(0,"div",43)(1,"button",40),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.loadNextPage())}),t._UZ(2,"mat-icon",44),t._uU(3," Load More ... "),t.qZA()()}}function q(i,h){if(1&i&&(t.TgZ(0,"div",1),t.YNc(1,j,37,16,"div",2),t.YNc(2,W,4,0,"div",3),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.komentar),t.xp6(1),t.Q6J("ngIf",e.count>=10&&!e.pageFinished||(null==e.parent?null:e.parent.reply_count)>=10&&!(null!=e.parent&&e.parent.reply_page_finised))}}let z=(()=>{class i{constructor(e,n,o,c,d,E,X){this.clipboard=e,this.activatedRoute=n,this.router=o,this.snackBar=c,this.komen=d,this.gs=E,this.as=X,this.highlightId=0,this.komentarHighlight=null,this.urlPath=null,this.count=0,this.page=1,this.pageFinished=!1,this.recursionCount=0,this.commentToSend=null,this.parent=null,this.komentar=[],this.subsHighlight=null,this.subsKomenSend=null,this.subsKomenGetKomen=null,this.subsKomenGetReply=null,this.subsDelete=null,this.subsQueryParam=null}get AS(){return this.as}ngOnInit(){this.gs.isBrowser&&this.watchUrlRoute()}ngOnDestroy(){this.subsKomenSend?.unsubscribe(),this.subsKomenGetKomen?.unsubscribe(),this.subsKomenGetReply?.unsubscribe(),this.subsHighlight?.unsubscribe(),this.subsDelete?.unsubscribe(),this.subsQueryParam?.unsubscribe(),this.urlPath=null}watchUrlRoute(){this.subsQueryParam=this.activatedRoute.queryParams.subscribe({next:e=>{this.komentarHighlight=null,this.komentar=[],this.urlPath=this.router.url.split("?")[0],this.highlightId=Number(e.comment||""),this.highlightId>0&&this.getHighlight()}})}getHighlight(e=this.highlightId){this.subsHighlight=this.komen.getHighlight({id:e,path:this.urlPath}).subscribe({next:n=>{this.gs.log("[KOMENTAR_HIGHLIGHT_SUCCESS]",n),n.result.parent_komentar_?(this.komentarHighlight=n.result,this.getHighlight(n.result.parent_komentar_.id)):this.komentar=[n.result]},error:n=>{this.gs.log("[KOMENTAR_HIGHLIGHT_ERROR]",n,"error")}})}sendComment(e){this.gs.log("[KOMENTAR_PARENT_CREATE_REPLY]",e),this.subsKomenSend=this.komen.sendComment(e?{path:this.urlPath,comment:e.reply_to_send,parent:e.id}:{path:this.urlPath,comment:this.commentToSend}).subscribe({next:o=>{this.gs.log("[KOMENTAR_CREATE_REPLY_SUCCESS]",o),e?(e.reply_to_send=null,e.reply_mode=!1,this.getReply(e,!0)):(this.commentToSend=null,this.getComment(!0))},error:o=>{this.gs.log("[KOMENTAR_CREATE_REPLY_ERROR]",o,"error")}})}getComment(e=!1){this.parent||(e&&(this.page=1,this.pageFinished=!1),this.subsKomenGetKomen=this.komen.getComment(this.urlPath,"",this.page,5).subscribe({next:n=>{this.gs.log("[KOMENTAR_LIST_SUCCESS]",n),this.count=n.count,this.komentar=e?n.results:[...this.komentar,...n.results],n.results.length<=0&&(this.pageFinished=!0)},error:n=>{this.gs.log("[KOMENTAR_LIST_ERROR]",n,"error")}}))}getReply(e,n=!1){this.gs.log("[KOMENTAR_PARENT_LOAD_REPLY]",e),n&&(e.reply_page=1,e.reply_page_finised=!1),this.subsKomenGetReply=this.komen.getReply(e.id,"",e.reply_page,5).subscribe({next:o=>{this.gs.log("[REPLY_LIST_SUCCESS]",o),e.reply=n?o.results:[...e.reply,...o.results],e.reply_count=o.count,o.results.length<=0&&(e.reply_page_finised=!0)},error:o=>{this.gs.log("[REPLY_LIST_ERROR]",o,"error"),e.reply=[]}})}showHideComment(e){e.show_reply=null==e.show_reply||!e.show_reply,e.show_reply&&this.getReply(e,!0)}showHideCommentBox(e){e.reply_mode=null==e.reply_mode||!e.reply_mode}loadNextPage(){this.parent?this.loadNextPageReply(this.parent):this.loadNextPageComment()}loadNextPageComment(){this.pageFinished||(this.page++,this.getComment())}loadNextPageReply(e){e.reply_page_finised||(e.reply_page||(e.reply_page=1),e.reply_page++,this.getReply(e))}openUserProfile(e){this.router.navigateByUrl(`/user/${e.user_.username}`)}copyCommentLink(e){const n=(e.path.startsWith("/")?g.N.baseUrl:"")+e.path;this.clipboard.copy(`${n}?comment=${e.id}`)&&this.snackBar.open("URL Komentar :: Telah Di Salin Pada Clipboard","OK")}deleteComment(e){this.gs.log("[KOMENTAR_DELETE_HIGHLIGHT]",e),this.subsDelete=this.komen.deleteComment(e.id).subscribe({next:n=>{this.gs.log("[KOMENTAR_DELETE_SUCCESS]",n),this.getHighlight()},error:n=>{this.gs.log("[KOMENTAR_DELETE_ERROR]",n,"error"),this.getHighlight()}})}reportComment(e){this.gs.log("[KOMENTAR_REPORT_HIGHLIGHT]",e);const n=(e.path.startsWith("/")?g.N.baseUrl:"")+e.path;this.router.navigate(["/create/ticket"],{queryParams:{url:`${n}?comment=${e.id}`}})}static#t=this.\u0275fac=function(n){return new(n||i)(t.Y36(T.TU),t.Y36(C.gz),t.Y36(C.F0),t.Y36(x.pl),t.Y36(a.k),t.Y36(m.U),t.Y36(p.e))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-highlight"]],inputs:{recursionCount:"recursionCount",parent:"parent",komentar:"komentar"},decls:1,vars:1,consts:[["class","row pt-3 pb-2 mb-4 gradient-border rgb-border","appDomChange","",4,"ngIf"],["appDomChange","",1,"row","pt-3","pb-2","mb-4","gradient-border","rgb-border"],["class","d-flex my-1",4,"ngFor","ngForOf"],["class","col-12",4,"ngIf"],[1,"d-flex","my-1"],[1,"flex-shrink-0"],["width","40","height","40",2,"object-fit","cover","object-position","center",3,"src"],[1,"flex-grow-1","ms-3","me-2","row"],[1,"col-8","p-0",3,"click"],[1,"m-0"],[1,"text-warning",2,"cursor","pointer",3,"click"],[1,"ms-3","text-bifeldy",3,"matTooltip"],[1,"mb-1",2,"line-height","normal",3,"innerHTML"],[1,"col","p-0","text-end"],["type","button","mat-icon-button","","color","accent","matTooltip","Opsi",3,"matMenuTriggerFor"],["fontIcon","more_vert"],["komentarMenu","matMenu"],["type","button","mat-menu-item","",3,"click"],["fontIcon","flag",1,"me-1"],["fontIcon","delete",1,"me-1"],["fontIcon","link",1,"me-1"],[1,"col-12","p-0"],["class","row",4,"ngIf"],["appearance","outline","class","mt-2 col-12",3,"color",4,"ngIf"],[1,"row"],[1,"col-6"],["type","button","mat-button","","class","ps-1 pe-2","color","accent",3,"click",4,"ngIf"],[1,"col-6","text-end"],["type","button","mat-button","","color","accent",3,"click",4,"ngIf"],[3,"parent","komentar","recursionCount","row",4,"ngIf"],[1,"ms-2","ps-3","d-flex","my-1"],[1,"col-8","p-0"],["appearance","outline",1,"mt-2","col-12",3,"color"],["matInput","","placeholder","Balas ...",3,"ngModel","ngModelChange"],["fontIcon","quickreply","matSuffix",""],["type","button","mat-button","","color","accent",1,"ps-1","pe-2",3,"click"],["fontIcon","expand_more","class","me-1",4,"ngIf"],["fontIcon","expand_less","class","me-1",4,"ngIf"],["fontIcon","expand_more",1,"me-1"],["fontIcon","expand_less",1,"me-1"],["type","button","mat-button","","color","accent",3,"click"],["fontIcon","send",1,"ms-1"],[3,"parent","komentar","recursionCount","row"],[1,"col-12"],["fontIcon","subdirectory_arrow_right",1,"me-1"]],template:function(n,o){1&n&&t.YNc(0,q,3,2,"div",0),2&n&&t.Q6J("ngIf",o.komentar.length>0)},dependencies:[s.sg,s.O5,l.Fj,l.JJ,l.On,_.eB,u.Hw,f.v_,f.$V,f.nX,R.k0,b.W0,b.tN,b.D8,v.Kd,A.S,U,s.uU,Z.R]})}return i})(),V=(()=>{class i{constructor(e){this.gs=e}ngOnInit(){}static#t=this.\u0275fac=function(n){return new(n||i)(t.Y36(m.U))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-discussion"]],decls:2,vars:1,consts:[[3,"rootCommentBox"]],template:function(n,o){1&n&&t._UZ(0,"app-highlight")(1,"app-comment",0),2&n&&(t.xp6(1),t.Q6J("rootCommentBox",!0))},dependencies:[U,z]})}return i})()},4529:(M,y,r)=>{r.d(y,{R:()=>p});var t=r(6895),m=r(4006),C=r(3811),g=r(2314),T=r(5208),x=r(7619),a=r(4650);let p=(()=>{class s{static#t=this.\u0275fac=function(u){return new(u||s)};static#e=this.\u0275mod=a.oAB({type:s});static#n=this.\u0275inj=a.cJS({imports:[t.ez,m.u5,m.UX,g.m,C.T,x.C,T.d]})}return s})()},9736:(M,y,r)=>{r.d(y,{L:()=>p});var t=r(6895),m=r(2314),C=r(7299),g=r(4529),T=r(5208),x=r(3811),a=r(4650);let p=(()=>{class s{static#t=this.\u0275fac=function(u){return new(u||s)};static#e=this.\u0275mod=a.oAB({type:s});static#n=this.\u0275inj=a.cJS({imports:[t.ez,m.m,C.H,g.R,T.d,x.T]})}return s})()},7619:(M,y,r)=>{r.d(y,{C:()=>C});var t=r(6895),m=r(4650);let C=(()=>{class g{static#t=this.\u0275fac=function(a){return new(a||g)};static#e=this.\u0275mod=m.oAB({type:g});static#n=this.\u0275inj=m.cJS({imports:[t.ez]})}return g})()},1883:(M,y,r)=>{r.d(y,{S:()=>x});var t=r(5861),m=r(4650),C=r(9816),g=r(3322);let T=(()=>{class a{constructor(s,l){this.gs=s,this.bs=l,this.enabled=!0,this.kuroshiro=null,this.observer=null,this.ignoreNodes=[],this.gs.isBrowser&&(this.kuroshiro=new Kuroshiro,this.kuroshiro.init(new KuromojiAnalyzer({dictPath:"/assets/furigana/"})))}convert(s){return this.gs.log("[KUROSHIRO_CONVERT]",s),this.kuroshiro.convert(s,{mode:"furigana",to:"hiragana"})}replace(s,l){const _=this.gs.document?.createRange().createContextualFragment(l),u=[];return _.childNodes.forEach(f=>u.push(f)),s.parentNode?.replaceChild(_,s),u}convertAndReplace(s){var l=this;return(0,t.Z)(function*(){if(!l.enabled||l.bs.busyRequestCount>0||!s.nodeValue.trim()||"RUBY"===s.parentNode.nodeName||!s.nodeValue.match(/[\u3400-\u9FBF]/))return;const _=yield l.convert(s.nodeValue);l.ignoreNodes.push(...l.replace(s,_))})()}watch(s){if("childList"===s.type)for(const l of s.addedNodes)if(this.gs.log("[KUROSHIRO_NODE_WATCHER]",l),this.ignoreNodes.includes(l))this.ignoreNodes.splice(this.ignoreNodes.indexOf(l),1);else if(l instanceof Text)this.convertAndReplace(l);else{const _=[],u=this.gs.document?.createTreeWalker(l,NodeFilter.SHOW_TEXT,null);for(;u.nextNode();)_.push(u.currentNode);this.gs.log("[KUROSHIRO_NODE_WATCHER_LIST]",_);for(const f of _)this.convertAndReplace(f)}else"characterData"===s.type&&this.convertAndReplace(s.target)}static#t=this.\u0275fac=function(l){return new(l||a)(m.LFG(C.U),m.LFG(g.z))};static#e=this.\u0275prov=m.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"})}return a})(),x=(()=>{class a{constructor(s,l,_,u){var f=this;if(this.elementRef=s,this.gs=l,this.bs=_,this.furi=u,this.changes=null,this.domChange=new m.vpe,this.gs.isBrowser){const R=this.elementRef.nativeElement;this.gs.log("[DOM_NATIVE]",R),this.changes=new MutationObserver(function(){var b=(0,t.Z)(function*(v){f.bs.busyRequestCount>0||(f.gs.log("[DOM_CHANGE]",v),f.domChange.emit(v),f.processDom(v))});return function(v){return b.apply(this,arguments)}}()),this.changes.observe(R,{subtree:!0,childList:!0})}}ngOnDestroy(){this.changes?.disconnect()}processDom(s){for(const l of s)this.furi.watch(l)}static#t=this.\u0275fac=function(l){return new(l||a)(m.Y36(m.SBq),m.Y36(C.U),m.Y36(g.z),m.Y36(T))};static#e=this.\u0275dir=m.lG2({type:a,selectors:[["","appDomChange",""]],outputs:{domChange:"domChange"}})}return a})()},293:(M,y,r)=>{r.d(y,{k:()=>g});var t=r(4650),m=r(9222),C=r(9816);let g=(()=>{class T{constructor(a,p){this.api=a,this.gs=p}getAllComment(a="",p=1,s=10,l="",_=""){return this.api.getData(`/comment?q=${a}&page=${p}&row=${s}&sort=${l}&order=${_}`)}getComment(a="",p="",s=1,l=10,_="",u=""){return this.api.getData(`/comment?path=${a}&q=${p}&page=${s}&row=${l}&sort=${_}&order=${u}`)}getReply(a,p="",s=1,l=10,_="",u=""){return this.api.getData(`/comment/${a}?q=${p}&page=${s}&row=${l}&sort=${_}&order=${u}`)}sendComment(a){return this.api.postData("/comment",a)}getHighlight(a){return this.api.patchData("/comment",a)}deleteComment(a){return this.api.deleteData(`/comment/${a}`)}static#t=this.\u0275fac=function(p){return new(p||T)(t.LFG(m.s),t.LFG(C.U))};static#e=this.\u0275prov=t.Yz7({token:T,factory:T.\u0275fac,providedIn:"root"})}return T})()},4425:(M,y,r)=>{r.d(y,{TU:()=>g});var t=r(6895),m=r(4650);class C{constructor(s,l){this._document=l;const _=this._textarea=this._document.createElement("textarea"),u=_.style;u.position="fixed",u.top=u.opacity="0",u.left="-999em",_.setAttribute("aria-hidden","true"),_.value=s,_.readOnly=!0,this._document.body.appendChild(_)}copy(){const s=this._textarea;let l=!1;try{if(s){const _=this._document.activeElement;s.select(),s.setSelectionRange(0,s.value.length),l=this._document.execCommand("copy"),_&&_.focus()}}catch{}return l}destroy(){const s=this._textarea;s&&(s.remove(),this._textarea=void 0)}}let g=(()=>{class p{constructor(l){this._document=l}copy(l){const _=this.beginCopy(l),u=_.copy();return _.destroy(),u}beginCopy(l){return new C(l,this._document)}}return p.\u0275fac=function(l){return new(l||p)(m.LFG(t.K0))},p.\u0275prov=m.Yz7({token:p,factory:p.\u0275fac,providedIn:"root"}),p})()}}]);
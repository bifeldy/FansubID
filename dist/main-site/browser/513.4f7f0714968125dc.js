(self.webpackChunkmain_site=self.webpackChunkmain_site||[]).push([[513],{5513:(M,w,a)=>{"use strict";a.r(w),a.d(w,{TorrentModule:()=>kt});var c=a(6895),A=a(1390),L=a(4006),p=a(7340),I=a(6308),b=a(5558),D=a(4327),d=a(4674),t=a(4650),C=a(2972),y=a(4425),g=a(9816),S=a(5861),x=a(9076),U=a.n(x),Z=a(1135),W=a(8202),k=a(3172),s=a(9222),i=a(2693),u=a(5155);let h=(()=>{class n{constructor(e,o,r,_){if(this.gs=e,this.api=o,this.toast=r,this.ls=_,this.trackerAnnounce=d.N.torrent.trackerAnnounce,this.clientOptions={maxConns:64,tracker:{announce:this.trackerAnnounce,rtcConfig:{iceServers:d.N.torrent.iceServers}}},this.torrentsQueue={},this.torrentOptions={announce:this.trackerAnnounce,maxWebConns:16,store:U()},this.webClient=null,this.expandedRow=null,this.tableDataRowSubject=new Z.X([]),this.tableDataRow=this.tableDataRowSubject.asObservable(),this.error=null,this.refCallback=null,this.flagResurrected=!1,this.gs.isBrowser){const R=this.ls.getItem(this.gs.localStorageKeys.Torrents,!0);if(R)for(const[B,j]of Object.entries(R))this.torrentsQueue[B]=j;WebTorrent.WEBRTC_SUPPORT?(this.webClient=new WebTorrent(this.clientOptions),this.gs.log("[TORRENT_CLIENT_WEB_MODE_INITIALIZED]",this.webClient),this.handleWebClient()):this.toast.error("WebRTC Not Supported!","Whoops!",null,!0)}}get tableDataRowValue(){return this.tableDataRowSubject?.value||[]}checkHealthOnTracker(e){return this.api.postData("/torrent",e)}handleWebClient(){this.webClient.on("torrent",e=>{this.gs.log("[TORRENT_CLIENT_ADD_TORRENT_FILE]",e),this.toast.info(e.infoHash,"Woaw, Antrian Baru!",null,!0),this.tableDataRowValue.push(e),this.tableDataRowSubject.next(this.tableDataRowValue),this.refCallback&&this.refCallback(null,e)}),this.webClient.on("error",e=>{this.gs.log("[TORRENT_CLIENT_ERROR]",e,"error"),this.toast.error(e.toString(),"Whoops!",null,!0),this.error=e,this.refCallback&&this.refCallback(this.error,null)})}handleWebTorrent(e,o){e.on("done",()=>{this.gs.log("[TORRENT_FILE_DONE]",e),this.toast.success("Ada Torrent Yang Sudah Selesai Di Download","Yeay, Selesai!",null,!0),this.torrentsQueue[e.infoHash].completed=!0,this.ls.setItem(this.gs.localStorageKeys.Torrents,this.torrentsQueue),o&&o(null,null)}),e.on("warning",r=>{this.gs.log("[TORRENT_FILE_WARNING]",r),this.toast.info(r.toString(),"Yuhuu!",null,!0),o&&o(r,null)}),e.on("error",r=>{this.gs.log("[TORRENT_FILE_ERROR]",r,"error"),this.toast.error(r.toString(),"Whoops!",null,!0),o&&o(r,null)})}handleWebWire(e,o){this.gs.log("[TORRENT_WIRE_CONNECT]",e);let r=e.peerId||"Unknown!";e.remoteAddress&&e.remotePort&&(r=`${e.remoteAddress}:${e.remotePort}`),e.on("close",()=>{this.gs.log("[TORRENT_WIRE_DISCONNECT]",r),o&&o(null,e)}),o&&o(null,e)}resurrectFiles(e){var o=this;if(!this.flagResurrected){this.flagResurrected=!0;for(const r in this.torrentsQueue)this.gs.log("[TORRENT_CLIENT_QUEUE_RESURRECT]",this.torrentsQueue[r]),this.torrentsQueue[r].completed?(0,W.openDB)(this.torrentsQueue[r].indexedDb,1).then(function(){var _=(0,S.Z)(function*(R){const K=yield R.transaction("chunks","readonly").objectStore("chunks").getAll(),Bt=k.lW.concat(K),z=[];for(const Ht of o.torrentsQueue[r].files){const $=Ht;z.push(new File([Bt.slice($.offset,$.offset+$.length)],$.name))}o.uploadFiles(o.torrentsQueue[r].name,z,e)});return function(R){return _.apply(this,arguments)}}()).catch(_=>this.gs.log("[INDEXDB-OPEN_FAILED]",_,"error")):this.downloadFiles(this.torrentsQueue[r].infoHash,e,{...this.torrentOptions,name:this.torrentsQueue[r].name})}e(null,null)}processTorrent(e,o,r){e.on("wire",_=>this.handleWebWire(_,r)),this.torrentsQueue[e.infoHash]={completed:o,indexedDb:e.name+" - "+e.infoHash.slice(0,8),infoHash:e.infoHash,name:e.name,files:[]};for(const _ of e.files)this.torrentsQueue[e.infoHash].files.push({name:_.name,offset:_.offset,length:_.length});this.ls.setItem(this.gs.localStorageKeys.Torrents,this.torrentsQueue),this.handleWebTorrent(e,r)}downloadFiles(e,o,r=this.torrentOptions){this.gs.log("[TORRENT_CLIENT_QUEUE_DOWNLOAD]",e),this.refCallback=o,this.checkHealthOnTracker({magnetHash:e,trackTimeout:1234,trackList:d.N.torrent.trackerAnnounce,iceServers:d.N.torrent.iceServers}).subscribe({next:_=>{this.gs.log("[TORRENT_CLIENT_HEALTH_SUCCESS]",_.result),_.result.seeds<=0?(this.toast.info("Tidak Ada Seeder!","Whoops!",null,!0),o&&o(null,_.result)):this.webClient.add(e,r,R=>{this.gs.log("[TORRENT_FILE_DOWNLOAD_READY]",R),this.toast.info("Memulai Download ...","Download!",null,!0),this.processTorrent(R,!1,o)})},error:_=>{this.gs.log("[TORRENT_CLIENT_HEALTH_ERROR]",_,"error"),o&&o(_,null)}})}uploadFiles(e,o,r){this.gs.log("[TORRENT_CLIENT_QUEUE_UPLOAD]",o),this.gs.log("[TORRENT_CLIENT_QUEUE_UPLOAD]",e),this.refCallback=r,this.webClient.seed(o,{...this.torrentOptions,name:e},_=>{this.gs.log("[TORRENT_FILE_SEED_READY]",_),this.toast.info("Memulai Seeding ...","Seeding",null,!0),this.processTorrent(_,!0,r)})}removeTorrent(e,o,r=!0){this.tableDataRowSubject.next(this.tableDataRowValue.filter(_=>_.infoHash!==e)),this.webClient.remove(e,{destroyStore:!0},_=>{_&&this.gs.log("[TORRENT_FILE_REMOVE_ERROR]",_,"error"),delete this.torrentsQueue[e],r&&this.ls.setItem(this.gs.localStorageKeys.Torrents,this.torrentsQueue),o&&o(_)})}pauseTorrent(e,o){const r=this.webClient.get(e);r&&(r.pause(),o&&o(r))}resumeTorrent(e,o){const r=this.webClient.get(e);r&&(r.resume(),o&&o(r))}removeAll(){for(const e of this.webClient.torrents)this.removeTorrent(e.infoHash,o=>{o||this.gs.log("[TORRENT_FILE_REMOVE_SUCCESS]",e.infoHash)},!1)}static#t=this.\u0275fac=function(o){return new(o||n)(t.LFG(g.U),t.LFG(s.s),t.LFG(i.k),t.LFG(u.n))};static#e=this.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var m=a(2970),O=a(7396),T=a(3322);let l=(()=>{class n{constructor(){this.fileDropped=new t.vpe}onDragOver(e){e.preventDefault(),e.stopPropagation(),this.fileOver=!0}onDragLeave(e){e.preventDefault(),e.stopPropagation(),this.fileOver=!1}ondrop(e){e.preventDefault(),e.stopPropagation(),this.fileOver=!1;let o=e.dataTransfer.files;o.length>0&&this.fileDropped.emit(o)}static#t=this.\u0275fac=function(o){return new(o||n)};static#e=this.\u0275dir=t.lG2({type:n,selectors:[["","appDragDrop",""]],hostVars:2,hostBindings:function(o,r){1&o&&t.NdJ("dragover",function(R){return r.onDragOver(R)})("dragleave",function(R){return r.onDragLeave(R)})("drop",function(R){return r.ondrop(R)}),2&o&&t.ekj("fileover",r.fileOver)},outputs:{fileDropped:"fileDropped"}})}return n})();var f=a(4758),v=a(9818),P=a(7392),F=a(8455),H=a(9203),N=a(9982),Q=a(1256),G=a(7462),Y=a(7443);function J(n,E){1&n&&t._UZ(0,"mat-progress-bar",27)}function V(n,E){1&n&&(t.TgZ(0,"span"),t._uU(1,"\u{1f516} NAME"),t.qZA()),2&n&&t.Udp("color","#ff4081")}function X(n,E){1&n&&(t.TgZ(0,"span"),t._uU(1,"\u{1f4be} SIZE"),t.qZA()),2&n&&t.Udp("color","#ff4081")}function q(n,E){1&n&&(t.TgZ(0,"span"),t._uU(1,"\u{1f4bf} DOWNLOADED"),t.qZA()),2&n&&t.Udp("color","#ff4081")}function tt(n,E){1&n&&(t.TgZ(0,"span"),t._uU(1,"\u{1f4c0} UPLOADED"),t.qZA()),2&n&&t.Udp("color","#ff4081")}function et(n,E){1&n&&(t.TgZ(0,"span"),t._uU(1,"\u{1f504} PROGRESS"),t.qZA()),2&n&&t.Udp("color","#ff4081")}function nt(n,E){1&n&&(t.TgZ(0,"span"),t._uU(1,"\u{1f53d} SPEED"),t.qZA()),2&n&&t.Udp("color","#ff4081")}function ot(n,E){1&n&&(t.TgZ(0,"span"),t._uU(1,"\u{1f53c} SPEED"),t.qZA()),2&n&&t.Udp("color","#ff4081")}function rt(n,E){1&n&&(t.TgZ(0,"span"),t._uU(1,"\u{1f551} ~ETA."),t.qZA()),2&n&&t.Udp("color","#ff4081")}function it(n,E){1&n&&(t.TgZ(0,"span"),t._uU(1,"\u{1f9f2} PEERS"),t.qZA()),2&n&&t.Udp("color","#ff4081")}function st(n,E){1&n&&(t.TgZ(0,"span"),t._uU(1,"\u{1f310} RATIO"),t.qZA()),2&n&&t.Udp("color","#ff4081")}function at(n,E){if(1&n&&(t.TgZ(0,"th",31)(1,"h3",32),t.YNc(2,V,2,2,"span",33),t.YNc(3,X,2,2,"span",33),t.YNc(4,q,2,2,"span",33),t.YNc(5,tt,2,2,"span",33),t.YNc(6,et,2,2,"span",33),t.YNc(7,nt,2,2,"span",33),t.YNc(8,ot,2,2,"span",33),t.YNc(9,rt,2,2,"span",33),t.YNc(10,it,2,2,"span",33),t.YNc(11,st,2,2,"span",33),t.qZA()()),2&n){const e=t.oxw().$implicit;t.xp6(2),t.Q6J("ngIf","NAME"===e.toUpperCase()),t.xp6(1),t.Q6J("ngIf","LENGTH"===e.toUpperCase()),t.xp6(1),t.Q6J("ngIf","DOWNLOADED"===e.toUpperCase()),t.xp6(1),t.Q6J("ngIf","UPLOADED"===e.toUpperCase()),t.xp6(1),t.Q6J("ngIf","PROGRESS"===e.toUpperCase()),t.xp6(1),t.Q6J("ngIf","DOWNLOADSPEED"===e.toUpperCase()),t.xp6(1),t.Q6J("ngIf","UPLOADSPEED"===e.toUpperCase()),t.xp6(1),t.Q6J("ngIf","TIMEREMAINING"===e.toUpperCase()),t.xp6(1),t.Q6J("ngIf","NUMPEERS"===e.toUpperCase()),t.xp6(1),t.Q6J("ngIf","RATIO"===e.toUpperCase())}}function ct(n,E){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&n){const e=t.oxw().$implicit,o=t.oxw().$implicit;t.xp6(1),t.Oqu(e[o])}}function lt(n,E){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"bytes"),t.qZA()),2&n){const e=t.oxw().$implicit,o=t.oxw().$implicit;t.xp6(1),t.Oqu(t.lcZ(2,1,e[o]))}}function ut(n,E){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"bytes"),t.qZA()),2&n){const e=t.oxw().$implicit,o=t.oxw().$implicit;t.xp6(1),t.Oqu(t.lcZ(2,1,e[o]))}}function pt(n,E){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"bytes"),t.qZA()),2&n){const e=t.oxw().$implicit,o=t.oxw().$implicit;t.xp6(1),t.Oqu(t.lcZ(2,1,e[o]))}}function dt(n,E){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"number"),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.hij("",t.xi3(2,1,e.downloaded/e.length*100,"1.2-2")," %")}}function ft(n,E){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"bytes"),t.qZA()),2&n){const e=t.oxw().$implicit,o=t.oxw().$implicit;t.xp6(1),t.hij("",t.lcZ(2,1,e[o]),"/s")}}function ht(n,E){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"bytes"),t.qZA()),2&n){const e=t.oxw().$implicit,o=t.oxw().$implicit;t.xp6(1),t.hij("",t.lcZ(2,1,e[o]),"/s")}}function _t(n,E){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"number"),t.qZA()),2&n){const e=t.oxw().$implicit,o=t.oxw().$implicit;t.xp6(1),t.Oqu(e[o]<=0?"COMPLETED":t.xi3(2,1,e[o]/1e3,"1.0-0")+" s")}}function mt(n,E){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&n){const e=t.oxw().$implicit,o=t.oxw().$implicit;t.xp6(1),t.Oqu(e[o])}}function gt(n,E){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"number"),t.qZA()),2&n){const e=t.oxw().$implicit,o=t.oxw().$implicit;t.xp6(1),t.Oqu(t.xi3(2,1,e[o],"1.4-4"))}}function Tt(n,E){if(1&n&&(t.TgZ(0,"td",34)(1,"h3"),t.YNc(2,ct,2,1,"span",35),t.YNc(3,lt,3,3,"span",35),t.YNc(4,ut,3,3,"span",35),t.YNc(5,pt,3,3,"span",35),t.YNc(6,dt,3,4,"span",35),t.YNc(7,ft,3,3,"span",35),t.YNc(8,ht,3,3,"span",35),t.YNc(9,_t,3,4,"span",35),t.YNc(10,mt,2,1,"span",35),t.YNc(11,gt,3,4,"span",35),t.qZA()()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.Gre("m-0 ","NAME"===e.toUpperCase()?"text-start":"",""),t.xp6(1),t.Q6J("ngIf","NAME"===e.toUpperCase()),t.xp6(1),t.Q6J("ngIf","LENGTH"===e.toUpperCase()),t.xp6(1),t.Q6J("ngIf","DOWNLOADED"===e.toUpperCase()),t.xp6(1),t.Q6J("ngIf","UPLOADED"===e.toUpperCase()),t.xp6(1),t.Q6J("ngIf","PROGRESS"===e.toUpperCase()),t.xp6(1),t.Q6J("ngIf","DOWNLOADSPEED"===e.toUpperCase()),t.xp6(1),t.Q6J("ngIf","UPLOADSPEED"===e.toUpperCase()),t.xp6(1),t.Q6J("ngIf","TIMEREMAINING"===e.toUpperCase()),t.xp6(1),t.Q6J("ngIf","NUMPEERS"===e.toUpperCase()),t.xp6(1),t.Q6J("ngIf","RATIO"===e.toUpperCase())}}function Ct(n,E){1&n&&(t.ynx(0,28),t.YNc(1,at,12,10,"th",29),t.YNc(2,Tt,12,13,"td",30),t.BQk()),2&n&&t.s9C("matColumnDef",E.$implicit)}function vt(n,E){if(1&n&&(t.TgZ(0,"p",42),t._uU(1," Info Hash :: "),t.TgZ(2,"span",54),t._uU(3),t.qZA()()),2&n){const e=t.oxw().$implicit;t.xp6(3),t.hij(" ",e.infoHash," ")}}function Et(n,E){if(1&n){const e=t.EpF();t.TgZ(0,"p",42),t._uU(1," Magnet URI :: "),t.TgZ(2,"span",55),t.NdJ("click",function(){t.CHM(e);const r=t.oxw().$implicit,_=t.oxw();return t.KtG(_.copyMagnetHashToClipboard(r.magnetURI))}),t._uU(3),t.qZA()()}if(2&n){const e=t.oxw().$implicit;t.xp6(3),t.hij(" ",e.magnetURI," ")}}function xt(n,E){if(1&n&&(t.TgZ(0,"li"),t._uU(1),t.qZA()),2&n){const e=E.$implicit;t.xp6(1),t.hij(" ",e," ")}}function Dt(n,E){if(1&n){const e=t.EpF();t.TgZ(0,"button",46),t.NdJ("click",function(){t.CHM(e);const r=t.oxw().$implicit,_=t.oxw();return t.KtG(_.resumeTorrent(r))}),t._UZ(1,"mat-icon",56),t._uU(2," Resume "),t.qZA()}}function yt(n,E){if(1&n){const e=t.EpF();t.TgZ(0,"button",46),t.NdJ("click",function(){t.CHM(e);const r=t.oxw().$implicit,_=t.oxw();return t.KtG(_.pauseTorrent(r))}),t._UZ(1,"mat-icon",57),t._uU(2," Pause "),t.qZA()}}function bt(n,E){if(1&n){const e=t.EpF();t.TgZ(0,"mat-list-option",58),t._UZ(1,"mat-icon",59),t.TgZ(2,"div",60),t.NdJ("click",function(){const _=t.CHM(e).$implicit,R=t.oxw(2);return t.KtG(R.saveFile(_))}),t.TgZ(3,"span"),t._uU(4),t.qZA(),t._uU(5," -- "),t.TgZ(6,"span",61),t._uU(7),t.ALo(8,"number"),t.qZA(),t._uU(9," :: "),t.TgZ(10,"span",54),t._uU(11),t.ALo(12,"bytes"),t.ALo(13,"bytes"),t.qZA()()()}if(2&n){const e=E.$implicit;t.xp6(3),t.Gre("text-",e.downloaded/e.length>=1?"primary":"bifeldy",""),t.xp6(1),t.hij(" ",e.name," "),t.xp6(3),t.hij(" ",t.xi3(8,7,e.downloaded/e.length*100,"1.2-2")," % "),t.xp6(4),t.AsE(" ",t.lcZ(12,10,e.downloaded)," / ",t.lcZ(13,12,e.length)," ")}}function Rt(n,E){if(1&n){const e=t.EpF();t.TgZ(0,"td",36)(1,"div",37)(2,"div",38)(3,"div",39),t._UZ(4,"div"),t.qZA(),t.TgZ(5,"div",40),t.YNc(6,vt,4,1,"p",41),t.YNc(7,Et,4,1,"p",41),t.TgZ(8,"div",42),t._uU(9," Announce Trackers :: "),t.TgZ(10,"ul",43),t.YNc(11,xt,2,1,"li",44),t.qZA()(),t.TgZ(12,"div",45)(13,"button",46),t.NdJ("click",function(){const _=t.CHM(e).$implicit,R=t.oxw();return t.KtG(R.refreshGraph(_))}),t._UZ(14,"mat-icon",47),t._uU(15," Refresh Graph "),t.qZA(),t.TgZ(16,"button",46),t.NdJ("click",function(){const _=t.CHM(e).$implicit,R=t.oxw();return t.KtG(R.removeTorrent(_))}),t._UZ(17,"mat-icon",48),t._uU(18," Remove "),t.qZA(),t.YNc(19,Dt,3,0,"button",49),t.YNc(20,yt,3,0,"button",49),t.qZA(),t.TgZ(21,"div",50)(22,"div",51),t._uU(23,"Rincian Isi Berkas \u2728"),t.qZA(),t.TgZ(24,"mat-selection-list",52),t.YNc(25,bt,14,14,"mat-list-option",53),t.qZA()()()()()()}if(2&n){const e=E.$implicit,o=t.oxw();t.uIk("colspan",o.tableDataColumn.length),t.xp6(1),t.Q6J("@detailExpand",e===o.TORRENT.expandedRow?"expanded":"collapsed"),t.xp6(3),t.Gre("p2p-graph graphP2p-",e.infoHash,""),t.xp6(2),t.Q6J("ngIf",e.infoHash),t.xp6(1),t.Q6J("ngIf",e.magnetURI),t.xp6(4),t.Q6J("ngForOf",e.announce),t.xp6(8),t.Q6J("ngIf",e.paused),t.xp6(1),t.Q6J("ngIf",!e.paused),t.xp6(4),t.Q6J("multiple",!1),t.xp6(1),t.Q6J("ngForOf",e.files)}}function Ot(n,E){1&n&&t._UZ(0,"tr",62)}function wt(n,E){if(1&n){const e=t.EpF();t.TgZ(0,"tr",63),t.NdJ("click",function(){const _=t.CHM(e).$implicit,R=t.oxw();return t.KtG(R.toggleExpanded(_))}),t.qZA()}if(2&n){const e=E.$implicit,o=t.oxw();t.ekj("expanded-row",o.TORRENT.expandedRow===e)}}function Lt(n,E){1&n&&t._UZ(0,"tr",64)}function At(n,E){if(1&n&&(t.TgZ(0,"tr",65)(1,"td",66)(2,"div",67)(3,"div",68)(4,"h3",32),t._uU(5," Tidak Ada Data \xaf\\_(\u30c4)_/\xaf "),t.qZA()()()()()),2&n){const e=t.oxw();t.xp6(1),t.uIk("colspan",e.tableDataColumn.length)}}const It=function(){return["expandedDetail"]};let Nt=(()=>{class n{constructor(e,o,r,_,R,B,j,K){this.snackBar=e,this.clipboard=o,this.gs=r,this.torrent=_,this.toast=R,this.ds=B,this.ss=j,this.bs=K,this.isProcessing=!1,this.magnetHash=null,this.torrentsGraph={},this.tableDataColumn=["name","length","downloaded","uploaded","progress","downloadSpeed","uploadSpeed","timeRemaining","numPeers","ratio"],this.files=[],this.subsDialog=null,this.subsUser=null,this.subsTableDataRow=null,this.gs.bannerImg=null,this.gs.sizeContain=!1,this.gs.bgRepeat=!1}get ENV(){return d.N}get TORRENT(){return this.torrent}ngOnInit(){this.dataSource=new b.r4,this.gs.isBrowser&&(this.dataSource.sort=this.sort,this.subsTableDataRow=this.torrent.tableDataRow.subscribe({next:e=>{this.dataSource.data=e,this.refreshAllGraph()}}),this.reviveTorrent())}ngOnDestroy(){this.sort?.sortChange?.unsubscribe(),this.subsDialog?.unsubscribe(),this.subsUser?.unsubscribe(),this.subsTableDataRow?.unsubscribe()}copyMagnetHashToClipboard(e){this.clipboard.copy(e)&&this.snackBar.open("Magnet Link Hash :: Telah Di Salin Pada Clipboard","OK")}toggleExpanded(e){this.gs.log("[TORRENT_CLICKED]",e),this.torrent.expandedRow=this.torrent.expandedRow===e?null:e,this.refreshGraph(e)}saveFile(e){e.downloaded/e.length>=1?(this.bs.busy(),e.getBlobURL((o,r)=>{o||(this.gs.log("[TORRENT_FILE_BLOBURL]",r),(0,D.saveAs)(r,e.name),this.bs.idle())})):this.toast.info("Berkas Sedang Dalam Proses Unduhan!","Yah, File Belum Siap!",null,!0)}reviveTorrent(){this.bs.busy(),this.torrent.resurrectFiles((e,o)=>{this.refreshAllGraph(),this.bs.idle()})}resumeTorrent(e){this.torrent.resumeTorrent(e.infoHash,o=>{this.refreshAllGraph()})}pauseTorrent(e){this.torrent.pauseTorrent(e.infoHash,o=>{o||this.gs.log("[TORRENT_FILE_PAUSE_SUCCESS]",e.infoHash),this.refreshAllGraph()})}removeTorrent(e){this.torrent.removeTorrent(e.infoHash,o=>{o||this.gs.log("[TORRENT_FILE_REMOVE_SUCCESS]",e.infoHash),this.torrentsGraph[e.infoHash].destroy(),delete this.torrentsGraph[e.infoHash],this.refreshAllGraph()})}downloadFiles(e){this.isProcessing=!0,this.torrent.downloadFiles(this.magnetHash,(o,r)=>{this.magnetHash=null,this.isProcessing=!1,this.refreshAllGraph()})}uploadFiles(e){this.gs.log("[TORRENT_SEED_USER_INFORMATION]",e),this.isProcessing=!0,this.torrent.uploadFiles(e,this.files,(o,r)=>{this.isProcessing=!1,this.refreshAllGraph()})}prepareFilesList(e){this.files=[];for(const r of e)this.files.push(r);const o={torrent_name:{inputLabel:"Nama Torrent",inputPlaceholder:`Torrent # ${this.ss.mySocket.id} @ ${(new Date).toUTCString()}`,inputValue:null,inputRequired:!0}};1===this.files.length?(o.torrent_name.inputPlaceholder=this.files[0].name,this.uploadFiles(o.torrent_name.inputPlaceholder)):this.files.length>1&&(this.subsDialog=this.ds.openInputDialog({data:{title:"Silahkan Masukkan Nama Untuk Torrent Kamu!",input:o,confirmText:"Ya, Mulai SEED",cancelText:"Tidak, Batal"}}).afterClosed().subscribe({next:r=>{this.gs.log("[INPUT_DIALOG_CLOSED]",r),r&&this.uploadFiles(r.torrent_name),this.subsDialog.unsubscribe()}}))}onFileDropped(e){this.prepareFilesList(e)}fileBrowseHandler(e){this.prepareFilesList(e.target.files)}initGraph(e){!this.torrentsGraph[e.infoHash]&&this.dataSource.data.length>0&&(this.gs.log("[TORRENT_WIRE_INIT_GRAPH]",e),this.torrentsGraph[e.infoHash]=new P2PGraph(`.graphP2p-${e.infoHash}`),this.torrentsGraph[e.infoHash].add({id:this.torrent.webClient.peerId,me:!0,name:"Kamu!"}))}addAllGraph(e){this.gs.log("[TORRENT_WIRE_RELOAD_GRAPH]",e);for(const o of e.wires){let r=o.peerId||"Anonim!";o.remoteAddress&&o.remotePort&&(r=`${o.remoteAddress}:${o.remotePort}`),this.torrentsGraph[e.infoHash].add({id:o.peerId,name:r}),this.torrentsGraph[e.infoHash].connect(this.torrent.webClient.peerId,o.peerId)}}deleteAllGraph(e){this.gs.log("[TORRENT_WIRE_DELETE_GRAPH]",e);const o=this.torrentsGraph[e.infoHash].list().filter(r=>r.id!==this.torrent.webClient.peerId);for(const r of o)this.torrentsGraph[e.infoHash].disconnect(this.torrent.webClient.peerId,r.id),this.torrentsGraph[e.infoHash].remove(r.id)}refreshGraph(e){this.gs.log("[TORRENT_WIRE_REFRESH_GRAPH]",e),this.torrentsGraph[e.infoHash]?(this.deleteAllGraph(e),this.addAllGraph(e)):this.initGraph(e)}refreshAllGraph(){for(const e of this.dataSource.data)setTimeout(()=>{this.refreshGraph(e)},1234)}static#t=this.\u0275fac=function(o){return new(o||n)(t.Y36(C.pl),t.Y36(y.TU),t.Y36(g.U),t.Y36(h),t.Y36(i.k),t.Y36(m.x),t.Y36(O.R),t.Y36(T.z))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["app-torrent"]],viewQuery:function(o,r){if(1&o&&t.Gf(I.YE,7),2&o){let _;t.iGM(_=t.CRH())&&(r.sort=_.first)}},decls:35,vars:13,consts:[["appDragDrop","",1,"h-100",3,"fileDropped"],[1,"container"],[1,"row","pb-3","px-0"],[1,"col-12"],[1,"row"],[1,"col-12","sticky-top","bg-bifeldy"],[1,"pt-3","border-bottom-dotted"],[1,"text-bifeldy"],["hintLabel","Isi Lalu Tekan 'Enter' Untuk Mencari Torrent ...",1,"col-12","col-md-6","col-lg-4","px-3","mb-3",3,"color"],["matInput","","placeholder","Ex. magnet:123qwe...!@#",3,"ngModel","disabled","keyup.enter","ngModelChange"],["input",""],["fontIcon","cloud_download","matSuffix",""],["color","warn","mode","indeterminate",4,"ngIf"],[1,"row","mx-2"],[1,"col-12",2,"overflow-x","auto"],["mat-table","","matSort","","multiTemplateDataRows","",1,"bg-transparent",3,"dataSource"],[3,"matColumnDef",4,"ngFor","ngForOf"],["matColumnDef","expandedDetail"],["mat-cell","",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","","class","element-row",3,"expanded-row","click",4,"matRowDef","matRowDefColumns"],["mat-row","","class","detail-row",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["type","file","id","fileDropRef","multiple","",2,"visibility","hidden",3,"disabled","change"],["fileDropRef",""],["type","button","mat-fab","","color","warn","matTooltip","Seed Berkas",1,"me-3","mb-5","fab-button","animate__animated","animate__bounce","animate__infinite","animate__slow",2,"position","fixed","bottom","0","right","0",3,"disabled","click"],["fontIcon","cloud_upload"],["color","warn","mode","indeterminate"],[3,"matColumnDef"],["mat-header-cell","","class","px-3 text-center","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","","class","px-3 text-center","style","cursor: pointer;",4,"matCellDef"],["mat-header-cell","","mat-sort-header","",1,"px-3","text-center"],[1,"m-0"],[3,"color",4,"ngIf"],["mat-cell","",1,"px-3","text-center",2,"cursor","pointer"],[4,"ngIf"],["mat-cell",""],[1,"element-detail"],[1,"py-3","row"],[1,"col-3"],[1,"col-9"],["class","px-2 text-truncate",4,"ngIf"],[1,"px-2","text-truncate"],[1,"text-success","m-0"],[4,"ngFor","ngForOf"],[1,"p-2"],["type","button","mat-stroked-button","",1,"m-1","text-warning",3,"click"],["fontIcon","refresh",1,"me-1"],["fontIcon","delete_outline",1,"me-1"],["type","button","mat-stroked-button","","class","m-1 text-warning",3,"click",4,"ngIf"],[1,"px-2"],["mat-subheader","",1,"p-0"],[3,"multiple"],["class","h-100",4,"ngFor","ngForOf"],[1,"text-success"],["matTooltip","Klik Untuk Menyalin!",1,"text-primary","text-decoration-none",3,"click"],["fontIcon","play_arrow",1,"me-1"],["fontIcon","pause",1,"me-1"],[1,"h-100"],["fontIcon","file_present","mat-list-icon","",1,"ps-3"],[2,"cursor","pointer",3,"click"],[1,"text-warning"],["mat-header-row",""],["mat-row","",1,"element-row",3,"click"],["mat-row","",1,"detail-row"],[1,"mat-row"],[1,"mat-cell","text-center","align-items-center","p-0",2,"background-image","url('/assets/img/404/no-data.png')","background-size","contain","background-position","center","background-repeat","no-repeat","height","256px"],[1,"row","align-items-center","h-100"],[1,"col-8","mx-auto","text-light","text-center","rounded","py-3",2,"background-color","rgba(128, 128, 128, 0.875)"]],template:function(o,r){if(1&o){const _=t.EpF();t.TgZ(0,"div",0),t.NdJ("fileDropped",function(B){return r.onFileDropped(B)}),t._UZ(1,"app-notifications"),t.TgZ(2,"div",1)(3,"div",2)(4,"div",3)(5,"div",4)(6,"div",5)(7,"h2",6)(8,"b",7),t._uU(9,"Web-SocketRTC Torrent"),t.qZA()()(),t.TgZ(10,"div",3)(11,"mat-form-field",8)(12,"mat-label"),t._uU(13,"Unduh Dari Info Hash / Magnet URI"),t.qZA(),t.TgZ(14,"input",9,10),t.NdJ("keyup.enter",function(B){return r.downloadFiles(B)})("ngModelChange",function(B){return r.magnetHash=B}),t.qZA(),t._UZ(16,"mat-icon",11),t.YNc(17,J,1,0,"mat-progress-bar",12),t.qZA(),t.TgZ(18,"div",13)(19,"div",14)(20,"table",15),t.YNc(21,Ct,3,1,"ng-container",16),t.ynx(22,17),t.YNc(23,Rt,26,12,"td",18),t.BQk(),t.YNc(24,Ot,1,0,"tr",19),t.YNc(25,wt,1,2,"tr",20),t.YNc(26,Lt,1,0,"tr",21),t.YNc(27,At,6,1,"tr",22),t.qZA()(),t.TgZ(28,"div",3)(29,"marquee"),t._uU(30),t.qZA()()()()()()()(),t.TgZ(31,"input",23,24),t.NdJ("change",function(B){return r.fileBrowseHandler(B)}),t.qZA(),t.TgZ(33,"button",25),t.NdJ("click",function(){t.CHM(_);const B=t.MAs(32);return t.KtG(B.click())}),t._UZ(34,"mat-icon",26),t.qZA()()}2&o&&(t.xp6(11),t.Q6J("color","accent"),t.xp6(3),t.Q6J("ngModel",r.magnetHash)("disabled",r.isProcessing),t.xp6(3),t.Q6J("ngIf",r.isProcessing),t.xp6(3),t.Q6J("dataSource",r.dataSource),t.xp6(1),t.Q6J("ngForOf",r.tableDataColumn),t.xp6(3),t.Q6J("matHeaderRowDef",r.tableDataColumn),t.xp6(1),t.Q6J("matRowDefColumns",r.tableDataColumn),t.xp6(1),t.Q6J("matRowDefColumns",t.DdM(12,It)),t.xp6(4),t.hij("Terhubung Dengan Tracker :: ",r.ENV.torrent.trackerAnnounce.join(" :: "),""),t.xp6(1),t.Q6J("disabled",r.isProcessing),t.xp6(2),t.Q6J("disabled",r.isProcessing))},dependencies:[c.sg,c.O5,L.Fj,L.JJ,L.On,l,f.t,v.eB,P.Hw,F.v_,F.$V,F.nX,H.k0,N.ap,N.Sc,N.kh,N.O$,Q.eI,b.ty,b.wO,b.S4,b.t3,b.R3,b.Al,b.L7,b.ML,b.fg,b.Zw,b.ZB,G.Kd,I.YE,I.nU,c.JJ,Y.$],styles:[".p2p-graph[_ngcontent-%COMP%]{background-color:#8d8d8d80!important}tr.detail-row[_ngcontent-%COMP%]{height:0}tr.element-row[_ngcontent-%COMP%]:not(.expanded-row):hover{background-color:#ffffffdf}.element-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-bottom-width:0}.element-detail[_ngcontent-%COMP%]{overflow:hidden;display:flex}.fileover[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_shake 1s;animation-iteration-count:infinite}@keyframes _ngcontent-%COMP%_shake{0%{transform:translate(1px,1px) rotate(0)}10%{transform:translate(-1px,-2px) rotate(-1deg)}20%{transform:translate(-3px) rotate(1deg)}30%{transform:translate(3px,2px) rotate(0)}40%{transform:translate(1px,-1px) rotate(1deg)}50%{transform:translate(-1px,2px) rotate(-1deg)}60%{transform:translate(-3px,1px) rotate(0)}70%{transform:translate(3px,1px) rotate(-1deg)}80%{transform:translate(-1px,-1px) rotate(1deg)}90%{transform:translate(1px,2px) rotate(0)}to{transform:translate(1px,-2px) rotate(-1deg)}}"],data:{animation:[(0,p.X$)("detailExpand",[(0,p.SB)("collapsed",(0,p.oB)({height:"0px",minHeight:"0"})),(0,p.SB)("expanded",(0,p.oB)({height:"*"})),(0,p.eR)("expanded <=> collapsed",(0,p.jt)("225ms cubic-bezier(0.4, 0.0, 0.2, 1)"))])]}})}return n})();var Ut=a(2314),Mt=a(3811),Zt=a(6319),Pt=a(6533),St=a(7619);const Ft=[{path:"",pathMatch:"full",component:Nt}];let kt=(()=>{class n{static#t=this.\u0275fac=function(o){return new(o||n)};static#e=this.\u0275mod=t.oAB({type:n});static#n=this.\u0275inj=t.cJS({imports:[c.ez,A.Bz.forChild(Ft),L.u5,St.C,Zt.F,Ut.m,Pt.P,Mt.T]})}return n})()},6533:(M,w,a)=>{"use strict";a.d(w,{P:()=>p});var c=a(6895),A=a(2314),L=a(4650);let p=(()=>{class I{static#t=this.\u0275fac=function(d){return new(d||I)};static#e=this.\u0275mod=L.oAB({type:I});static#n=this.\u0275inj=L.cJS({imports:[c.ez,A.m]})}return I})()},4758:(M,w,a)=>{"use strict";a.d(w,{t:()=>y});var c=a(4650),A=a(1390),L=a(9816),p=a(8598),I=a(6895),b=a(5882);function D(g,S){if(1&g&&c._UZ(0,"div",4),2&g){const x=c.oxw();c.Udp("background-size",x.GS.sizeContain?"contain":"cover")("background-image","url("+x.GS.bannerImg+")")("background-repeat",x.GS.bgRepeat?"repeat-x":"no-repeat")("height",x.ROUTER.url.startsWith("/news")||x.ROUTER.url.startsWith("/berkas")||x.ROUTER.url.startsWith("/search")||x.ROUTER.url.startsWith("/fansub")?"192px":"128px")("background-position-y",x.ROUTER.url.startsWith("/berkas")||x.ROUTER.url.startsWith("/search")?"22.5%":"")}}function d(g,S){if(1&g&&(c.TgZ(0,"strong",10),c._uU(1," -- "),c.TgZ(2,"i")(3,"a",11),c._uU(4),c.qZA()()()),2&g){const x=c.oxw().$implicit;c.xp6(3),c.MGl("routerLink","/user/",x.notifCreator,""),c.xp6(1),c.hij(" ",x.notifCreator," ")}}function t(g,S){if(1&g){const x=c.EpF();c.TgZ(0,"button",12),c.NdJ("click",function(){c.CHM(x);const Z=c.oxw().$implicit,W=c.oxw();return c.KtG(W.removeNotif(Z.notifData.id))}),c.qZA()}}function C(g,S){if(1&g&&(c.TgZ(0,"div",5)(1,"div")(2,"strong",6),c._uU(3),c.qZA(),c._UZ(4,"span",7),c.ALo(5,"safeInnerHtml"),c.YNc(6,d,5,2,"strong",8),c.YNc(7,t,1,0,"button",9),c.qZA()()),2&g){const x=S.$implicit;c.xp6(1),c.Gre("alert alert-",x.notifData.type," alert-dismissible fade show"),c.xp6(2),c.Oqu(x.notifData.title),c.xp6(1),c.Q6J("innerHTML",c.lcZ(5,7,x.notifData.content),c.oJD),c.xp6(2),c.Q6J("ngIf",x.notifCreator),c.xp6(1),c.Q6J("ngIf",x.notifData.dismissible)}}let y=(()=>{class g{constructor(x,U,Z){this.router=x,this.gs=U,this.notif=Z}ngOnInit(){}get GS(){return this.gs}get ROUTER(){return this.router}get NOTIF(){return this.notif}removeNotif(x){this.notif.removeNotif(x)}static#t=this.\u0275fac=function(U){return new(U||g)(c.Y36(A.F0),c.Y36(L.U),c.Y36(p.T))};static#e=this.\u0275cmp=c.Xpm({type:g,selectors:[["app-notifications"]],decls:4,vars:2,consts:[["class","container-fluid notif-banner align-items-center",3,"background-size","background-image","background-repeat","height","background-position-y",4,"ngIf"],[1,"container"],[1,"row","pt-3"],["class","col-12",4,"ngFor","ngForOf"],[1,"container-fluid","notif-banner","align-items-center"],[1,"col-12"],[1,"me-1"],[3,"innerHTML"],["class","ms-1",4,"ngIf"],["type","button","class","btn-close","data-dismiss","alert",3,"click",4,"ngIf"],[1,"ms-1"],[1,"text-decoration-none",3,"routerLink"],["type","button","data-dismiss","alert",1,"btn-close",3,"click"]],template:function(U,Z){1&U&&(c.YNc(0,D,1,10,"div",0),c.TgZ(1,"div",1)(2,"div",2),c.YNc(3,C,8,9,"div",3),c.qZA()()),2&U&&(c.Q6J("ngIf",Z.GS.bannerImg&&(Z.ROUTER.url.startsWith("/news")||Z.ROUTER.url.startsWith("/berkas")||Z.ROUTER.url.startsWith("/search")||Z.ROUTER.url.startsWith("/fansub")||Z.ROUTER.url.startsWith("/anime")||Z.ROUTER.url.startsWith("/dorama"))),c.xp6(3),c.Q6J("ngForOf",Z.NOTIF.notifications))},dependencies:[I.sg,I.O5,A.rH,b.H],styles:[".notif-banner[_ngcontent-%COMP%]{width:100%;background-size:cover;background-position:75% 50%}"]})}return g})()},6319:(M,w,a)=>{"use strict";a.d(w,{F:()=>I});var c=a(6895),A=a(1390),L=a(3811),p=a(4650);let I=(()=>{class b{static#t=this.\u0275fac=function(t){return new(t||b)};static#e=this.\u0275mod=p.oAB({type:b});static#n=this.\u0275inj=p.cJS({imports:[c.ez,A.Bz,L.T]})}return b})()},7619:(M,w,a)=>{"use strict";a.d(w,{C:()=>L});var c=a(6895),A=a(4650);let L=(()=>{class p{static#t=this.\u0275fac=function(D){return new(D||p)};static#e=this.\u0275mod=A.oAB({type:p});static#n=this.\u0275inj=A.cJS({imports:[c.ez]})}return p})()},9069:M=>{"use strict";var c,w="object"==typeof Reflect?Reflect:null,a=w&&"function"==typeof w.apply?w.apply:function(i,u,h){return Function.prototype.apply.call(i,u,h)};c=w&&"function"==typeof w.ownKeys?w.ownKeys:Object.getOwnPropertySymbols?function(i){return Object.getOwnPropertyNames(i).concat(Object.getOwnPropertySymbols(i))}:function(i){return Object.getOwnPropertyNames(i)};var L=Number.isNaN||function(i){return i!=i};function p(){p.init.call(this)}M.exports=p,M.exports.once=function Z(s,i){return new Promise(function(u,h){function m(T){s.removeListener(i,O),h(T)}function O(){"function"==typeof s.removeListener&&s.removeListener("error",m),u([].slice.call(arguments))}k(s,i,O,{once:!0}),"error"!==i&&function W(s,i,u){"function"==typeof s.on&&k(s,"error",i,u)}(s,m,{once:!0})})},p.EventEmitter=p,p.prototype._events=void 0,p.prototype._eventsCount=0,p.prototype._maxListeners=void 0;var I=10;function b(s){if("function"!=typeof s)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof s)}function D(s){return void 0===s._maxListeners?p.defaultMaxListeners:s._maxListeners}function d(s,i,u,h){var m,O,T;if(b(u),void 0===(O=s._events)?(O=s._events=Object.create(null),s._eventsCount=0):(void 0!==O.newListener&&(s.emit("newListener",i,u.listener?u.listener:u),O=s._events),T=O[i]),void 0===T)T=O[i]=u,++s._eventsCount;else if("function"==typeof T?T=O[i]=h?[u,T]:[T,u]:h?T.unshift(u):T.push(u),(m=D(s))>0&&T.length>m&&!T.warned){T.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+T.length+" "+String(i)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=s,l.type=i,l.count=T.length,function A(s){console&&console.warn&&console.warn(s)}(l)}return s}function t(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function C(s,i,u){var h={fired:!1,wrapFn:void 0,target:s,type:i,listener:u},m=t.bind(h);return m.listener=u,h.wrapFn=m,m}function y(s,i,u){var h=s._events;if(void 0===h)return[];var m=h[i];return void 0===m?[]:"function"==typeof m?u?[m.listener||m]:[m]:u?function U(s){for(var i=new Array(s.length),u=0;u<i.length;++u)i[u]=s[u].listener||s[u];return i}(m):S(m,m.length)}function g(s){var i=this._events;if(void 0!==i){var u=i[s];if("function"==typeof u)return 1;if(void 0!==u)return u.length}return 0}function S(s,i){for(var u=new Array(i),h=0;h<i;++h)u[h]=s[h];return u}function k(s,i,u,h){if("function"==typeof s.on)h.once?s.once(i,u):s.on(i,u);else{if("function"!=typeof s.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof s);s.addEventListener(i,function m(O){h.once&&s.removeEventListener(i,m),u(O)})}}Object.defineProperty(p,"defaultMaxListeners",{enumerable:!0,get:function(){return I},set:function(s){if("number"!=typeof s||s<0||L(s))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+s+".");I=s}}),p.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},p.prototype.setMaxListeners=function(i){if("number"!=typeof i||i<0||L(i))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+i+".");return this._maxListeners=i,this},p.prototype.getMaxListeners=function(){return D(this)},p.prototype.emit=function(i){for(var u=[],h=1;h<arguments.length;h++)u.push(arguments[h]);var m="error"===i,O=this._events;if(void 0!==O)m=m&&void 0===O.error;else if(!m)return!1;if(m){var T;if(u.length>0&&(T=u[0]),T instanceof Error)throw T;var l=new Error("Unhandled error."+(T?" ("+T.message+")":""));throw l.context=T,l}var f=O[i];if(void 0===f)return!1;if("function"==typeof f)a(f,this,u);else{var v=f.length,P=S(f,v);for(h=0;h<v;++h)a(P[h],this,u)}return!0},p.prototype.on=p.prototype.addListener=function(i,u){return d(this,i,u,!1)},p.prototype.prependListener=function(i,u){return d(this,i,u,!0)},p.prototype.once=function(i,u){return b(u),this.on(i,C(this,i,u)),this},p.prototype.prependOnceListener=function(i,u){return b(u),this.prependListener(i,C(this,i,u)),this},p.prototype.off=p.prototype.removeListener=function(i,u){var h,m,O,T,l;if(b(u),void 0===(m=this._events))return this;if(void 0===(h=m[i]))return this;if(h===u||h.listener===u)0==--this._eventsCount?this._events=Object.create(null):(delete m[i],m.removeListener&&this.emit("removeListener",i,h.listener||u));else if("function"!=typeof h){for(O=-1,T=h.length-1;T>=0;T--)if(h[T]===u||h[T].listener===u){l=h[T].listener,O=T;break}if(O<0)return this;0===O?h.shift():function x(s,i){for(;i+1<s.length;i++)s[i]=s[i+1];s.pop()}(h,O),1===h.length&&(m[i]=h[0]),void 0!==m.removeListener&&this.emit("removeListener",i,l||u)}return this},p.prototype.removeAllListeners=function(i){var u,h,m;if(void 0===(h=this._events))return this;if(void 0===h.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==h[i]&&(0==--this._eventsCount?this._events=Object.create(null):delete h[i]),this;if(0===arguments.length){var T,O=Object.keys(h);for(m=0;m<O.length;++m)"removeListener"!==(T=O[m])&&this.removeAllListeners(T);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(u=h[i]))this.removeListener(i,u);else if(void 0!==u)for(m=u.length-1;m>=0;m--)this.removeListener(i,u[m]);return this},p.prototype.listeners=function(i){return y(this,i,!0)},p.prototype.rawListeners=function(i){return y(this,i,!1)},p.listenerCount=function(s,i){return"function"==typeof s.listenerCount?s.listenerCount(i):g.call(s,i)},p.prototype.listenerCount=g,p.prototype.eventNames=function(){return this._eventsCount>0?c(this._events):[]}},9076:(M,w,a)=>{"use strict";var c=a(7156).default;const A=a(8202),L=a(9069).EventEmitter,p=a(6643);M.exports=class I extends L{constructor(D,d){if(d||(d={}),super(),this.chunkLength=Number(D),!this.chunkLength)throw new Error("First argument must be a chunk length");this.closed=!1,this.destroyed=!1,this.length=Number(d.length)||1/0,this.name=d.name||"idb-chunk-store",this.length!==1/0&&(this.lastChunkLength=this.length%this.chunkLength||this.chunkLength,this.lastChunkIndex=Math.ceil(this.length/this.chunkLength)-1),this.dbPromise=A.openDB(this.name,void 0,{upgrade:t=>{t.createObjectStore("chunks")},blocking:()=>{this.close()},terminated:()=>{this.closed=!0,this.emit("error",new Error("Database unexpectedly closed"))}})}put(D,d,t=(()=>{})){var C=this;if(this.closed)return p(()=>t(new Error("Storage is closed")));const y=D===this.lastChunkIndex;return y&&d.length!==this.lastChunkLength?p(()=>t(new Error("Last chunk length must be "+this.lastChunkLength))):y||d.length===this.chunkLength?((0!==(d=new Uint8Array(d.buffer,d.byteOffset,d.byteLength)).byteOffset||d.byteLength!==d.buffer.byteLength)&&(d=d.slice()),void c(function*(){try{yield(yield C.dbPromise).put("chunks",d,D)}catch(g){return void t(g)}t(null)})()):p(()=>t(new Error("Chunk length must be "+this.chunkLength)))}get(D,d,t=(()=>{})){var C=this;return"function"==typeof d?this.get(D,{},d):(d||(d={}),this.closed?p(()=>t(new Error("Storage is closed"))):void c(function*(){let y;try{y=yield(yield C.dbPromise).get("chunks",D)}catch(U){return void t(U)}if(null==y){const U=new Error("Chunk not found");return U.notFound=!0,void t(U)}let g=Buffer.from(y.buffer,y.byteOffset,y.byteLength);const S=d.offset||0,x=d.length||g.length-S;(0!==S||x!==g.length)&&(g=g.slice(S,x+S)),t(null,g)})())}close(D=(()=>{})){var d=this;if(this.closed)return p(()=>D(new Error("Storage is closed")));this.closed=!0,c(function*(){try{(yield d.dbPromise).close()}catch(t){return void D(t)}D(null)})()}destroy(D=(()=>{})){var d=this;return this.closed?p(()=>D(new Error("Storage is closed"))):this.destroyed?p(()=>D(new Error("Storage is destroyed"))):(this.destroyed=!0,void this.close(function(){var t=c(function*(C){if(C)D(C);else{try{yield A.deleteDB(d.name)}catch(y){return void D(y)}D(null)}});return function(C){return t.apply(this,arguments)}}()))}}},8202:(M,w,a)=>{"use strict";a.r(w),a.d(w,{deleteDB:()=>u,openDB:()=>i,unwrap:()=>s,wrap:()=>k});var c=a(5861);const A=(l,f)=>f.some(v=>l instanceof v);let L,p;const D=new WeakMap,d=new WeakMap,t=new WeakMap,C=new WeakMap,y=new WeakMap;let x={get(l,f,v){if(l instanceof IDBTransaction){if("done"===f)return d.get(l);if("objectStoreNames"===f)return l.objectStoreNames||t.get(l);if("store"===f)return v.objectStoreNames[1]?void 0:v.objectStore(v.objectStoreNames[0])}return k(l[f])},set:(l,f,v)=>(l[f]=v,!0),has:(l,f)=>l instanceof IDBTransaction&&("done"===f||"store"===f)||f in l};function W(l){return"function"==typeof l?function Z(l){return l!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function b(){return p||(p=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(l)?function(...f){return l.apply(s(this),f),k(D.get(this))}:function(...f){return k(l.apply(s(this),f))}:function(f,...v){const P=l.call(s(this),f,...v);return t.set(P,f.sort?f.sort():[f]),k(P)}}(l):(l instanceof IDBTransaction&&function S(l){if(d.has(l))return;const f=new Promise((v,P)=>{const F=()=>{l.removeEventListener("complete",H),l.removeEventListener("error",N),l.removeEventListener("abort",N)},H=()=>{v(),F()},N=()=>{P(l.error||new DOMException("AbortError","AbortError")),F()};l.addEventListener("complete",H),l.addEventListener("error",N),l.addEventListener("abort",N)});d.set(l,f)}(l),A(l,function I(){return L||(L=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(l,x):l)}function k(l){if(l instanceof IDBRequest)return function g(l){const f=new Promise((v,P)=>{const F=()=>{l.removeEventListener("success",H),l.removeEventListener("error",N)},H=()=>{v(k(l.result)),F()},N=()=>{P(l.error),F()};l.addEventListener("success",H),l.addEventListener("error",N)});return f.then(v=>{v instanceof IDBCursor&&D.set(v,l)}).catch(()=>{}),y.set(f,l),f}(l);if(C.has(l))return C.get(l);const f=W(l);return f!==l&&(C.set(l,f),y.set(f,l)),f}const s=l=>y.get(l);function i(l,f,{blocked:v,upgrade:P,blocking:F,terminated:H}={}){const N=indexedDB.open(l,f),Q=k(N);return P&&N.addEventListener("upgradeneeded",G=>{P(k(N.result),G.oldVersion,G.newVersion,k(N.transaction))}),v&&N.addEventListener("blocked",()=>v()),Q.then(G=>{H&&G.addEventListener("close",()=>H()),F&&G.addEventListener("versionchange",()=>F())}).catch(()=>{}),Q}function u(l,{blocked:f}={}){const v=indexedDB.deleteDatabase(l);return f&&v.addEventListener("blocked",()=>f()),k(v).then(()=>{})}const h=["get","getKey","getAll","getAllKeys","count"],m=["put","add","delete","clear"],O=new Map;function T(l,f){if(!(l instanceof IDBDatabase)||f in l||"string"!=typeof f)return;if(O.get(f))return O.get(f);const v=f.replace(/FromIndex$/,""),P=f!==v,F=m.includes(v);if(!(v in(P?IDBIndex:IDBObjectStore).prototype)||!F&&!h.includes(v))return;const H=function(){var N=(0,c.Z)(function*(Q,...G){const Y=this.transaction(Q,F?"readwrite":"readonly");let J=Y.store;return P&&(J=J.index(G.shift())),(yield Promise.all([J[v](...G),F&&Y.done]))[0]});return function(G){return N.apply(this,arguments)}}();return O.set(f,H),H}!function U(l){x=l(x)}(l=>({...l,get:(f,v,P)=>T(f,v)||l.get(f,v,P),has:(f,v)=>!!T(f,v)||l.has(f,v)}))},6643:M=>{let w;M.exports="function"==typeof queueMicrotask?queueMicrotask.bind(typeof window<"u"?window:global):a=>(w||(w=Promise.resolve())).then(a).catch(c=>setTimeout(()=>{throw c},0))},7156:M=>{function w(c,A,L,p,I,b,D){try{var d=c[b](D),t=d.value}catch(C){return void L(C)}d.done?A(t):Promise.resolve(t).then(p,I)}M.exports=function a(c){return function(){var A=this,L=arguments;return new Promise(function(p,I){var b=c.apply(A,L);function D(t){w(b,p,I,D,d,"next",t)}function d(t){w(b,p,I,D,d,"throw",t)}D(void 0)})}},M.exports.__esModule=!0,M.exports.default=M.exports},4425:(M,w,a)=>{"use strict";a.d(w,{TU:()=>p});var c=a(6895),A=a(4650);class L{constructor(t,C){this._document=C;const y=this._textarea=this._document.createElement("textarea"),g=y.style;g.position="fixed",g.top=g.opacity="0",g.left="-999em",y.setAttribute("aria-hidden","true"),y.value=t,y.readOnly=!0,this._document.body.appendChild(y)}copy(){const t=this._textarea;let C=!1;try{if(t){const y=this._document.activeElement;t.select(),t.setSelectionRange(0,t.value.length),C=this._document.execCommand("copy"),y&&y.focus()}}catch{}return C}destroy(){const t=this._textarea;t&&(t.remove(),this._textarea=void 0)}}let p=(()=>{class d{constructor(C){this._document=C}copy(C){const y=this.beginCopy(C),g=y.copy();return y.destroy(),g}beginCopy(C){return new L(C,this._document)}}return d.\u0275fac=function(C){return new(C||d)(A.LFG(c.K0))},d.\u0275prov=A.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"}),d})()}}]);
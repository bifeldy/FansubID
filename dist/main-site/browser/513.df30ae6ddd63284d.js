(self.webpackChunkmain_site=self.webpackChunkmain_site||[]).push([[513],{5513:(M,I,a)=>{"use strict";a.r(I),a.d(I,{TorrentModule:()=>$e});var f=a(6895),v=a(1390),O=a(4006),h=a(7340),b=a(6308),i=a(5558),_=a(4327),y=a(4674),e=a(4650),p=a(2972),g=a(4425),w=a(9816),m=a(5861),l=a(9076),n=a.n(l),E=a(6923),d=a.n(E),r=a(1135),t=a(8202),u=a(3172),T=a(2693),S=a(5155);let D=(()=>{class A{constructor(c,x,P){if(this.gs=c,this.toast=x,this.ls=P,this.trackerAnnounce=y.N.torrent.trackerAnnounce,this.clientOptions={maxConns:64,tracker:{announce:this.trackerAnnounce,rtcConfig:{iceServers:y.N.torrent.iceServers}}},this.torrentsQueue={},this.torrentOptions={announce:this.trackerAnnounce,maxWebConns:16,store:n()},this.webClient=null,this.expandedRow=null,this.tableDataRowSubject=new r.X([]),this.tableDataRow=this.tableDataRowSubject.asObservable(),this.error=null,this.refCallback=null,this.flagResurrected=!1,this.gs.isBrowser){const j=this.ls.getItem(this.gs.localStorageKeys.Torrents,!0);if(j)for(const[$,ne]of Object.entries(j))this.torrentsQueue[$]=ne;WebTorrent.WEBRTC_SUPPORT?(this.webClient=new WebTorrent(this.clientOptions),this.gs.log("[TORRENT_CLIENT_WEB_MODE_INITIALIZED]",this.webClient),this.handleWebClient()):this.toast.error("WebRTC Not Supported!","Whoops!",null,!0)}}get tableDataRowValue(){return this.tableDataRowSubject?.value||[]}checkHealthOnTrackerAndStartDownload(c,x=null,P=this.torrentOptions){var j=this;return(0,m.Z)(function*(){try{const $=new URL(c.magnetHash),ne=new URLSearchParams($.search),Re={infoHash:ne.get("xt"),announce:ne.getAll("tr")},oe={infoHash:Re.infoHash,seeds:0,peers:0,downloads:0,trackers:[]},me=y.N.torrent.trackerAnnounce;for(const re of Re.announce)me.includes(re)||me.push(re);const Se=[];for(const re of me)Se.push(new Promise((de,Le)=>{const Qe=setTimeout(()=>{try{Le("Request Timeout!")}catch(Oe){j.gs.log("[TORRENT_CLIENT_HEALTH-TIMEOUT]",Oe,"error")}},c.trackTimeout);d().scrape({announce:re,infoHash:oe.infoHash},(Oe,xe)=>{j.gs.log("[TORRENT_CLIENT_HEALTH-ANNOUNCE]",re),j.gs.log("[TORRENT_CLIENT_HEALTH-INFO_HASH]",oe.infoHash),j.gs.log("[TORRENT_CLIENT_HEALTH-ERR]",Oe),j.gs.log("[TORRENT_CLIENT_HEALTH-RESULT]",xe);try{clearTimeout(Qe);const ye={announce:re,seeds:0,peers:0,downloads:0};Oe?Le(Oe.message):(ye.seeds=xe.complete,ye.peers=xe.incomplete,ye.downloads=xe.downloaded,de(ye))}catch(ye){j.gs.log("[TORRENT_CLIENT_HEALTH-ERROR]",ye,"error")}})}));const Ie=yield Promise.allSettled(Se);for(const[re,de]of Ie.entries())"fulfilled"===de.status?(oe.seeds+=de.value.seeds,oe.peers+=de.value.peers,oe.downloads+=de.value.downloads):oe.trackers.push({announce:me[re],error:de.reason});j.gs.log("[TORRENT_CLIENT_TRACKER-TORRENT_INFO]",oe),oe.seeds<=0&&j.toast.info("Tidak Ada Seeder!","Whoops!",null,!0),j.webClient.add(c.magnetHash,P,re=>{j.gs.log("[TORRENT_FILE_DOWNLOAD_READY]",re),j.toast.info("Memulai Download ...","Download!",null,!0),j.processTorrent(re,!1,x)})}catch($){j.gs.log("[TORRENT_CLIENT_TRACKER-ERROR]",$,"error"),x&&x($,null)}})()}handleWebClient(){this.webClient.on("torrent",c=>{this.gs.log("[TORRENT_CLIENT_ADD_TORRENT_FILE]",c),this.toast.info(c.infoHash,"Woaw, Antrian Baru!",null,!0),this.tableDataRowValue.push(c),this.tableDataRowSubject.next(this.tableDataRowValue),this.refCallback&&this.refCallback(null,c)}),this.webClient.on("error",c=>{this.gs.log("[TORRENT_CLIENT_ERROR]",c,"error"),this.toast.error(c.toString(),"Whoops!",null,!0),this.error=c,this.refCallback&&this.refCallback(this.error,null)})}handleWebTorrent(c,x=null){c.on("done",()=>{this.gs.log("[TORRENT_FILE_DONE]",c),this.toast.success("Ada Torrent Yang Sudah Selesai Di Download","Yeay, Selesai!",null,!0),this.torrentsQueue[c.infoHash].completed=!0,this.ls.setItem(this.gs.localStorageKeys.Torrents,this.torrentsQueue),x&&x(null,null)}),c.on("warning",P=>{this.gs.log("[TORRENT_FILE_WARNING]",P),this.toast.info(P.toString(),"Yuhuu!",null,!0),x&&x(P,null)}),c.on("error",P=>{this.gs.log("[TORRENT_FILE_ERROR]",P,"error"),this.toast.error(P.toString(),"Whoops!",null,!0),x&&x(P,null)})}handleWebWire(c,x=null){this.gs.log("[TORRENT_WIRE_CONNECT]",c);let P=c.peerId||"Unknown!";c.remoteAddress&&c.remotePort&&(P=`${c.remoteAddress}:${c.remotePort}`),c.on("close",()=>{this.gs.log("[TORRENT_WIRE_DISCONNECT]",P),x&&x(null,c)}),x&&x(null,c)}resurrectFiles(c=null){var x=this;if(!this.flagResurrected){this.flagResurrected=!0;for(const P in this.torrentsQueue)this.gs.log("[TORRENT_CLIENT_QUEUE_RESURRECT]",this.torrentsQueue[P]),this.torrentsQueue[P].completed?(0,t.openDB)(this.torrentsQueue[P].indexedDb,1).then(function(){var j=(0,m.Z)(function*($){const oe=yield $.transaction("chunks","readonly").objectStore("chunks").getAll(),me=u.Buffer.concat(oe),Se=[];for(const Ie of x.torrentsQueue[P].files){const re=Ie;Se.push(new File([me.slice(re.offset,re.offset+re.length)],re.name))}x.uploadFiles(x.torrentsQueue[P].name,Se,c)});return function($){return j.apply(this,arguments)}}()).catch(j=>this.gs.log("[INDEXDB-OPEN_FAILED]",j,"error")):this.downloadFiles(this.torrentsQueue[P].infoHash,c,{...this.torrentOptions,name:this.torrentsQueue[P].name})}c&&c(null,null)}processTorrent(c,x,P=null){c.on("wire",j=>this.handleWebWire(j,P)),this.torrentsQueue[c.infoHash]={completed:x,indexedDb:c.name+" - "+c.infoHash.slice(0,8),infoHash:c.infoHash,name:c.name,files:[]};for(const j of c.files)this.torrentsQueue[c.infoHash].files.push({name:j.name,offset:j.offset,length:j.length});this.ls.setItem(this.gs.localStorageKeys.Torrents,this.torrentsQueue),this.handleWebTorrent(c,P)}downloadFiles(c,x=null,P=this.torrentOptions){this.gs.log("[TORRENT_CLIENT_QUEUE_DOWNLOAD]",c),this.refCallback=x,this.checkHealthOnTrackerAndStartDownload({magnetHash:c,trackTimeout:12345},x,P)}uploadFiles(c,x,P=null){this.gs.log("[TORRENT_CLIENT_QUEUE_UPLOAD]",x),this.gs.log("[TORRENT_CLIENT_QUEUE_UPLOAD]",c),this.refCallback=P,this.webClient.seed(x,{...this.torrentOptions,name:c},j=>{this.gs.log("[TORRENT_FILE_SEED_READY]",j),this.toast.info("Memulai Seeding ...","Seeding",null,!0),this.processTorrent(j,!0,P)})}removeTorrent(c,x=null,P=!0){this.tableDataRowSubject.next(this.tableDataRowValue.filter(j=>j.infoHash!==c)),this.webClient.remove(c,{destroyStore:!0},j=>{j&&this.gs.log("[TORRENT_FILE_REMOVE_ERROR]",j,"error"),delete this.torrentsQueue[c],P&&this.ls.setItem(this.gs.localStorageKeys.Torrents,this.torrentsQueue),x&&x(j)})}pauseTorrent(c,x=null){const P=this.webClient.get(c);P&&(P.pause(),x&&x(P))}resumeTorrent(c,x=null){const P=this.webClient.get(c);P&&(P.resume(),x&&x(P))}removeAll(){for(const c of this.webClient.torrents)this.removeTorrent(c.infoHash,x=>{x||this.gs.log("[TORRENT_FILE_REMOVE_SUCCESS]",c.infoHash)},!1)}static#e=this.\u0275fac=function(x){return new(x||A)(e.LFG(w.U),e.LFG(T.k),e.LFG(S.n))};static#t=this.\u0275prov=e.Yz7({token:A,factory:A.\u0275fac,providedIn:"root"})}return A})();var U=a(2970),B=a(7396),N=a(3322);let L=(()=>{class A{constructor(){this.fileDropped=new e.vpe}onDragOver(c){c.preventDefault(),c.stopPropagation(),this.fileOver=!0}onDragLeave(c){c.preventDefault(),c.stopPropagation(),this.fileOver=!1}ondrop(c){c.preventDefault(),c.stopPropagation(),this.fileOver=!1;let x=c.dataTransfer.files;x.length>0&&this.fileDropped.emit(x)}static#e=this.\u0275fac=function(x){return new(x||A)};static#t=this.\u0275dir=e.lG2({type:A,selectors:[["","appDragDrop",""]],hostVars:2,hostBindings:function(x,P){1&x&&e.NdJ("dragover",function($){return P.onDragOver($)})("dragleave",function($){return P.onDragLeave($)})("drop",function($){return P.ondrop($)}),2&x&&e.ekj("fileover",P.fileOver)},outputs:{fileDropped:"fileDropped"}})}return A})();var W=a(4758),V=a(9818),X=a(7392),Q=a(8455),q=a(9203),ee=a(9982),te=a(1256),ie=a(7462),se=a(7443);function le(A,G){1&A&&e._UZ(0,"mat-progress-bar",27)}function pe(A,G){1&A&&(e.TgZ(0,"span"),e._uU(1,"\u{1f516} NAME"),e.qZA()),2&A&&e.Udp("color","#ff4081")}function be(A,G){1&A&&(e.TgZ(0,"span"),e._uU(1,"\u{1f4be} SIZE"),e.qZA()),2&A&&e.Udp("color","#ff4081")}function ge(A,G){1&A&&(e.TgZ(0,"span"),e._uU(1,"\u{1f4bf} DOWNLOADED"),e.qZA()),2&A&&e.Udp("color","#ff4081")}function ae(A,G){1&A&&(e.TgZ(0,"span"),e._uU(1,"\u{1f4c0} UPLOADED"),e.qZA()),2&A&&e.Udp("color","#ff4081")}function Ee(A,G){1&A&&(e.TgZ(0,"span"),e._uU(1,"\u{1f504} PROGRESS"),e.qZA()),2&A&&e.Udp("color","#ff4081")}function Te(A,G){1&A&&(e.TgZ(0,"span"),e._uU(1,"\u{1f53d} SPEED"),e.qZA()),2&A&&e.Udp("color","#ff4081")}function R(A,G){1&A&&(e.TgZ(0,"span"),e._uU(1,"\u{1f53c} SPEED"),e.qZA()),2&A&&e.Udp("color","#ff4081")}function C(A,G){1&A&&(e.TgZ(0,"span"),e._uU(1,"\u{1f551} ~ETA."),e.qZA()),2&A&&e.Udp("color","#ff4081")}function F(A,G){1&A&&(e.TgZ(0,"span"),e._uU(1,"\u{1f9f2} PEERS"),e.qZA()),2&A&&e.Udp("color","#ff4081")}function Z(A,G){1&A&&(e.TgZ(0,"span"),e._uU(1,"\u{1f310} RATIO"),e.qZA()),2&A&&e.Udp("color","#ff4081")}function J(A,G){if(1&A&&(e.TgZ(0,"th",31)(1,"h3",32),e.YNc(2,pe,2,2,"span",33),e.YNc(3,be,2,2,"span",33),e.YNc(4,ge,2,2,"span",33),e.YNc(5,ae,2,2,"span",33),e.YNc(6,Ee,2,2,"span",33),e.YNc(7,Te,2,2,"span",33),e.YNc(8,R,2,2,"span",33),e.YNc(9,C,2,2,"span",33),e.YNc(10,F,2,2,"span",33),e.YNc(11,Z,2,2,"span",33),e.qZA()()),2&A){const c=e.oxw().$implicit;e.xp6(2),e.Q6J("ngIf","NAME"===c.toUpperCase()),e.xp6(1),e.Q6J("ngIf","LENGTH"===c.toUpperCase()),e.xp6(1),e.Q6J("ngIf","DOWNLOADED"===c.toUpperCase()),e.xp6(1),e.Q6J("ngIf","UPLOADED"===c.toUpperCase()),e.xp6(1),e.Q6J("ngIf","PROGRESS"===c.toUpperCase()),e.xp6(1),e.Q6J("ngIf","DOWNLOADSPEED"===c.toUpperCase()),e.xp6(1),e.Q6J("ngIf","UPLOADSPEED"===c.toUpperCase()),e.xp6(1),e.Q6J("ngIf","TIMEREMAINING"===c.toUpperCase()),e.xp6(1),e.Q6J("ngIf","NUMPEERS"===c.toUpperCase()),e.xp6(1),e.Q6J("ngIf","RATIO"===c.toUpperCase())}}function o(A,G){if(1&A&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&A){const c=e.oxw().$implicit,x=e.oxw().$implicit;e.xp6(1),e.Oqu(c[x])}}function s(A,G){if(1&A&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"bytes"),e.qZA()),2&A){const c=e.oxw().$implicit,x=e.oxw().$implicit;e.xp6(1),e.Oqu(e.lcZ(2,1,c[x]))}}function k(A,G){if(1&A&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"bytes"),e.qZA()),2&A){const c=e.oxw().$implicit,x=e.oxw().$implicit;e.xp6(1),e.Oqu(e.lcZ(2,1,c[x]))}}function H(A,G){if(1&A&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"bytes"),e.qZA()),2&A){const c=e.oxw().$implicit,x=e.oxw().$implicit;e.xp6(1),e.Oqu(e.lcZ(2,1,c[x]))}}function z(A,G){if(1&A&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"number"),e.qZA()),2&A){const c=e.oxw().$implicit;e.xp6(1),e.hij("",e.xi3(2,1,c.downloaded/c.length*100,"1.2-2")," %")}}function Y(A,G){if(1&A&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"bytes"),e.qZA()),2&A){const c=e.oxw().$implicit,x=e.oxw().$implicit;e.xp6(1),e.hij("",e.lcZ(2,1,c[x]),"/s")}}function K(A,G){if(1&A&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"bytes"),e.qZA()),2&A){const c=e.oxw().$implicit,x=e.oxw().$implicit;e.xp6(1),e.hij("",e.lcZ(2,1,c[x]),"/s")}}function ce(A,G){if(1&A&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"number"),e.qZA()),2&A){const c=e.oxw().$implicit,x=e.oxw().$implicit;e.xp6(1),e.Oqu(c[x]<=0?"COMPLETED":e.xi3(2,1,c[x]/1e3,"1.0-0")+" s")}}function _e(A,G){if(1&A&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&A){const c=e.oxw().$implicit,x=e.oxw().$implicit;e.xp6(1),e.Oqu(c[x])}}function Ae(A,G){if(1&A&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"number"),e.qZA()),2&A){const c=e.oxw().$implicit,x=e.oxw().$implicit;e.xp6(1),e.Oqu(e.xi3(2,1,c[x],"1.4-4"))}}function Ne(A,G){if(1&A&&(e.TgZ(0,"td",34)(1,"h3"),e.YNc(2,o,2,1,"span",35),e.YNc(3,s,3,3,"span",35),e.YNc(4,k,3,3,"span",35),e.YNc(5,H,3,3,"span",35),e.YNc(6,z,3,4,"span",35),e.YNc(7,Y,3,3,"span",35),e.YNc(8,K,3,3,"span",35),e.YNc(9,ce,3,4,"span",35),e.YNc(10,_e,2,1,"span",35),e.YNc(11,Ae,3,4,"span",35),e.qZA()()),2&A){const c=e.oxw().$implicit;e.xp6(1),e.Gre("m-0 ","NAME"===c.toUpperCase()?"text-start":"",""),e.xp6(1),e.Q6J("ngIf","NAME"===c.toUpperCase()),e.xp6(1),e.Q6J("ngIf","LENGTH"===c.toUpperCase()),e.xp6(1),e.Q6J("ngIf","DOWNLOADED"===c.toUpperCase()),e.xp6(1),e.Q6J("ngIf","UPLOADED"===c.toUpperCase()),e.xp6(1),e.Q6J("ngIf","PROGRESS"===c.toUpperCase()),e.xp6(1),e.Q6J("ngIf","DOWNLOADSPEED"===c.toUpperCase()),e.xp6(1),e.Q6J("ngIf","UPLOADSPEED"===c.toUpperCase()),e.xp6(1),e.Q6J("ngIf","TIMEREMAINING"===c.toUpperCase()),e.xp6(1),e.Q6J("ngIf","NUMPEERS"===c.toUpperCase()),e.xp6(1),e.Q6J("ngIf","RATIO"===c.toUpperCase())}}function De(A,G){1&A&&(e.ynx(0,28),e.YNc(1,J,12,10,"th",29),e.YNc(2,Ne,12,13,"td",30),e.BQk()),2&A&&e.s9C("matColumnDef",G.$implicit)}function ve(A,G){if(1&A&&(e.TgZ(0,"p",42),e._uU(1," Info Hash :: "),e.TgZ(2,"span",54),e._uU(3),e.qZA()()),2&A){const c=e.oxw().$implicit;e.xp6(3),e.hij(" ",c.infoHash," ")}}function we(A,G){if(1&A){const c=e.EpF();e.TgZ(0,"p",42),e._uU(1," Magnet URI :: "),e.TgZ(2,"span",55),e.NdJ("click",function(){e.CHM(c);const P=e.oxw().$implicit,j=e.oxw();return e.KtG(j.copyMagnetHashToClipboard(P.magnetURI))}),e._uU(3),e.qZA()()}if(2&A){const c=e.oxw().$implicit;e.xp6(3),e.hij(" ",c.magnetURI," ")}}function Ce(A,G){if(1&A&&(e.TgZ(0,"li"),e._uU(1),e.qZA()),2&A){const c=G.$implicit;e.xp6(1),e.hij(" ",c," ")}}function he(A,G){if(1&A){const c=e.EpF();e.TgZ(0,"button",46),e.NdJ("click",function(){e.CHM(c);const P=e.oxw().$implicit,j=e.oxw();return e.KtG(j.resumeTorrent(P))}),e._UZ(1,"mat-icon",56),e._uU(2," Resume "),e.qZA()}}function ue(A,G){if(1&A){const c=e.EpF();e.TgZ(0,"button",46),e.NdJ("click",function(){e.CHM(c);const P=e.oxw().$implicit,j=e.oxw();return e.KtG(j.pauseTorrent(P))}),e._UZ(1,"mat-icon",57),e._uU(2," Pause "),e.qZA()}}function fe(A,G){if(1&A){const c=e.EpF();e.TgZ(0,"mat-list-option",58),e._UZ(1,"mat-icon",59),e.TgZ(2,"div",60),e.NdJ("click",function(){const j=e.CHM(c).$implicit,$=e.oxw(2);return e.KtG($.saveFile(j))}),e.TgZ(3,"span"),e._uU(4),e.qZA(),e._uU(5," -- "),e.TgZ(6,"span",61),e._uU(7),e.ALo(8,"number"),e.qZA(),e._uU(9," :: "),e.TgZ(10,"span",54),e._uU(11),e.ALo(12,"bytes"),e.ALo(13,"bytes"),e.qZA()()()}if(2&A){const c=G.$implicit;e.xp6(3),e.Gre("text-",c.downloaded/c.length>=1?"primary":"bifeldy",""),e.xp6(1),e.hij(" ",c.name," "),e.xp6(3),e.hij(" ",e.xi3(8,7,c.downloaded/c.length*100,"1.2-2")," % "),e.xp6(4),e.AsE(" ",e.lcZ(12,10,c.downloaded)," / ",e.lcZ(13,12,c.length)," ")}}function ke(A,G){if(1&A){const c=e.EpF();e.TgZ(0,"td",36)(1,"div",37)(2,"div",38)(3,"div",39),e._UZ(4,"div"),e.qZA(),e.TgZ(5,"div",40),e.YNc(6,ve,4,1,"p",41),e.YNc(7,we,4,1,"p",41),e.TgZ(8,"div",42),e._uU(9," Announce Trackers :: "),e.TgZ(10,"ul",43),e.YNc(11,Ce,2,1,"li",44),e.qZA()(),e.TgZ(12,"div",45)(13,"button",46),e.NdJ("click",function(){const j=e.CHM(c).$implicit,$=e.oxw();return e.KtG($.refreshGraph(j))}),e._UZ(14,"mat-icon",47),e._uU(15," Refresh Graph "),e.qZA(),e.TgZ(16,"button",46),e.NdJ("click",function(){const j=e.CHM(c).$implicit,$=e.oxw();return e.KtG($.removeTorrent(j))}),e._UZ(17,"mat-icon",48),e._uU(18," Remove "),e.qZA(),e.YNc(19,he,3,0,"button",49),e.YNc(20,ue,3,0,"button",49),e.qZA(),e.TgZ(21,"div",50)(22,"div",51),e._uU(23,"Rincian Isi Berkas \u2728"),e.qZA(),e.TgZ(24,"mat-selection-list",52),e.YNc(25,fe,14,14,"mat-list-option",53),e.qZA()()()()()()}if(2&A){const c=G.$implicit,x=e.oxw();e.uIk("colspan",x.tableDataColumn.length),e.xp6(1),e.Q6J("@detailExpand",c===x.TORRENT.expandedRow?"expanded":"collapsed"),e.xp6(3),e.Gre("p2p-graph graphP2p-",c.infoHash,""),e.xp6(2),e.Q6J("ngIf",c.infoHash),e.xp6(1),e.Q6J("ngIf",c.magnetURI),e.xp6(4),e.Q6J("ngForOf",c.announce),e.xp6(8),e.Q6J("ngIf",c.paused),e.xp6(1),e.Q6J("ngIf",!c.paused),e.xp6(4),e.Q6J("multiple",!1),e.xp6(1),e.Q6J("ngForOf",c.files)}}function Me(A,G){1&A&&e._UZ(0,"tr",62)}function Pe(A,G){if(1&A){const c=e.EpF();e.TgZ(0,"tr",63),e.NdJ("click",function(){const j=e.CHM(c).$implicit,$=e.oxw();return e.KtG($.toggleExpanded(j))}),e.qZA()}if(2&A){const c=G.$implicit,x=e.oxw();e.ekj("expanded-row",x.TORRENT.expandedRow===c)}}function Ue(A,G){1&A&&e._UZ(0,"tr",64)}function Fe(A,G){if(1&A&&(e.TgZ(0,"tr",65)(1,"td",66)(2,"div",67)(3,"div",68)(4,"h3",32),e._uU(5," Tidak Ada Data \xaf\\_(\u30c4)_/\xaf "),e.qZA()()()()()),2&A){const c=e.oxw();e.xp6(1),e.uIk("colspan",c.tableDataColumn.length)}}const Be=function(){return["expandedDetail"]};let He=(()=>{class A{constructor(c,x,P,j,$,ne,Re,oe){this.snackBar=c,this.clipboard=x,this.gs=P,this.torrent=j,this.toast=$,this.ds=ne,this.ss=Re,this.bs=oe,this.isProcessing=!1,this.magnetHash=null,this.torrentsGraph={},this.tableDataColumn=["name","length","downloaded","uploaded","progress","downloadSpeed","uploadSpeed","timeRemaining","numPeers","ratio"],this.files=[],this.subsDialog=null,this.subsUser=null,this.subsTableDataRow=null,this.gs.bannerImg=null,this.gs.sizeContain=!1,this.gs.bgRepeat=!1}get ENV(){return y.N}get TORRENT(){return this.torrent}ngOnInit(){this.dataSource=new i.r4,this.gs.isBrowser&&(this.dataSource.sort=this.sort,this.subsTableDataRow=this.torrent.tableDataRow.subscribe({next:c=>{this.dataSource.data=c,this.refreshAllGraph()}}),this.reviveTorrent())}ngOnDestroy(){this.sort?.sortChange?.unsubscribe(),this.subsDialog?.unsubscribe(),this.subsUser?.unsubscribe(),this.subsTableDataRow?.unsubscribe()}copyMagnetHashToClipboard(c){this.clipboard.copy(c)&&this.snackBar.open("Magnet Link Hash :: Telah Di Salin Pada Clipboard","OK")}toggleExpanded(c){this.gs.log("[TORRENT_CLICKED]",c),this.torrent.expandedRow=this.torrent.expandedRow===c?null:c,this.refreshGraph(c)}saveFile(c){c.downloaded/c.length>=1?(this.bs.busy(),c.getBlobURL((x,P)=>{x||(this.gs.log("[TORRENT_FILE_BLOBURL]",P),(0,_.saveAs)(P,c.name),this.bs.idle())})):this.toast.info("Berkas Sedang Dalam Proses Unduhan!","Yah, File Belum Siap!",null,!0)}reviveTorrent(){this.bs.busy(),this.torrent.resurrectFiles((c,x)=>{this.refreshAllGraph(),this.bs.idle()})}resumeTorrent(c){this.torrent.resumeTorrent(c.infoHash,x=>{this.refreshAllGraph()})}pauseTorrent(c){this.torrent.pauseTorrent(c.infoHash,x=>{x||this.gs.log("[TORRENT_FILE_PAUSE_SUCCESS]",c.infoHash),this.refreshAllGraph()})}removeTorrent(c){this.torrent.removeTorrent(c.infoHash,x=>{x||this.gs.log("[TORRENT_FILE_REMOVE_SUCCESS]",c.infoHash),this.torrentsGraph[c.infoHash].destroy(),delete this.torrentsGraph[c.infoHash],this.refreshAllGraph()})}downloadFiles(c){this.isProcessing=!0,this.torrent.downloadFiles(this.magnetHash,(x,P)=>{this.magnetHash=null,this.isProcessing=!1,this.refreshAllGraph()})}uploadFiles(c){this.gs.log("[TORRENT_SEED_USER_INFORMATION]",c),this.isProcessing=!0,this.torrent.uploadFiles(c,this.files,(x,P)=>{this.isProcessing=!1,this.refreshAllGraph()})}prepareFilesList(c){this.files=[];for(const P of c)this.files.push(P);const x={torrent_name:{inputLabel:"Nama Torrent",inputPlaceholder:`Torrent # ${this.ss.mySocket.id} @ ${(new Date).toUTCString()}`,inputValue:null,inputRequired:!0}};1===this.files.length?(x.torrent_name.inputPlaceholder=this.files[0].name,this.uploadFiles(x.torrent_name.inputPlaceholder)):this.files.length>1&&(this.subsDialog=this.ds.openInputDialog({data:{title:"Silahkan Masukkan Nama Untuk Torrent Kamu!",input:x,confirmText:"Ya, Mulai SEED",cancelText:"Tidak, Batal"}}).afterClosed().subscribe({next:P=>{this.gs.log("[INPUT_DIALOG_CLOSED]",P),P&&this.uploadFiles(P.torrent_name),this.subsDialog.unsubscribe()}}))}onFileDropped(c){this.prepareFilesList(c)}fileBrowseHandler(c){this.prepareFilesList(c.target.files)}initGraph(c){!this.torrentsGraph[c.infoHash]&&this.dataSource.data.length>0&&(this.gs.log("[TORRENT_WIRE_INIT_GRAPH]",c),this.torrentsGraph[c.infoHash]=new P2PGraph(`.graphP2p-${c.infoHash}`),this.torrentsGraph[c.infoHash].add({id:this.torrent.webClient.peerId,me:!0,name:"Kamu!"}))}addAllGraph(c){this.gs.log("[TORRENT_WIRE_RELOAD_GRAPH]",c);for(const x of c.wires){let P=x.peerId||"Anonim!";x.remoteAddress&&x.remotePort&&(P=`${x.remoteAddress}:${x.remotePort}`),this.torrentsGraph[c.infoHash].add({id:x.peerId,name:P}),this.torrentsGraph[c.infoHash].connect(this.torrent.webClient.peerId,x.peerId)}}deleteAllGraph(c){this.gs.log("[TORRENT_WIRE_DELETE_GRAPH]",c);const x=this.torrentsGraph[c.infoHash].list().filter(P=>P.id!==this.torrent.webClient.peerId);for(const P of x)this.torrentsGraph[c.infoHash].disconnect(this.torrent.webClient.peerId,P.id),this.torrentsGraph[c.infoHash].remove(P.id)}refreshGraph(c){this.gs.log("[TORRENT_WIRE_REFRESH_GRAPH]",c),this.torrentsGraph[c.infoHash]?(this.deleteAllGraph(c),this.addAllGraph(c)):this.initGraph(c)}refreshAllGraph(){for(const c of this.dataSource.data)setTimeout(()=>{this.refreshGraph(c)},1234)}static#e=this.\u0275fac=function(x){return new(x||A)(e.Y36(p.pl),e.Y36(g.TU),e.Y36(w.U),e.Y36(D),e.Y36(T.k),e.Y36(U.x),e.Y36(B.R),e.Y36(N.z))};static#t=this.\u0275cmp=e.Xpm({type:A,selectors:[["app-torrent"]],viewQuery:function(x,P){if(1&x&&e.Gf(b.YE,7),2&x){let j;e.iGM(j=e.CRH())&&(P.sort=j.first)}},decls:35,vars:13,consts:[["appDragDrop","",1,"h-100",3,"fileDropped"],[1,"container"],[1,"row","pb-3","px-0"],[1,"col-12"],[1,"row"],[1,"col-12","sticky-top","bg-bifeldy"],[1,"pt-3","border-bottom-dotted"],[1,"text-bifeldy"],["hintLabel","Isi Lalu Tekan 'Enter' Untuk Mencari Torrent ...",1,"col-12","col-md-6","col-lg-4","px-3","mb-3",3,"color"],["matInput","","placeholder","Ex. magnet:123qwe...!@#",3,"ngModel","disabled","keyup.enter","ngModelChange"],["input",""],["fontIcon","cloud_download","matSuffix",""],["color","warn","mode","indeterminate",4,"ngIf"],[1,"row","mx-2"],[1,"col-12",2,"overflow-x","auto"],["mat-table","","matSort","","multiTemplateDataRows","",1,"bg-transparent",3,"dataSource"],[3,"matColumnDef",4,"ngFor","ngForOf"],["matColumnDef","expandedDetail"],["mat-cell","",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","","class","element-row",3,"expanded-row","click",4,"matRowDef","matRowDefColumns"],["mat-row","","class","detail-row",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["type","file","id","fileDropRef","multiple","",2,"visibility","hidden",3,"disabled","change"],["fileDropRef",""],["type","button","mat-fab","","color","warn","matTooltip","Seed Berkas",1,"me-3","mb-5","fab-button","animate__animated","animate__bounce","animate__infinite","animate__slow",2,"position","fixed","bottom","0","right","0",3,"disabled","click"],["fontIcon","cloud_upload"],["color","warn","mode","indeterminate"],[3,"matColumnDef"],["mat-header-cell","","class","px-3 text-center","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","","class","px-3 text-center","style","cursor: pointer;",4,"matCellDef"],["mat-header-cell","","mat-sort-header","",1,"px-3","text-center"],[1,"m-0"],[3,"color",4,"ngIf"],["mat-cell","",1,"px-3","text-center",2,"cursor","pointer"],[4,"ngIf"],["mat-cell",""],[1,"element-detail"],[1,"py-3","row"],[1,"col-3"],[1,"col-9"],["class","px-2 text-truncate",4,"ngIf"],[1,"px-2","text-truncate"],[1,"text-success","m-0"],[4,"ngFor","ngForOf"],[1,"p-2"],["type","button","mat-stroked-button","",1,"m-1","text-warning",3,"click"],["fontIcon","refresh",1,"me-1"],["fontIcon","delete_outline",1,"me-1"],["type","button","mat-stroked-button","","class","m-1 text-warning",3,"click",4,"ngIf"],[1,"px-2"],["mat-subheader","",1,"p-0"],[3,"multiple"],["class","h-100",4,"ngFor","ngForOf"],[1,"text-success"],["matTooltip","Klik Untuk Menyalin!",1,"text-primary","text-decoration-none",3,"click"],["fontIcon","play_arrow",1,"me-1"],["fontIcon","pause",1,"me-1"],[1,"h-100"],["fontIcon","file_present","mat-list-icon","",1,"ps-3"],[2,"cursor","pointer",3,"click"],[1,"text-warning"],["mat-header-row",""],["mat-row","",1,"element-row",3,"click"],["mat-row","",1,"detail-row"],[1,"mat-row"],[1,"mat-cell","text-center","align-items-center","p-0",2,"background-image","url('/assets/img/404/no-data.png')","background-size","contain","background-position","center","background-repeat","no-repeat","height","256px"],[1,"row","align-items-center","h-100"],[1,"col-8","mx-auto","text-light","text-center","rounded","py-3",2,"background-color","rgba(128, 128, 128, 0.875)"]],template:function(x,P){if(1&x){const j=e.EpF();e.TgZ(0,"div",0),e.NdJ("fileDropped",function(ne){return P.onFileDropped(ne)}),e._UZ(1,"app-notifications"),e.TgZ(2,"div",1)(3,"div",2)(4,"div",3)(5,"div",4)(6,"div",5)(7,"h2",6)(8,"b",7),e._uU(9,"Web-SocketRTC Torrent"),e.qZA()()(),e.TgZ(10,"div",3)(11,"mat-form-field",8)(12,"mat-label"),e._uU(13,"Unduh Dari Info Hash / Magnet URI"),e.qZA(),e.TgZ(14,"input",9,10),e.NdJ("keyup.enter",function(ne){return P.downloadFiles(ne)})("ngModelChange",function(ne){return P.magnetHash=ne}),e.qZA(),e._UZ(16,"mat-icon",11),e.YNc(17,le,1,0,"mat-progress-bar",12),e.qZA(),e.TgZ(18,"div",13)(19,"div",14)(20,"table",15),e.YNc(21,De,3,1,"ng-container",16),e.ynx(22,17),e.YNc(23,ke,26,12,"td",18),e.BQk(),e.YNc(24,Me,1,0,"tr",19),e.YNc(25,Pe,1,2,"tr",20),e.YNc(26,Ue,1,0,"tr",21),e.YNc(27,Fe,6,1,"tr",22),e.qZA()(),e.TgZ(28,"div",3)(29,"marquee"),e._uU(30),e.qZA()()()()()()()(),e.TgZ(31,"input",23,24),e.NdJ("change",function(ne){return P.fileBrowseHandler(ne)}),e.qZA(),e.TgZ(33,"button",25),e.NdJ("click",function(){e.CHM(j);const ne=e.MAs(32);return e.KtG(ne.click())}),e._UZ(34,"mat-icon",26),e.qZA()()}2&x&&(e.xp6(11),e.Q6J("color","accent"),e.xp6(3),e.Q6J("ngModel",P.magnetHash)("disabled",P.isProcessing),e.xp6(3),e.Q6J("ngIf",P.isProcessing),e.xp6(3),e.Q6J("dataSource",P.dataSource),e.xp6(1),e.Q6J("ngForOf",P.tableDataColumn),e.xp6(3),e.Q6J("matHeaderRowDef",P.tableDataColumn),e.xp6(1),e.Q6J("matRowDefColumns",P.tableDataColumn),e.xp6(1),e.Q6J("matRowDefColumns",e.DdM(12,Be)),e.xp6(4),e.hij("Terhubung Dengan Tracker :: ",P.ENV.torrent.trackerAnnounce.join(" :: "),""),e.xp6(1),e.Q6J("disabled",P.isProcessing),e.xp6(2),e.Q6J("disabled",P.isProcessing))},dependencies:[f.sg,f.O5,O.Fj,O.JJ,O.On,L,W.t,V.eB,X.Hw,Q.v_,Q.$V,Q.nX,q.k0,ee.ap,ee.Sc,ee.kh,ee.O$,te.eI,i.ty,i.wO,i.S4,i.t3,i.R3,i.Al,i.L7,i.ML,i.fg,i.Zw,i.ZB,ie.Kd,b.YE,b.nU,f.JJ,se.$],styles:[".p2p-graph[_ngcontent-%COMP%]{background-color:#8d8d8d80!important}tr.detail-row[_ngcontent-%COMP%]{height:0}tr.element-row[_ngcontent-%COMP%]:not(.expanded-row):hover{background-color:#ffffffdf}.element-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-bottom-width:0}.element-detail[_ngcontent-%COMP%]{overflow:hidden;display:flex}.fileover[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_shake 1s;animation-iteration-count:infinite}@keyframes _ngcontent-%COMP%_shake{0%{transform:translate(1px,1px) rotate(0)}10%{transform:translate(-1px,-2px) rotate(-1deg)}20%{transform:translate(-3px) rotate(1deg)}30%{transform:translate(3px,2px) rotate(0)}40%{transform:translate(1px,-1px) rotate(1deg)}50%{transform:translate(-1px,2px) rotate(-1deg)}60%{transform:translate(-3px,1px) rotate(0)}70%{transform:translate(3px,1px) rotate(-1deg)}80%{transform:translate(-1px,-1px) rotate(1deg)}90%{transform:translate(1px,2px) rotate(0)}to{transform:translate(1px,-2px) rotate(-1deg)}}"],data:{animation:[(0,h.X$)("detailExpand",[(0,h.SB)("collapsed",(0,h.oB)({height:"0px",minHeight:"0"})),(0,h.SB)("expanded",(0,h.oB)({height:"*"})),(0,h.eR)("expanded <=> collapsed",(0,h.jt)("225ms cubic-bezier(0.4, 0.0, 0.2, 1)"))])]}})}return A})();var je=a(2314),We=a(3811),Ze=a(6319),Ge=a(6533),Ye=a(7619);const Je=[{path:"",pathMatch:"full",component:He}];let $e=(()=>{class A{static#e=this.\u0275fac=function(x){return new(x||A)};static#t=this.\u0275mod=e.oAB({type:A});static#n=this.\u0275inj=e.cJS({imports:[f.ez,v.Bz.forChild(Je),O.u5,Ye.C,Ze.F,je.m,Ge.P,We.T]})}return A})()},6533:(M,I,a)=>{"use strict";a.d(I,{P:()=>h});var f=a(6895),v=a(2314),O=a(4650);let h=(()=>{class b{static#e=this.\u0275fac=function(y){return new(y||b)};static#t=this.\u0275mod=O.oAB({type:b});static#n=this.\u0275inj=O.cJS({imports:[f.ez,v.m]})}return b})()},4758:(M,I,a)=>{"use strict";a.d(I,{t:()=>g});var f=a(4650),v=a(1390),O=a(9816),h=a(8598),b=a(6895),i=a(5882);function _(w,m){if(1&w&&f._UZ(0,"div",4),2&w){const l=f.oxw();f.Udp("background-size",l.GS.sizeContain?"contain":"cover")("background-image","url("+l.GS.bannerImg+")")("background-repeat",l.GS.bgRepeat?"repeat-x":"no-repeat")("height",l.ROUTER.url.startsWith("/news")||l.ROUTER.url.startsWith("/berkas")||l.ROUTER.url.startsWith("/search")||l.ROUTER.url.startsWith("/fansub")?"192px":"128px")("background-position-y",l.ROUTER.url.startsWith("/berkas")||l.ROUTER.url.startsWith("/search")?"22.5%":"")}}function y(w,m){if(1&w&&(f.TgZ(0,"strong",10),f._uU(1," -- "),f.TgZ(2,"i")(3,"a",11),f._uU(4),f.qZA()()()),2&w){const l=f.oxw().$implicit;f.xp6(3),f.MGl("routerLink","/user/",l.notifCreator,""),f.xp6(1),f.hij(" ",l.notifCreator," ")}}function e(w,m){if(1&w){const l=f.EpF();f.TgZ(0,"button",12),f.NdJ("click",function(){f.CHM(l);const E=f.oxw().$implicit,d=f.oxw();return f.KtG(d.removeNotif(E.notifData.id))}),f.qZA()}}function p(w,m){if(1&w&&(f.TgZ(0,"div",5)(1,"div")(2,"strong",6),f._uU(3),f.qZA(),f._UZ(4,"span",7),f.ALo(5,"safeInnerHtml"),f.YNc(6,y,5,2,"strong",8),f.YNc(7,e,1,0,"button",9),f.qZA()()),2&w){const l=m.$implicit;f.xp6(1),f.Gre("alert alert-",l.notifData.type," alert-dismissible fade show"),f.xp6(2),f.Oqu(l.notifData.title),f.xp6(1),f.Q6J("innerHTML",f.lcZ(5,7,l.notifData.content),f.oJD),f.xp6(2),f.Q6J("ngIf",l.notifCreator),f.xp6(1),f.Q6J("ngIf",l.notifData.dismissible)}}let g=(()=>{class w{constructor(l,n,E){this.router=l,this.gs=n,this.notif=E}ngOnInit(){}get GS(){return this.gs}get ROUTER(){return this.router}get NOTIF(){return this.notif}removeNotif(l){this.notif.removeNotif(l)}static#e=this.\u0275fac=function(n){return new(n||w)(f.Y36(v.F0),f.Y36(O.U),f.Y36(h.T))};static#t=this.\u0275cmp=f.Xpm({type:w,selectors:[["app-notifications"]],decls:4,vars:2,consts:[["class","container-fluid notif-banner align-items-center",3,"background-size","background-image","background-repeat","height","background-position-y",4,"ngIf"],[1,"container"],[1,"row","pt-3"],["class","col-12",4,"ngFor","ngForOf"],[1,"container-fluid","notif-banner","align-items-center"],[1,"col-12"],[1,"me-1"],[3,"innerHTML"],["class","ms-1",4,"ngIf"],["type","button","class","btn-close","data-dismiss","alert",3,"click",4,"ngIf"],[1,"ms-1"],[1,"text-decoration-none",3,"routerLink"],["type","button","data-dismiss","alert",1,"btn-close",3,"click"]],template:function(n,E){1&n&&(f.YNc(0,_,1,10,"div",0),f.TgZ(1,"div",1)(2,"div",2),f.YNc(3,p,8,9,"div",3),f.qZA()()),2&n&&(f.Q6J("ngIf",E.GS.bannerImg&&(E.ROUTER.url.startsWith("/news")||E.ROUTER.url.startsWith("/berkas")||E.ROUTER.url.startsWith("/search")||E.ROUTER.url.startsWith("/fansub")||E.ROUTER.url.startsWith("/anime")||E.ROUTER.url.startsWith("/dorama"))),f.xp6(3),f.Q6J("ngForOf",E.NOTIF.notifications))},dependencies:[b.sg,b.O5,v.rH,i.H],styles:[".notif-banner[_ngcontent-%COMP%]{width:100%;background-size:cover;background-position:75% 50%}"]})}return w})()},6319:(M,I,a)=>{"use strict";a.d(I,{F:()=>b});var f=a(6895),v=a(1390),O=a(3811),h=a(4650);let b=(()=>{class i{static#e=this.\u0275fac=function(e){return new(e||i)};static#t=this.\u0275mod=h.oAB({type:i});static#n=this.\u0275inj=h.cJS({imports:[f.ez,v.Bz,O.T]})}return i})()},7619:(M,I,a)=>{"use strict";a.d(I,{C:()=>O});var f=a(6895),v=a(4650);let O=(()=>{class h{static#e=this.\u0275fac=function(_){return new(_||h)};static#t=this.\u0275mod=v.oAB({type:h});static#n=this.\u0275inj=v.cJS({imports:[f.ez]})}return h})()},6923:(M,I,a)=>{const f=a(1455)("bittorrent-tracker:client"),v=a(9069),O=a(6389),h=a(7574),b=a(3647),i=a(6643),_=a(5340),y=a(8333),e=a(59),p=a(9282);M.exports=(()=>{class w extends v{constructor(l={}){if(super(),!l.peerId)throw new Error("Option `peerId` is required");if(!l.infoHash)throw new Error("Option `infoHash` is required");if(!l.announce)throw new Error("Option `announce` is required");if(!process.browser&&!l.port)throw new Error("Option `port` is required");this.peerId="string"==typeof l.peerId?l.peerId:l.peerId.toString("hex"),this._peerIdBuffer=Buffer.from(this.peerId,"hex"),this._peerIdBinary=this._peerIdBuffer.toString("binary"),this.infoHash="string"==typeof l.infoHash?l.infoHash.toLowerCase():l.infoHash.toString("hex"),this._infoHashBuffer=Buffer.from(this.infoHash,"hex"),this._infoHashBinary=this._infoHashBuffer.toString("binary"),f("new client %s",this.infoHash),this.destroyed=!1,this._port=l.port,this._getAnnounceOpts=l.getAnnounceOpts,this._rtcConfig=l.rtcConfig,this._userAgent=l.userAgent,this._proxyOpts=l.proxyOpts,this._wrtc="function"==typeof l.wrtc?l.wrtc():l.wrtc;let n="string"==typeof l.announce?[l.announce]:null==l.announce?[]:l.announce;n=n.map(r=>("/"===(r=r.toString())[r.length-1]&&(r=r.substring(0,r.length-1)),r)),n=Array.from(new Set(n));const E=!1!==this._wrtc&&(!!this._wrtc||b.WEBRTC_SUPPORT),d=r=>{i(()=>{this.emit("warning",r)})};this._trackers=n.map(r=>{let t;try{t=_.parseUrl(r)}catch{return d(new Error(`Invalid tracker URL: ${r}`)),null}const u=t.port;if(u<0||u>65535)return d(new Error(`Invalid tracker port: ${r}`)),null;const T=t.protocol;return"http:"!==T&&"https:"!==T||"function"!=typeof y?"udp:"===T&&"function"==typeof e?new e(this,r):"ws:"!==T&&"wss:"!==T||!E||"ws:"===T&&typeof window<"u"&&"https:"===window.location.protocol?(d(new Error(`Unsupported tracker protocol: ${r}`)),null):new p(this,r):new y(this,r)}).filter(Boolean)}start(l){(l=this._defaultAnnounceOpts(l)).event="started",f("send `start` %o",l),this._announce(l),this._trackers.forEach(n=>{n.setInterval()})}stop(l){(l=this._defaultAnnounceOpts(l)).event="stopped",f("send `stop` %o",l),this._announce(l)}complete(l){l||(l={}),(l=this._defaultAnnounceOpts(l)).event="completed",f("send `complete` %o",l),this._announce(l)}update(l){(l=this._defaultAnnounceOpts(l)).event&&delete l.event,f("send `update` %o",l),this._announce(l)}_announce(l){this._trackers.forEach(n=>{n.announce(l)})}scrape(l){f("send `scrape`"),l||(l={}),this._trackers.forEach(n=>{n.scrape(l)})}setInterval(l){f("setInterval %d",l),this._trackers.forEach(n=>{n.setInterval(l)})}destroy(l){if(this.destroyed)return;this.destroyed=!0,f("destroy");const n=this._trackers.map(E=>d=>{E.destroy(d)});h(n,l),this._trackers=[],this._getAnnounceOpts=null}_defaultAnnounceOpts(l={}){return null==l.numwant&&(l.numwant=_.DEFAULT_ANNOUNCE_PEERS),null==l.uploaded&&(l.uploaded=0),null==l.downloaded&&(l.downloaded=0),this._getAnnounceOpts&&(l=Object.assign({},l,this._getAnnounceOpts())),l}}return w.scrape=(m,l)=>{if(l=O(l),!m.infoHash)throw new Error("Option `infoHash` is required");if(!m.announce)throw new Error("Option `announce` is required");const n=Object.assign({},m,{infoHash:Array.isArray(m.infoHash)?m.infoHash[0]:m.infoHash,peerId:Buffer.from("01234567890123456789"),port:6881}),E=new w(n);E.once("error",l),E.once("warning",l);let d=Array.isArray(m.infoHash)?m.infoHash.length:1;const r={};return E.on("scrape",t=>{if(d-=1,r[t.infoHash]=t,0===d){E.destroy();const u=Object.keys(r);l(null,1===u.length?r[u[0]]:r)}}),m.infoHash=Array.isArray(m.infoHash)?m.infoHash.map(t=>Buffer.from(t,"hex")):Buffer.from(m.infoHash,"hex"),E.scrape({infoHash:m.infoHash}),E},w})()},1765:(M,I,a)=>{const f=a(9069);M.exports=class v extends f{constructor(h,b){super(),this.client=h,this.announceUrl=b,this.interval=null,this.destroyed=!1}setInterval(h){null==h&&(h=this.DEFAULT_ANNOUNCE_INTERVAL),clearInterval(this.interval),h&&(this.interval=setInterval(()=>{this.announce(this.client._defaultAnnounceOpts())},h),this.interval.unref&&this.interval.unref())}}},9282:(M,I,a)=>{const f=a(6055),v=a(1455)("bittorrent-tracker:websocket-tracker"),O=a(3647),h=a(3753),b=a(1808),i=a(5732),_=a(5340),y=a(1765),e={},m=5e4;class l extends y{constructor(d,r){super(d,r),v("new websocket tracker %s",r),this.peers={},this.socket=null,this.reconnecting=!1,this.retries=0,this.reconnectTimer=null,this.expectingResponse=!1,this._openSocket()}announce(d){if(this.destroyed||this.reconnecting)return;if(!this.socket.connected)return void this.socket.once("connect",()=>{this.announce(d)});const r=Object.assign({},d,{action:"announce",info_hash:this.client._infoHashBinary,peer_id:this.client._peerIdBinary});if(this._trackerId&&(r.trackerid=this._trackerId),"stopped"===d.event||"completed"===d.event)this._send(r);else{const t=Math.min(d.numwant,5);this._generateOffers(t,u=>{r.numwant=t,r.offers=u,this._send(r)})}}scrape(d){if(this.destroyed||this.reconnecting)return;if(!this.socket.connected)return void this.socket.once("connect",()=>{this.scrape(d)});const t={action:"scrape",info_hash:Array.isArray(d.infoHash)&&d.infoHash.length>0?d.infoHash.map(u=>u.toString("binary")):d.infoHash&&d.infoHash.toString("binary")||this.client._infoHashBinary};this._send(t)}destroy(d=n){if(this.destroyed)return d(null);this.destroyed=!0,clearInterval(this.interval),clearTimeout(this.reconnectTimer);for(const T in this.peers){const S=this.peers[T];clearTimeout(S.trackerTimeout),S.destroy()}if(this.peers=null,this.socket&&(this.socket.removeListener("connect",this._onSocketConnectBound),this.socket.removeListener("data",this._onSocketDataBound),this.socket.removeListener("close",this._onSocketCloseBound),this.socket.removeListener("error",this._onSocketErrorBound),this.socket=null),this._onSocketConnectBound=null,this._onSocketErrorBound=null,this._onSocketDataBound=null,this._onSocketCloseBound=null,e[this.announceUrl]&&(e[this.announceUrl].consumers-=1),e[this.announceUrl].consumers>0)return d();let t,r=e[this.announceUrl];if(delete e[this.announceUrl],r.on("error",n),r.once("close",d),!this.expectingResponse)return u();function u(){t&&(clearTimeout(t),t=null),r.removeListener("data",u),r.destroy(),r=null}t=setTimeout(u,_.DESTROY_TIMEOUT),r.once("data",u)}_openSocket(){if(this.destroyed=!1,this.peers||(this.peers={}),this._onSocketConnectBound=()=>{this._onSocketConnect()},this._onSocketErrorBound=d=>{this._onSocketError(d)},this._onSocketDataBound=d=>{this._onSocketData(d)},this._onSocketCloseBound=()=>{this._onSocketClose()},this.socket=e[this.announceUrl],this.socket)e[this.announceUrl].consumers+=1,this.socket.connected&&this._onSocketConnectBound();else{const d=new URL(this.announceUrl);let r;this.client._proxyOpts&&(r="wss:"===d.protocol?this.client._proxyOpts.httpsAgent:this.client._proxyOpts.httpAgent,!r&&this.client._proxyOpts.socksProxy&&(r=new i.Agent(f(this.client._proxyOpts.socksProxy),"wss:"===d.protocol))),this.socket=e[this.announceUrl]=new b({url:this.announceUrl,agent:r}),this.socket.consumers=1,this.socket.once("connect",this._onSocketConnectBound)}this.socket.on("data",this._onSocketDataBound),this.socket.once("close",this._onSocketCloseBound),this.socket.once("error",this._onSocketErrorBound)}_onSocketConnect(){this.destroyed||this.reconnecting&&(this.reconnecting=!1,this.retries=0,this.announce(this.client._defaultAnnounceOpts()))}_onSocketData(d){if(!this.destroyed){this.expectingResponse=!1;try{d=JSON.parse(d)}catch{return void this.client.emit("warning",new Error("Invalid tracker response"))}"announce"===d.action?this._onAnnounceResponse(d):"scrape"===d.action?this._onScrapeResponse(d):this._onSocketError(new Error(`invalid action in WS response: ${d.action}`))}}_onAnnounceResponse(d){if(d.info_hash!==this.client._infoHashBinary)return void v("ignoring websocket data from %s for %s (looking for %s: reused socket)",this.announceUrl,_.binaryToHex(d.info_hash),this.client.infoHash);if(d.peer_id&&d.peer_id===this.client._peerIdBinary)return;v("received %s from %s for %s",JSON.stringify(d),this.announceUrl,this.client.infoHash);const r=d["failure reason"];if(r)return this.client.emit("warning",new Error(r));const t=d["warning message"];t&&this.client.emit("warning",new Error(t));const u=d.interval||d["min interval"];u&&this.setInterval(1e3*u);const T=d["tracker id"];if(T&&(this._trackerId=T),null!=d.complete){const D=Object.assign({},d,{announce:this.announceUrl,infoHash:_.binaryToHex(d.info_hash)});this.client.emit("update",D)}let S;if(d.offer&&d.peer_id&&(v("creating peer (from remote offer)"),S=this._createPeer(),S.id=_.binaryToHex(d.peer_id),S.once("signal",D=>{const U={action:"announce",info_hash:this.client._infoHashBinary,peer_id:this.client._peerIdBinary,to_peer_id:d.peer_id,answer:D,offer_id:d.offer_id};this._trackerId&&(U.trackerid=this._trackerId),this._send(U)}),this.client.emit("peer",S),S.signal(d.offer)),d.answer&&d.peer_id){const D=_.binaryToHex(d.offer_id);S=this.peers[D],S?(S.id=_.binaryToHex(d.peer_id),this.client.emit("peer",S),S.signal(d.answer),clearTimeout(S.trackerTimeout),S.trackerTimeout=null,delete this.peers[D]):v(`got unexpected answer: ${JSON.stringify(d.answer)}`)}}_onScrapeResponse(d){d=d.files||{};const r=Object.keys(d);0!==r.length?r.forEach(t=>{const u=Object.assign(d[t],{announce:this.announceUrl,infoHash:_.binaryToHex(t)});this.client.emit("scrape",u)}):this.client.emit("warning",new Error("invalid scrape response"))}_onSocketClose(){this.destroyed||(this.destroy(),this._startReconnectTimer())}_onSocketError(d){this.destroyed||(this.destroy(),this.client.emit("warning",d),this._startReconnectTimer())}_startReconnectTimer(){const d=Math.floor(3e5*Math.random())+Math.min(1e4*Math.pow(2,this.retries),36e5);this.reconnecting=!0,clearTimeout(this.reconnectTimer),this.reconnectTimer=setTimeout(()=>{this.retries++,this._openSocket()},d),this.reconnectTimer.unref&&this.reconnectTimer.unref(),v("reconnecting socket in %s ms",d)}_send(d){if(this.destroyed)return;this.expectingResponse=!0;const r=JSON.stringify(d);v("send %s",r),this.socket.send(r)}_generateOffers(d,r){const t=this,u=[];v("generating %s offers",d);for(let D=0;D<d;++D)T();function T(){const D=h(20).toString("hex");v("creating peer (from _generateOffers)");const U=t.peers[D]=t._createPeer({initiator:!0});U.once("signal",B=>{u.push({offer:B,offer_id:_.hexToBinary(D)}),S()}),U.trackerTimeout=setTimeout(()=>{v("tracker timeout: destroying peer"),U.trackerTimeout=null,delete t.peers[D],U.destroy()},m),U.trackerTimeout.unref&&U.trackerTimeout.unref()}function S(){u.length===d&&(v("generated %s offers",d),r(u))}S()}_createPeer(d){const r=this;d=Object.assign({trickle:!1,config:r.client._rtcConfig,wrtc:r.client._wrtc},d);const t=new O(d);return t.once("error",u),t.once("connect",function T(){t.removeListener("error",u),t.removeListener("connect",T)}),t;function u(S){r.client.emit("warning",new Error(`Connection error: ${S.message}`)),t.destroy()}}}function n(){}l.prototype.DEFAULT_ANNOUNCE_INTERVAL=3e4,l._socketPool=e,M.exports=l},5340:(M,I,a)=>{I.DEFAULT_ANNOUNCE_PEERS=50,I.MAX_ANNOUNCE_PEERS=82,I.binaryToHex=v=>("string"!=typeof v&&(v=String(v)),Buffer.from(v,"binary").toString("hex")),I.hexToBinary=v=>("string"!=typeof v&&(v=String(v)),Buffer.from(v,"hex").toString("binary")),I.parseUrl=v=>{const O=new URL(v.replace(/^udp:/,"http:"));return v.match(/^udp:/)&&Object.defineProperties(O,{href:{value:O.href.replace(/^http/,"udp")},protocol:{value:O.protocol.replace(/^http/,"udp")},origin:{value:O.origin.replace(/^http/,"udp")}}),O};const f=a(3762);Object.assign(I,f)},6055:M=>{var I=function(){"use strict";function a(p,g){return null!=g&&p instanceof g}var f,v,O;try{f=Map}catch{f=function(){}}try{v=Set}catch{v=function(){}}try{O=Promise}catch{O=function(){}}function h(p,g,w,m,l){"object"==typeof g&&(w=g.depth,m=g.prototype,l=g.includeNonEnumerable,g=g.circular);var n=[],E=[],d=typeof Buffer<"u";return typeof g>"u"&&(g=!0),typeof w>"u"&&(w=1/0),function r(t,u){if(null===t)return null;if(0===u)return t;var T,S;if("object"!=typeof t)return t;if(a(t,f))T=new f;else if(a(t,v))T=new v;else if(a(t,O))T=new O(function(Q,q){t.then(function(ee){Q(r(ee,u-1))},function(ee){q(r(ee,u-1))})});else if(h.__isArray(t))T=[];else if(h.__isRegExp(t))T=new RegExp(t.source,e(t)),t.lastIndex&&(T.lastIndex=t.lastIndex);else if(h.__isDate(t))T=new Date(t.getTime());else{if(d&&Buffer.isBuffer(t))return T=Buffer.allocUnsafe?Buffer.allocUnsafe(t.length):new Buffer(t.length),t.copy(T),T;a(t,Error)?T=Object.create(t):typeof m>"u"?(S=Object.getPrototypeOf(t),T=Object.create(S)):(T=Object.create(m),S=m)}if(g){var D=n.indexOf(t);if(-1!=D)return E[D];n.push(t),E.push(T)}for(var U in a(t,f)&&t.forEach(function(Q,q){var ee=r(q,u-1),te=r(Q,u-1);T.set(ee,te)}),a(t,v)&&t.forEach(function(Q){var q=r(Q,u-1);T.add(q)}),t){var B;S&&(B=Object.getOwnPropertyDescriptor(S,U)),(!B||null!=B.set)&&(T[U]=r(t[U],u-1))}if(Object.getOwnPropertySymbols){var N=Object.getOwnPropertySymbols(t);for(U=0;U<N.length;U++){var L=N[U];(W=Object.getOwnPropertyDescriptor(t,L))&&!W.enumerable&&!l||(T[L]=r(t[L],u-1),W.enumerable||Object.defineProperty(T,L,{enumerable:!1}))}}if(l){var V=Object.getOwnPropertyNames(t);for(U=0;U<V.length;U++){var W,X=V[U];(W=Object.getOwnPropertyDescriptor(t,X))&&W.enumerable||(T[X]=r(t[X],u-1),Object.defineProperty(T,X,{enumerable:!1}))}}return T}(p,w)}function b(p){return Object.prototype.toString.call(p)}function e(p){var g="";return p.global&&(g+="g"),p.ignoreCase&&(g+="i"),p.multiline&&(g+="m"),g}return h.clonePrototype=function(g){if(null===g)return null;var w=function(){};return w.prototype=g,new w},h.__objToStr=b,h.__isDate=function i(p){return"object"==typeof p&&"[object Date]"===b(p)},h.__isArray=function _(p){return"object"==typeof p&&"[object Array]"===b(p)},h.__isRegExp=function y(p){return"object"==typeof p&&"[object RegExp]"===b(p)},h.__getRegExpFlags=e,h}();M.exports&&(M.exports=I)},1455:(M,I,a)=>{I.formatArgs=function v(_){if(_[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+_[0]+(this.useColors?"%c ":" ")+"+"+M.exports.humanize(this.diff),!this.useColors)return;const y="color: "+this.color;_.splice(1,0,y,"color: inherit");let e=0,p=0;_[0].replace(/%[a-zA-Z%]/g,g=>{"%%"!==g&&(e++,"%c"===g&&(p=e))}),_.splice(p,0,y)},I.save=function O(_){try{_?I.storage.setItem("debug",_):I.storage.removeItem("debug")}catch{}},I.load=function h(){let _;try{_=I.storage.getItem("debug")}catch{}return!_&&typeof process<"u"&&"env"in process&&(_=process.env.DEBUG),_},I.useColors=function f(){return!(!(typeof window<"u"&&window.process)||"renderer"!==window.process.type&&!window.process.__nwjs)||!(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&(typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},I.storage=function b(){try{return localStorage}catch{}}(),I.destroy=(()=>{let _=!1;return()=>{_||(_=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),I.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],I.log=console.debug||console.log||(()=>{}),M.exports=a(3283)(I);const{formatters:i}=M.exports;i.j=function(_){try{return JSON.stringify(_)}catch(y){return"[UnexpectedJSONParseError]: "+y.message}}},3283:(M,I,a)=>{M.exports=function f(v){function h(w){let m,n,E,l=null;function d(...r){if(!d.enabled)return;const t=d,u=Number(new Date);t.diff=u-(m||u),t.prev=m,t.curr=u,m=u,r[0]=h.coerce(r[0]),"string"!=typeof r[0]&&r.unshift("%O");let S=0;r[0]=r[0].replace(/%([a-zA-Z%])/g,(U,B)=>{if("%%"===U)return"%";S++;const N=h.formatters[B];return"function"==typeof N&&(U=N.call(t,r[S]),r.splice(S,1),S--),U}),h.formatArgs.call(t,r),(t.log||h.log).apply(t,r)}return d.namespace=w,d.useColors=h.useColors(),d.color=h.selectColor(w),d.extend=b,d.destroy=h.destroy,Object.defineProperty(d,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==l?l:(n!==h.namespaces&&(n=h.namespaces,E=h.enabled(w)),E),set:r=>{l=r}}),"function"==typeof h.init&&h.init(d),d}function b(w,m){const l=h(this.namespace+(typeof m>"u"?":":m)+w);return l.log=this.log,l}function e(w){return w.toString().substring(2,w.toString().length-2).replace(/\.\*\?$/,"*")}return h.debug=h,h.default=h,h.coerce=function p(w){return w instanceof Error?w.stack||w.message:w},h.disable=function _(){const w=[...h.names.map(e),...h.skips.map(e).map(m=>"-"+m)].join(",");return h.enable(""),w},h.enable=function i(w){let m;h.save(w),h.namespaces=w,h.names=[],h.skips=[];const l=("string"==typeof w?w:"").split(/[\s,]+/),n=l.length;for(m=0;m<n;m++)l[m]&&("-"===(w=l[m].replace(/\*/g,".*?"))[0]?h.skips.push(new RegExp("^"+w.slice(1)+"$")):h.names.push(new RegExp("^"+w+"$")))},h.enabled=function y(w){if("*"===w[w.length-1])return!0;let m,l;for(m=0,l=h.skips.length;m<l;m++)if(h.skips[m].test(w))return!1;for(m=0,l=h.names.length;m<l;m++)if(h.names[m].test(w))return!0;return!1},h.humanize=a(4366),h.destroy=function g(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(v).forEach(w=>{h[w]=v[w]}),h.names=[],h.skips=[],h.formatters={},h.selectColor=function O(w){let m=0;for(let l=0;l<w.length;l++)m=(m<<5)-m+w.charCodeAt(l),m|=0;return h.colors[Math.abs(m)%h.colors.length]},h.enable(h.load()),h}},9069:M=>{"use strict";var f,I="object"==typeof Reflect?Reflect:null,a=I&&"function"==typeof I.apply?I.apply:function(u,T,S){return Function.prototype.apply.call(u,T,S)};f=I&&"function"==typeof I.ownKeys?I.ownKeys:Object.getOwnPropertySymbols?function(u){return Object.getOwnPropertyNames(u).concat(Object.getOwnPropertySymbols(u))}:function(u){return Object.getOwnPropertyNames(u)};var O=Number.isNaN||function(u){return u!=u};function h(){h.init.call(this)}M.exports=h,M.exports.once=function E(t,u){return new Promise(function(T,S){function D(B){t.removeListener(u,U),S(B)}function U(){"function"==typeof t.removeListener&&t.removeListener("error",D),T([].slice.call(arguments))}r(t,u,U,{once:!0}),"error"!==u&&function d(t,u,T){"function"==typeof t.on&&r(t,"error",u,T)}(t,D,{once:!0})})},h.EventEmitter=h,h.prototype._events=void 0,h.prototype._eventsCount=0,h.prototype._maxListeners=void 0;var b=10;function i(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function _(t){return void 0===t._maxListeners?h.defaultMaxListeners:t._maxListeners}function y(t,u,T,S){var D,U,B;if(i(T),void 0===(U=t._events)?(U=t._events=Object.create(null),t._eventsCount=0):(void 0!==U.newListener&&(t.emit("newListener",u,T.listener?T.listener:T),U=t._events),B=U[u]),void 0===B)B=U[u]=T,++t._eventsCount;else if("function"==typeof B?B=U[u]=S?[T,B]:[B,T]:S?B.unshift(T):B.push(T),(D=_(t))>0&&B.length>D&&!B.warned){B.warned=!0;var N=new Error("Possible EventEmitter memory leak detected. "+B.length+" "+String(u)+" listeners added. Use emitter.setMaxListeners() to increase limit");N.name="MaxListenersExceededWarning",N.emitter=t,N.type=u,N.count=B.length,function v(t){console&&console.warn&&console.warn(t)}(N)}return t}function e(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(t,u,T){var S={fired:!1,wrapFn:void 0,target:t,type:u,listener:T},D=e.bind(S);return D.listener=T,S.wrapFn=D,D}function g(t,u,T){var S=t._events;if(void 0===S)return[];var D=S[u];return void 0===D?[]:"function"==typeof D?T?[D.listener||D]:[D]:T?function n(t){for(var u=new Array(t.length),T=0;T<u.length;++T)u[T]=t[T].listener||t[T];return u}(D):m(D,D.length)}function w(t){var u=this._events;if(void 0!==u){var T=u[t];if("function"==typeof T)return 1;if(void 0!==T)return T.length}return 0}function m(t,u){for(var T=new Array(u),S=0;S<u;++S)T[S]=t[S];return T}function r(t,u,T,S){if("function"==typeof t.on)S.once?t.once(u,T):t.on(u,T);else{if("function"!=typeof t.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t);t.addEventListener(u,function D(U){S.once&&t.removeEventListener(u,D),T(U)})}}Object.defineProperty(h,"defaultMaxListeners",{enumerable:!0,get:function(){return b},set:function(t){if("number"!=typeof t||t<0||O(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");b=t}}),h.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},h.prototype.setMaxListeners=function(u){if("number"!=typeof u||u<0||O(u))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+u+".");return this._maxListeners=u,this},h.prototype.getMaxListeners=function(){return _(this)},h.prototype.emit=function(u){for(var T=[],S=1;S<arguments.length;S++)T.push(arguments[S]);var D="error"===u,U=this._events;if(void 0!==U)D=D&&void 0===U.error;else if(!D)return!1;if(D){var B;if(T.length>0&&(B=T[0]),B instanceof Error)throw B;var N=new Error("Unhandled error."+(B?" ("+B.message+")":""));throw N.context=B,N}var L=U[u];if(void 0===L)return!1;if("function"==typeof L)a(L,this,T);else{var W=L.length,V=m(L,W);for(S=0;S<W;++S)a(V[S],this,T)}return!0},h.prototype.on=h.prototype.addListener=function(u,T){return y(this,u,T,!1)},h.prototype.prependListener=function(u,T){return y(this,u,T,!0)},h.prototype.once=function(u,T){return i(T),this.on(u,p(this,u,T)),this},h.prototype.prependOnceListener=function(u,T){return i(T),this.prependListener(u,p(this,u,T)),this},h.prototype.off=h.prototype.removeListener=function(u,T){var S,D,U,B,N;if(i(T),void 0===(D=this._events))return this;if(void 0===(S=D[u]))return this;if(S===T||S.listener===T)0==--this._eventsCount?this._events=Object.create(null):(delete D[u],D.removeListener&&this.emit("removeListener",u,S.listener||T));else if("function"!=typeof S){for(U=-1,B=S.length-1;B>=0;B--)if(S[B]===T||S[B].listener===T){N=S[B].listener,U=B;break}if(U<0)return this;0===U?S.shift():function l(t,u){for(;u+1<t.length;u++)t[u]=t[u+1];t.pop()}(S,U),1===S.length&&(D[u]=S[0]),void 0!==D.removeListener&&this.emit("removeListener",u,N||T)}return this},h.prototype.removeAllListeners=function(u){var T,S,D;if(void 0===(S=this._events))return this;if(void 0===S.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==S[u]&&(0==--this._eventsCount?this._events=Object.create(null):delete S[u]),this;if(0===arguments.length){var B,U=Object.keys(S);for(D=0;D<U.length;++D)"removeListener"!==(B=U[D])&&this.removeAllListeners(B);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(T=S[u]))this.removeListener(u,T);else if(void 0!==T)for(D=T.length-1;D>=0;D--)this.removeListener(u,T[D]);return this},h.prototype.listeners=function(u){return g(this,u,!0)},h.prototype.rawListeners=function(u){return g(this,u,!1)},h.listenerCount=function(t,u){return"function"==typeof t.listenerCount?t.listenerCount(u):w.call(t,u)},h.prototype.listenerCount=w,h.prototype.eventNames=function(){return this._eventsCount>0?f(this._events):[]}},5855:M=>{M.exports=function(){if(typeof globalThis>"u")return null;var a={RTCPeerConnection:globalThis.RTCPeerConnection||globalThis.mozRTCPeerConnection||globalThis.webkitRTCPeerConnection,RTCSessionDescription:globalThis.RTCSessionDescription||globalThis.mozRTCSessionDescription||globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate||globalThis.mozRTCIceCandidate||globalThis.webkitRTCIceCandidate};return a.RTCPeerConnection?a:null}},9076:(M,I,a)=>{"use strict";var f=a(7156).default;const v=a(8202),O=a(9069).EventEmitter,h=a(6643);M.exports=class b extends O{constructor(_,y){if(y||(y={}),super(),this.chunkLength=Number(_),!this.chunkLength)throw new Error("First argument must be a chunk length");this.closed=!1,this.destroyed=!1,this.length=Number(y.length)||1/0,this.name=y.name||"idb-chunk-store",this.length!==1/0&&(this.lastChunkLength=this.length%this.chunkLength||this.chunkLength,this.lastChunkIndex=Math.ceil(this.length/this.chunkLength)-1),this.dbPromise=v.openDB(this.name,void 0,{upgrade:e=>{e.createObjectStore("chunks")},blocking:()=>{this.close()},terminated:()=>{this.closed=!0,this.emit("error",new Error("Database unexpectedly closed"))}})}put(_,y,e=(()=>{})){var p=this;if(this.closed)return h(()=>e(new Error("Storage is closed")));const g=_===this.lastChunkIndex;return g&&y.length!==this.lastChunkLength?h(()=>e(new Error("Last chunk length must be "+this.lastChunkLength))):g||y.length===this.chunkLength?((0!==(y=new Uint8Array(y.buffer,y.byteOffset,y.byteLength)).byteOffset||y.byteLength!==y.buffer.byteLength)&&(y=y.slice()),void f(function*(){try{yield(yield p.dbPromise).put("chunks",y,_)}catch(w){return void e(w)}e(null)})()):h(()=>e(new Error("Chunk length must be "+this.chunkLength)))}get(_,y,e=(()=>{})){var p=this;return"function"==typeof y?this.get(_,{},y):(y||(y={}),this.closed?h(()=>e(new Error("Storage is closed"))):void f(function*(){let g;try{g=yield(yield p.dbPromise).get("chunks",_)}catch(n){return void e(n)}if(null==g){const n=new Error("Chunk not found");return n.notFound=!0,void e(n)}let w=Buffer.from(g.buffer,g.byteOffset,g.byteLength);const m=y.offset||0,l=y.length||w.length-m;(0!==m||l!==w.length)&&(w=w.slice(m,l+m)),e(null,w)})())}close(_=(()=>{})){var y=this;if(this.closed)return h(()=>_(new Error("Storage is closed")));this.closed=!0,f(function*(){try{(yield y.dbPromise).close()}catch(e){return void _(e)}_(null)})()}destroy(_=(()=>{})){var y=this;return this.closed?h(()=>_(new Error("Storage is closed"))):this.destroyed?h(()=>_(new Error("Storage is destroyed"))):(this.destroyed=!0,void this.close(function(){var e=f(function*(p){if(p)_(p);else{try{yield v.deleteDB(y.name)}catch(g){return void _(g)}_(null)}});return function(p){return e.apply(this,arguments)}}()))}}},8202:(M,I,a)=>{"use strict";a.r(I),a.d(I,{deleteDB:()=>T,openDB:()=>u,unwrap:()=>t,wrap:()=>r});var f=a(5861);const v=(N,L)=>L.some(W=>N instanceof W);let O,h;const _=new WeakMap,y=new WeakMap,e=new WeakMap,p=new WeakMap,g=new WeakMap;let l={get(N,L,W){if(N instanceof IDBTransaction){if("done"===L)return y.get(N);if("objectStoreNames"===L)return N.objectStoreNames||e.get(N);if("store"===L)return W.objectStoreNames[1]?void 0:W.objectStore(W.objectStoreNames[0])}return r(N[L])},set:(N,L,W)=>(N[L]=W,!0),has:(N,L)=>N instanceof IDBTransaction&&("done"===L||"store"===L)||L in N};function d(N){return"function"==typeof N?function E(N){return N!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function i(){return h||(h=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(N)?function(...L){return N.apply(t(this),L),r(_.get(this))}:function(...L){return r(N.apply(t(this),L))}:function(L,...W){const V=N.call(t(this),L,...W);return e.set(V,L.sort?L.sort():[L]),r(V)}}(N):(N instanceof IDBTransaction&&function m(N){if(y.has(N))return;const L=new Promise((W,V)=>{const X=()=>{N.removeEventListener("complete",Q),N.removeEventListener("error",q),N.removeEventListener("abort",q)},Q=()=>{W(),X()},q=()=>{V(N.error||new DOMException("AbortError","AbortError")),X()};N.addEventListener("complete",Q),N.addEventListener("error",q),N.addEventListener("abort",q)});y.set(N,L)}(N),v(N,function b(){return O||(O=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(N,l):N)}function r(N){if(N instanceof IDBRequest)return function w(N){const L=new Promise((W,V)=>{const X=()=>{N.removeEventListener("success",Q),N.removeEventListener("error",q)},Q=()=>{W(r(N.result)),X()},q=()=>{V(N.error),X()};N.addEventListener("success",Q),N.addEventListener("error",q)});return L.then(W=>{W instanceof IDBCursor&&_.set(W,N)}).catch(()=>{}),g.set(L,N),L}(N);if(p.has(N))return p.get(N);const L=d(N);return L!==N&&(p.set(N,L),g.set(L,N)),L}const t=N=>g.get(N);function u(N,L,{blocked:W,upgrade:V,blocking:X,terminated:Q}={}){const q=indexedDB.open(N,L),ee=r(q);return V&&q.addEventListener("upgradeneeded",te=>{V(r(q.result),te.oldVersion,te.newVersion,r(q.transaction))}),W&&q.addEventListener("blocked",()=>W()),ee.then(te=>{Q&&te.addEventListener("close",()=>Q()),X&&te.addEventListener("versionchange",()=>X())}).catch(()=>{}),ee}function T(N,{blocked:L}={}){const W=indexedDB.deleteDatabase(N);return L&&W.addEventListener("blocked",()=>L()),r(W).then(()=>{})}const S=["get","getKey","getAll","getAllKeys","count"],D=["put","add","delete","clear"],U=new Map;function B(N,L){if(!(N instanceof IDBDatabase)||L in N||"string"!=typeof L)return;if(U.get(L))return U.get(L);const W=L.replace(/FromIndex$/,""),V=L!==W,X=D.includes(W);if(!(W in(V?IDBIndex:IDBObjectStore).prototype)||!X&&!S.includes(W))return;const Q=function(){var q=(0,f.Z)(function*(ee,...te){const ie=this.transaction(ee,X?"readwrite":"readonly");let se=ie.store;return V&&(se=se.index(te.shift())),(yield Promise.all([se[W](...te),X&&ie.done]))[0]});return function(te){return q.apply(this,arguments)}}();return U.set(L,Q),Q}!function n(N){l=N(l)}(N=>({...N,get:(L,W,V)=>B(L,W)||N.get(L,W,V),has:(L,W)=>!!B(L,W)||N.has(L,W)}))},3894:M=>{M.exports="function"==typeof Object.create?function(a,f){f&&(a.super_=f,a.prototype=Object.create(f.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}))}:function(a,f){if(f){a.super_=f;var v=function(){};v.prototype=f.prototype,a.prototype=new v,a.prototype.constructor=a}}},4366:M=>{var I=1e3,a=60*I,f=60*a,v=24*f;function y(e,p,g,w){var m=p>=1.5*g;return Math.round(e/g)+" "+w+(m?"s":"")}M.exports=function(e,p){p=p||{};var g=typeof e;if("string"===g&&e.length>0)return function b(e){if(!((e=String(e)).length>100)){var p=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(p){var g=parseFloat(p[1]);switch((p[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*g;case"weeks":case"week":case"w":return 6048e5*g;case"days":case"day":case"d":return g*v;case"hours":case"hour":case"hrs":case"hr":case"h":return g*f;case"minutes":case"minute":case"mins":case"min":case"m":return g*a;case"seconds":case"second":case"secs":case"sec":case"s":return g*I;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return g;default:return}}}}(e);if("number"===g&&isFinite(e))return p.long?function _(e){var p=Math.abs(e);return p>=v?y(e,p,v,"day"):p>=f?y(e,p,f,"hour"):p>=a?y(e,p,a,"minute"):p>=I?y(e,p,I,"second"):e+" ms"}(e):function i(e){var p=Math.abs(e);return p>=v?Math.round(e/v)+"d":p>=f?Math.round(e/f)+"h":p>=a?Math.round(e/a)+"m":p>=I?Math.round(e/I)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},6389:(M,I,a)=>{var f=a(9136);function v(h){var b=function(){return b.called?b.value:(b.called=!0,b.value=h.apply(this,arguments))};return b.called=!1,b}function O(h){var b=function(){if(b.called)throw new Error(b.onceError);return b.called=!0,b.value=h.apply(this,arguments)};return b.onceError=(h.name||"Function wrapped with `once`")+" shouldn't be called more than once",b.called=!1,b}M.exports=f(v),M.exports.strict=f(O),v.proto=v(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return v(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return O(this)},configurable:!0})})},6643:M=>{let I;M.exports="function"==typeof queueMicrotask?queueMicrotask.bind(typeof window<"u"?window:global):a=>(I||(I=Promise.resolve())).then(a).catch(f=>setTimeout(()=>{throw f},0))},3753:(M,I,a)=>{"use strict";var f=65536,h=a(3502).Buffer,b=global.crypto||global.msCrypto;M.exports=b&&b.getRandomValues?function i(_,y){if(_>4294967295)throw new RangeError("requested too many random bytes");var e=h.allocUnsafe(_);if(_>0)if(_>f)for(var p=0;p<_;p+=f)b.getRandomValues(e.slice(p,p+f));else b.getRandomValues(e);return"function"==typeof y?process.nextTick(function(){y(null,e)}):e}:function O(){throw new Error("Secure random number generation is not supported by this browser.\nUse Chrome, Firefox or Internet Explorer 11")}},891:M=>{"use strict";var a={};function f(i,_,y){y||(y=Error);var p=function(g){function w(m,l,n){return g.call(this,function e(g,w,m){return"string"==typeof _?_:_(g,w,m)}(m,l,n))||this}return function I(i,_){i.prototype=Object.create(_.prototype),i.prototype.constructor=i,i.__proto__=_}(w,g),w}(y);p.prototype.name=y.name,p.prototype.code=i,a[i]=p}function v(i,_){if(Array.isArray(i)){var y=i.length;return i=i.map(function(e){return String(e)}),y>2?"one of ".concat(_," ").concat(i.slice(0,y-1).join(", "),", or ")+i[y-1]:2===y?"one of ".concat(_," ").concat(i[0]," or ").concat(i[1]):"of ".concat(_," ").concat(i[0])}return"of ".concat(_," ").concat(String(i))}f("ERR_INVALID_OPT_VALUE",function(i,_){return'The value "'+_+'" is invalid for option "'+i+'"'},TypeError),f("ERR_INVALID_ARG_TYPE",function(i,_,y){var e,p;if("string"==typeof _&&function O(i,_,y){return i.substr(!y||y<0?0:+y,_.length)===_}(_,"not ")?(e="must not be",_=_.replace(/^not /,"")):e="must be",function h(i,_,y){return(void 0===y||y>i.length)&&(y=i.length),i.substring(y-_.length,y)===_}(i," argument"))p="The ".concat(i," ").concat(e," ").concat(v(_,"type"));else{var g=function b(i,_,y){return"number"!=typeof y&&(y=0),!(y+_.length>i.length)&&-1!==i.indexOf(_,y)}(i,".")?"property":"argument";p='The "'.concat(i,'" ').concat(g," ").concat(e," ").concat(v(_,"type"))}return p+". Received type ".concat(typeof y)},TypeError),f("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),f("ERR_METHOD_NOT_IMPLEMENTED",function(i){return"The "+i+" method is not implemented"}),f("ERR_STREAM_PREMATURE_CLOSE","Premature close"),f("ERR_STREAM_DESTROYED",function(i){return"Cannot call "+i+" after a stream was destroyed"}),f("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),f("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),f("ERR_STREAM_WRITE_AFTER_END","write after end"),f("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),f("ERR_UNKNOWN_ENCODING",function(i){return"Unknown encoding: "+i},TypeError),f("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),M.exports.q=a},1339:(M,I,a)=>{"use strict";var f=Object.keys||function(p){var g=[];for(var w in p)g.push(w);return g};M.exports=_;var v=a(3154),O=a(520);a(3894)(_,v);for(var h=f(O.prototype),b=0;b<h.length;b++){var i=h[b];_.prototype[i]||(_.prototype[i]=O.prototype[i])}function _(p){if(!(this instanceof _))return new _(p);v.call(this,p),O.call(this,p),this.allowHalfOpen=!0,p&&(!1===p.readable&&(this.readable=!1),!1===p.writable&&(this.writable=!1),!1===p.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",y)))}function y(){this._writableState.ended||process.nextTick(e,this)}function e(p){p.end()}Object.defineProperty(_.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(_.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(_.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(_.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(g){void 0===this._readableState||void 0===this._writableState||(this._readableState.destroyed=g,this._writableState.destroyed=g)}})},6071:(M,I,a)=>{"use strict";M.exports=v;var f=a(6025);function v(O){if(!(this instanceof v))return new v(O);f.call(this,O)}a(3894)(v,f),v.prototype._transform=function(O,h,b){b(null,O)}},3154:(M,I,a)=>{"use strict";var f;M.exports=L,L.ReadableState=N,a(9069);var p,O=function(s,k){return s.listeners(k).length},h=a(4970),b=a(3172).Buffer,i=global.Uint8Array||function(){},e=a(4616);p=e&&e.debuglog?e.debuglog("stream"):function(){};var u,T,S,g=a(5019),w=a(1920),l=a(7102).getHighWaterMark,n=a(891).q,E=n.ERR_INVALID_ARG_TYPE,d=n.ERR_STREAM_PUSH_AFTER_EOF,r=n.ERR_METHOD_NOT_IMPLEMENTED,t=n.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;a(3894)(L,h);var D=w.errorOrDestroy,U=["error","close","destroy","pause","resume"];function N(o,s,k){f=f||a(1339),"boolean"!=typeof k&&(k=s instanceof f),this.objectMode=!!(o=o||{}).objectMode,k&&(this.objectMode=this.objectMode||!!o.readableObjectMode),this.highWaterMark=l(this,o,"readableHighWaterMark",k),this.buffer=new g,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==o.emitClose,this.autoDestroy=!!o.autoDestroy,this.destroyed=!1,this.defaultEncoding=o.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,o.encoding&&(u||(u=a(3054).s),this.decoder=new u(o.encoding),this.encoding=o.encoding)}function L(o){if(f=f||a(1339),!(this instanceof L))return new L(o);this._readableState=new N(o,this,this instanceof f),this.readable=!0,o&&("function"==typeof o.read&&(this._read=o.read),"function"==typeof o.destroy&&(this._destroy=o.destroy)),h.call(this)}function W(o,s,k,H,z){p("readableAddChunk",s);var K,Y=o._readableState;if(null===s)Y.reading=!1,function te(o,s){if(p("onEofChunk"),!s.ended){if(s.decoder){var k=s.decoder.end();k&&k.length&&(s.buffer.push(k),s.length+=s.objectMode?1:k.length)}s.ended=!0,s.sync?ie(o):(s.needReadable=!1,s.emittedReadable||(s.emittedReadable=!0,se(o)))}}(o,Y);else if(z||(K=function X(o,s){var k;return!function y(o){return b.isBuffer(o)||o instanceof i}(s)&&"string"!=typeof s&&void 0!==s&&!o.objectMode&&(k=new E("chunk",["string","Buffer","Uint8Array"],s)),k}(Y,s)),K)D(o,K);else if(Y.objectMode||s&&s.length>0)if("string"!=typeof s&&!Y.objectMode&&Object.getPrototypeOf(s)!==b.prototype&&(s=function _(o){return b.from(o)}(s)),H)Y.endEmitted?D(o,new t):V(o,Y,s,!0);else if(Y.ended)D(o,new d);else{if(Y.destroyed)return!1;Y.reading=!1,Y.decoder&&!k?(s=Y.decoder.write(s),Y.objectMode||0!==s.length?V(o,Y,s,!1):le(o,Y)):V(o,Y,s,!1)}else H||(Y.reading=!1,le(o,Y));return!Y.ended&&(Y.length<Y.highWaterMark||0===Y.length)}function V(o,s,k,H){s.flowing&&0===s.length&&!s.sync?(s.awaitDrain=0,o.emit("data",k)):(s.length+=s.objectMode?1:k.length,H?s.buffer.unshift(k):s.buffer.push(k),s.needReadable&&ie(o)),le(o,s)}Object.defineProperty(L.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(s){this._readableState&&(this._readableState.destroyed=s)}}),L.prototype.destroy=w.destroy,L.prototype._undestroy=w.undestroy,L.prototype._destroy=function(o,s){s(o)},L.prototype.push=function(o,s){var H,k=this._readableState;return k.objectMode?H=!0:"string"==typeof o&&((s=s||k.defaultEncoding)!==k.encoding&&(o=b.from(o,s),s=""),H=!0),W(this,o,s,!1,H)},L.prototype.unshift=function(o){return W(this,o,null,!0,!1)},L.prototype.isPaused=function(){return!1===this._readableState.flowing},L.prototype.setEncoding=function(o){u||(u=a(3054).s);var s=new u(o);this._readableState.decoder=s,this._readableState.encoding=this._readableState.decoder.encoding;for(var k=this._readableState.buffer.head,H="";null!==k;)H+=s.write(k.data),k=k.next;return this._readableState.buffer.clear(),""!==H&&this._readableState.buffer.push(H),this._readableState.length=H.length,this};var Q=1073741824;function ee(o,s){return o<=0||0===s.length&&s.ended?0:s.objectMode?1:o!=o?s.flowing&&s.length?s.buffer.head.data.length:s.length:(o>s.highWaterMark&&(s.highWaterMark=function q(o){return o>=Q?o=Q:(o--,o|=o>>>1,o|=o>>>2,o|=o>>>4,o|=o>>>8,o|=o>>>16,o++),o}(o)),o<=s.length?o:s.ended?s.length:(s.needReadable=!0,0))}function ie(o){var s=o._readableState;p("emitReadable",s.needReadable,s.emittedReadable),s.needReadable=!1,s.emittedReadable||(p("emitReadable",s.flowing),s.emittedReadable=!0,process.nextTick(se,o))}function se(o){var s=o._readableState;p("emitReadable_",s.destroyed,s.length,s.ended),!s.destroyed&&(s.length||s.ended)&&(o.emit("readable"),s.emittedReadable=!1),s.needReadable=!s.flowing&&!s.ended&&s.length<=s.highWaterMark,R(o)}function le(o,s){s.readingMore||(s.readingMore=!0,process.nextTick(pe,o,s))}function pe(o,s){for(;!s.reading&&!s.ended&&(s.length<s.highWaterMark||s.flowing&&0===s.length);){var k=s.length;if(p("maybeReadMore read 0"),o.read(0),k===s.length)break}s.readingMore=!1}function ge(o){var s=o._readableState;s.readableListening=o.listenerCount("readable")>0,s.resumeScheduled&&!s.paused?s.flowing=!0:o.listenerCount("data")>0&&o.resume()}function ae(o){p("readable nexttick read 0"),o.read(0)}function Te(o,s){p("resume",s.reading),s.reading||o.read(0),s.resumeScheduled=!1,o.emit("resume"),R(o),s.flowing&&!s.reading&&o.read(0)}function R(o){var s=o._readableState;for(p("flow",s.flowing);s.flowing&&null!==o.read(););}function C(o,s){return 0===s.length?null:(s.objectMode?k=s.buffer.shift():!o||o>=s.length?(k=s.decoder?s.buffer.join(""):1===s.buffer.length?s.buffer.first():s.buffer.concat(s.length),s.buffer.clear()):k=s.buffer.consume(o,s.decoder),k);var k}function F(o){var s=o._readableState;p("endReadable",s.endEmitted),s.endEmitted||(s.ended=!0,process.nextTick(Z,s,o))}function Z(o,s){if(p("endReadableNT",o.endEmitted,o.length),!o.endEmitted&&0===o.length&&(o.endEmitted=!0,s.readable=!1,s.emit("end"),o.autoDestroy)){var k=s._writableState;(!k||k.autoDestroy&&k.finished)&&s.destroy()}}function J(o,s){for(var k=0,H=o.length;k<H;k++)if(o[k]===s)return k;return-1}L.prototype.read=function(o){p("read",o),o=parseInt(o,10);var s=this._readableState,k=o;if(0!==o&&(s.emittedReadable=!1),0===o&&s.needReadable&&((0!==s.highWaterMark?s.length>=s.highWaterMark:s.length>0)||s.ended))return p("read: emitReadable",s.length,s.ended),0===s.length&&s.ended?F(this):ie(this),null;if(0===(o=ee(o,s))&&s.ended)return 0===s.length&&F(this),null;var z,H=s.needReadable;return p("need readable",H),(0===s.length||s.length-o<s.highWaterMark)&&p("length less than watermark",H=!0),s.ended||s.reading?p("reading or ended",H=!1):H&&(p("do read"),s.reading=!0,s.sync=!0,0===s.length&&(s.needReadable=!0),this._read(s.highWaterMark),s.sync=!1,s.reading||(o=ee(k,s))),null===(z=o>0?C(o,s):null)?(s.needReadable=s.length<=s.highWaterMark,o=0):(s.length-=o,s.awaitDrain=0),0===s.length&&(s.ended||(s.needReadable=!0),k!==o&&s.ended&&F(this)),null!==z&&this.emit("data",z),z},L.prototype._read=function(o){D(this,new r("_read()"))},L.prototype.pipe=function(o,s){var k=this,H=this._readableState;switch(H.pipesCount){case 0:H.pipes=o;break;case 1:H.pipes=[H.pipes,o];break;default:H.pipes.push(o)}H.pipesCount+=1,p("pipe count=%d opts=%j",H.pipesCount,s);var Y=s&&!1===s.end||o===process.stdout||o===process.stderr?he:ce;function ce(){p("onend"),o.end()}H.endEmitted?process.nextTick(Y):k.once("end",Y),o.on("unpipe",function K(ue,fe){p("onunpipe"),ue===k&&fe&&!1===fe.hasUnpiped&&(fe.hasUnpiped=!0,function Ne(){p("cleanup"),o.removeListener("close",we),o.removeListener("finish",Ce),o.removeListener("drain",_e),o.removeListener("error",ve),o.removeListener("unpipe",K),k.removeListener("end",ce),k.removeListener("end",he),k.removeListener("data",De),Ae=!0,H.awaitDrain&&(!o._writableState||o._writableState.needDrain)&&_e()}())});var _e=function be(o){return function(){var k=o._readableState;p("pipeOnDrain",k.awaitDrain),k.awaitDrain&&k.awaitDrain--,0===k.awaitDrain&&O(o,"data")&&(k.flowing=!0,R(o))}}(k);o.on("drain",_e);var Ae=!1;function De(ue){p("ondata");var fe=o.write(ue);p("dest.write",fe),!1===fe&&((1===H.pipesCount&&H.pipes===o||H.pipesCount>1&&-1!==J(H.pipes,o))&&!Ae&&(p("false write response, pause",H.awaitDrain),H.awaitDrain++),k.pause())}function ve(ue){p("onerror",ue),he(),o.removeListener("error",ve),0===O(o,"error")&&D(o,ue)}function we(){o.removeListener("finish",Ce),he()}function Ce(){p("onfinish"),o.removeListener("close",we),he()}function he(){p("unpipe"),k.unpipe(o)}return k.on("data",De),function B(o,s,k){if("function"==typeof o.prependListener)return o.prependListener(s,k);o._events&&o._events[s]?Array.isArray(o._events[s])?o._events[s].unshift(k):o._events[s]=[k,o._events[s]]:o.on(s,k)}(o,"error",ve),o.once("close",we),o.once("finish",Ce),o.emit("pipe",k),H.flowing||(p("pipe resume"),k.resume()),o},L.prototype.unpipe=function(o){var s=this._readableState,k={hasUnpiped:!1};if(0===s.pipesCount)return this;if(1===s.pipesCount)return o&&o!==s.pipes||(o||(o=s.pipes),s.pipes=null,s.pipesCount=0,s.flowing=!1,o&&o.emit("unpipe",this,k)),this;if(!o){var H=s.pipes,z=s.pipesCount;s.pipes=null,s.pipesCount=0,s.flowing=!1;for(var Y=0;Y<z;Y++)H[Y].emit("unpipe",this,{hasUnpiped:!1});return this}var K=J(s.pipes,o);return-1===K||(s.pipes.splice(K,1),s.pipesCount-=1,1===s.pipesCount&&(s.pipes=s.pipes[0]),o.emit("unpipe",this,k)),this},L.prototype.addListener=L.prototype.on=function(o,s){var k=h.prototype.on.call(this,o,s),H=this._readableState;return"data"===o?(H.readableListening=this.listenerCount("readable")>0,!1!==H.flowing&&this.resume()):"readable"===o&&!H.endEmitted&&!H.readableListening&&(H.readableListening=H.needReadable=!0,H.flowing=!1,H.emittedReadable=!1,p("on readable",H.length,H.reading),H.length?ie(this):H.reading||process.nextTick(ae,this)),k},L.prototype.removeListener=function(o,s){var k=h.prototype.removeListener.call(this,o,s);return"readable"===o&&process.nextTick(ge,this),k},L.prototype.removeAllListeners=function(o){var s=h.prototype.removeAllListeners.apply(this,arguments);return("readable"===o||void 0===o)&&process.nextTick(ge,this),s},L.prototype.resume=function(){var o=this._readableState;return o.flowing||(p("resume"),o.flowing=!o.readableListening,function Ee(o,s){s.resumeScheduled||(s.resumeScheduled=!0,process.nextTick(Te,o,s))}(this,o)),o.paused=!1,this},L.prototype.pause=function(){return p("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(p("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},L.prototype.wrap=function(o){var s=this,k=this._readableState,H=!1;for(var z in o.on("end",function(){if(p("wrapped end"),k.decoder&&!k.ended){var K=k.decoder.end();K&&K.length&&s.push(K)}s.push(null)}),o.on("data",function(K){p("wrapped data"),k.decoder&&(K=k.decoder.write(K)),k.objectMode&&null==K||!(k.objectMode||K&&K.length)||s.push(K)||(H=!0,o.pause())}),o)void 0===this[z]&&"function"==typeof o[z]&&(this[z]=function(ce){return function(){return o[ce].apply(o,arguments)}}(z));for(var Y=0;Y<U.length;Y++)o.on(U[Y],this.emit.bind(this,U[Y]));return this._read=function(K){p("wrapped _read",K),H&&(H=!1,o.resume())},this},"function"==typeof Symbol&&(L.prototype[Symbol.asyncIterator]=function(){return void 0===T&&(T=a(6116)),T(this)}),Object.defineProperty(L.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(L.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(L.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(s){this._readableState&&(this._readableState.flowing=s)}}),L._fromList=C,Object.defineProperty(L.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(L.from=function(o,s){return void 0===S&&(S=a(6200)),S(L,o,s)})},6025:(M,I,a)=>{"use strict";M.exports=y;var f=a(891).q,v=f.ERR_METHOD_NOT_IMPLEMENTED,O=f.ERR_MULTIPLE_CALLBACK,h=f.ERR_TRANSFORM_ALREADY_TRANSFORMING,b=f.ERR_TRANSFORM_WITH_LENGTH_0,i=a(1339);function _(g,w){var m=this._transformState;m.transforming=!1;var l=m.writecb;if(null===l)return this.emit("error",new O);m.writechunk=null,m.writecb=null,null!=w&&this.push(w),l(g);var n=this._readableState;n.reading=!1,(n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}function y(g){if(!(this instanceof y))return new y(g);i.call(this,g),this._transformState={afterTransform:_.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,g&&("function"==typeof g.transform&&(this._transform=g.transform),"function"==typeof g.flush&&(this._flush=g.flush)),this.on("prefinish",e)}function e(){var g=this;"function"!=typeof this._flush||this._readableState.destroyed?p(this,null,null):this._flush(function(w,m){p(g,w,m)})}function p(g,w,m){if(w)return g.emit("error",w);if(null!=m&&g.push(m),g._writableState.length)throw new b;if(g._transformState.transforming)throw new h;return g.push(null)}a(3894)(y,i),y.prototype.push=function(g,w){return this._transformState.needTransform=!1,i.prototype.push.call(this,g,w)},y.prototype._transform=function(g,w,m){m(new v("_transform()"))},y.prototype._write=function(g,w,m){var l=this._transformState;if(l.writecb=m,l.writechunk=g,l.writeencoding=w,!l.transforming){var n=this._readableState;(l.needTransform||n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}},y.prototype._read=function(g){var w=this._transformState;null===w.writechunk||w.transforming?w.needTransform=!0:(w.transforming=!0,this._transform(w.writechunk,w.writeencoding,w.afterTransform))},y.prototype._destroy=function(g,w){i.prototype._destroy.call(this,g,function(m){w(m)})}},520:(M,I,a)=>{"use strict";function v(R){var C=this;this.next=null,this.entry=null,this.finish=function(){!function Te(R,C,F){var Z=R.entry;for(R.entry=null;Z;){var J=Z.callback;C.pendingcb--,J(F),Z=Z.next}C.corkedRequestsFree.next=R}(C,R)}}var O;M.exports=N,N.WritableState=U;var B,h={deprecate:a(4364)},b=a(4970),i=a(3172).Buffer,_=global.Uint8Array||function(){},p=a(1920),w=a(7102).getHighWaterMark,m=a(891).q,l=m.ERR_INVALID_ARG_TYPE,n=m.ERR_METHOD_NOT_IMPLEMENTED,E=m.ERR_MULTIPLE_CALLBACK,d=m.ERR_STREAM_CANNOT_PIPE,r=m.ERR_STREAM_DESTROYED,t=m.ERR_STREAM_NULL_VALUES,u=m.ERR_STREAM_WRITE_AFTER_END,T=m.ERR_UNKNOWN_ENCODING,S=p.errorOrDestroy;function D(){}function U(R,C,F){O=O||a(1339),"boolean"!=typeof F&&(F=C instanceof O),this.objectMode=!!(R=R||{}).objectMode,F&&(this.objectMode=this.objectMode||!!R.writableObjectMode),this.highWaterMark=w(this,R,"writableHighWaterMark",F),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1,this.decodeStrings=!(!1===R.decodeStrings),this.defaultEncoding=R.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(J){!function te(R,C){var F=R._writableState,Z=F.sync,J=F.writecb;if("function"!=typeof J)throw new E;if(function ee(R){R.writing=!1,R.writecb=null,R.length-=R.writelen,R.writelen=0}(F),C)!function q(R,C,F,Z,J){--C.pendingcb,F?(process.nextTick(J,Z),process.nextTick(ae,R,C),R._writableState.errorEmitted=!0,S(R,Z)):(J(Z),R._writableState.errorEmitted=!0,S(R,Z),ae(R,C))}(R,F,Z,C,J);else{var o=pe(F)||R.destroyed;!o&&!F.corked&&!F.bufferProcessing&&F.bufferedRequest&&le(R,F),Z?process.nextTick(ie,R,F,o,J):ie(R,F,o,J)}}(C,J)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==R.emitClose,this.autoDestroy=!!R.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new v(this)}function N(R){var C=this instanceof(O=O||a(1339));if(!C&&!B.call(N,this))return new N(R);this._writableState=new U(R,this,C),this.writable=!0,R&&("function"==typeof R.write&&(this._write=R.write),"function"==typeof R.writev&&(this._writev=R.writev),"function"==typeof R.destroy&&(this._destroy=R.destroy),"function"==typeof R.final&&(this._final=R.final)),b.call(this)}function Q(R,C,F,Z,J,o,s){C.writelen=Z,C.writecb=s,C.writing=!0,C.sync=!0,C.destroyed?C.onwrite(new r("write")):F?R._writev(J,C.onwrite):R._write(J,o,C.onwrite),C.sync=!1}function ie(R,C,F,Z){F||function se(R,C){0===C.length&&C.needDrain&&(C.needDrain=!1,R.emit("drain"))}(R,C),C.pendingcb--,Z(),ae(R,C)}function le(R,C){C.bufferProcessing=!0;var F=C.bufferedRequest;if(R._writev&&F&&F.next){var J=new Array(C.bufferedRequestCount),o=C.corkedRequestsFree;o.entry=F;for(var s=0,k=!0;F;)J[s]=F,F.isBuf||(k=!1),F=F.next,s+=1;J.allBuffers=k,Q(R,C,!0,C.length,J,"",o.finish),C.pendingcb++,C.lastBufferedRequest=null,o.next?(C.corkedRequestsFree=o.next,o.next=null):C.corkedRequestsFree=new v(C),C.bufferedRequestCount=0}else{for(;F;){var H=F.chunk;if(Q(R,C,!1,C.objectMode?1:H.length,H,F.encoding,F.callback),F=F.next,C.bufferedRequestCount--,C.writing)break}null===F&&(C.lastBufferedRequest=null)}C.bufferedRequest=F,C.bufferProcessing=!1}function pe(R){return R.ending&&0===R.length&&null===R.bufferedRequest&&!R.finished&&!R.writing}function be(R,C){R._final(function(F){C.pendingcb--,F&&S(R,F),C.prefinished=!0,R.emit("prefinish"),ae(R,C)})}function ae(R,C){var F=pe(C);if(F&&(function ge(R,C){!C.prefinished&&!C.finalCalled&&("function"!=typeof R._final||C.destroyed?(C.prefinished=!0,R.emit("prefinish")):(C.pendingcb++,C.finalCalled=!0,process.nextTick(be,R,C)))}(R,C),0===C.pendingcb&&(C.finished=!0,R.emit("finish"),C.autoDestroy))){var Z=R._readableState;(!Z||Z.autoDestroy&&Z.endEmitted)&&R.destroy()}return F}a(3894)(N,b),U.prototype.getBuffer=function(){for(var C=this.bufferedRequest,F=[];C;)F.push(C),C=C.next;return F},function(){try{Object.defineProperty(U.prototype,"buffer",{get:h.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(B=Function.prototype[Symbol.hasInstance],Object.defineProperty(N,Symbol.hasInstance,{value:function(C){return!!B.call(this,C)||this===N&&C&&C._writableState instanceof U}})):B=function(C){return C instanceof this},N.prototype.pipe=function(){S(this,new d)},N.prototype.write=function(R,C,F){var Z=this._writableState,J=!1,o=!Z.objectMode&&function e(R){return i.isBuffer(R)||R instanceof _}(R);return o&&!i.isBuffer(R)&&(R=function y(R){return i.from(R)}(R)),"function"==typeof C&&(F=C,C=null),o?C="buffer":C||(C=Z.defaultEncoding),"function"!=typeof F&&(F=D),Z.ending?function L(R,C){var F=new u;S(R,F),process.nextTick(C,F)}(this,F):(o||function W(R,C,F,Z){var J;return null===F?J=new t:"string"!=typeof F&&!C.objectMode&&(J=new l("chunk",["string","Buffer"],F)),!J||(S(R,J),process.nextTick(Z,J),!1)}(this,Z,R,F))&&(Z.pendingcb++,J=function X(R,C,F,Z,J,o){if(!F){var s=function V(R,C,F){return!R.objectMode&&!1!==R.decodeStrings&&"string"==typeof C&&(C=i.from(C,F)),C}(C,Z,J);Z!==s&&(F=!0,J="buffer",Z=s)}var k=C.objectMode?1:Z.length;C.length+=k;var H=C.length<C.highWaterMark;if(H||(C.needDrain=!0),C.writing||C.corked){var z=C.lastBufferedRequest;C.lastBufferedRequest={chunk:Z,encoding:J,isBuf:F,callback:o,next:null},z?z.next=C.lastBufferedRequest:C.bufferedRequest=C.lastBufferedRequest,C.bufferedRequestCount+=1}else Q(R,C,!1,k,Z,J,o);return H}(this,Z,o,R,C,F)),J},N.prototype.cork=function(){this._writableState.corked++},N.prototype.uncork=function(){var R=this._writableState;R.corked&&(R.corked--,!R.writing&&!R.corked&&!R.bufferProcessing&&R.bufferedRequest&&le(this,R))},N.prototype.setDefaultEncoding=function(C){if("string"==typeof C&&(C=C.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((C+"").toLowerCase())>-1))throw new T(C);return this._writableState.defaultEncoding=C,this},Object.defineProperty(N.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(N.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),N.prototype._write=function(R,C,F){F(new n("_write()"))},N.prototype._writev=null,N.prototype.end=function(R,C,F){var Z=this._writableState;return"function"==typeof R?(F=R,R=null,C=null):"function"==typeof C&&(F=C,C=null),null!=R&&this.write(R,C),Z.corked&&(Z.corked=1,this.uncork()),Z.ending||function Ee(R,C,F){C.ending=!0,ae(R,C),F&&(C.finished?process.nextTick(F):R.once("finish",F)),C.ended=!0,R.writable=!1}(this,Z,F),this},Object.defineProperty(N.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(N.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(C){this._writableState&&(this._writableState.destroyed=C)}}),N.prototype.destroy=p.destroy,N.prototype._undestroy=p.undestroy,N.prototype._destroy=function(R,C){C(R)}},6116:(M,I,a)=>{"use strict";var f;function v(r,t,u){return t in r?Object.defineProperty(r,t,{value:u,enumerable:!0,configurable:!0,writable:!0}):r[t]=u,r}var O=a(7542),h=Symbol("lastResolve"),b=Symbol("lastReject"),i=Symbol("error"),_=Symbol("ended"),y=Symbol("lastPromise"),e=Symbol("handlePromise"),p=Symbol("stream");function g(r,t){return{value:r,done:t}}function w(r){var t=r[h];if(null!==t){var u=r[p].read();null!==u&&(r[y]=null,r[h]=null,r[b]=null,t(g(u,!1)))}}function m(r){process.nextTick(w,r)}var n=Object.getPrototypeOf(function(){}),E=Object.setPrototypeOf((v(f={get stream(){return this[p]},next:function(){var t=this,u=this[i];if(null!==u)return Promise.reject(u);if(this[_])return Promise.resolve(g(void 0,!0));if(this[p].destroyed)return new Promise(function(U,B){process.nextTick(function(){t[i]?B(t[i]):U(g(void 0,!0))})});var S,T=this[y];if(T)S=new Promise(function l(r,t){return function(u,T){r.then(function(){t[_]?u(g(void 0,!0)):t[e](u,T)},T)}}(T,this));else{var D=this[p].read();if(null!==D)return Promise.resolve(g(D,!1));S=new Promise(this[e])}return this[y]=S,S}},Symbol.asyncIterator,function(){return this}),v(f,"return",function(){var t=this;return new Promise(function(u,T){t[p].destroy(null,function(S){S?T(S):u(g(void 0,!0))})})}),f),n);M.exports=function(t){var u,T=Object.create(E,(v(u={},p,{value:t,writable:!0}),v(u,h,{value:null,writable:!0}),v(u,b,{value:null,writable:!0}),v(u,i,{value:null,writable:!0}),v(u,_,{value:t._readableState.endEmitted,writable:!0}),v(u,e,{value:function(D,U){var B=T[p].read();B?(T[y]=null,T[h]=null,T[b]=null,D(g(B,!1))):(T[h]=D,T[b]=U)},writable:!0}),u));return T[y]=null,O(t,function(S){if(S&&"ERR_STREAM_PREMATURE_CLOSE"!==S.code){var D=T[b];return null!==D&&(T[y]=null,T[h]=null,T[b]=null,D(S)),void(T[i]=S)}var U=T[h];null!==U&&(T[y]=null,T[h]=null,T[b]=null,U(g(void 0,!0))),T[_]=!0}),t.on("readable",m.bind(null,T)),T}},5019:(M,I,a)=>{"use strict";function f(m,l){var n=Object.keys(m);if(Object.getOwnPropertySymbols){var E=Object.getOwnPropertySymbols(m);l&&(E=E.filter(function(d){return Object.getOwnPropertyDescriptor(m,d).enumerable})),n.push.apply(n,E)}return n}function O(m,l,n){return l in m?Object.defineProperty(m,l,{value:n,enumerable:!0,configurable:!0,writable:!0}):m[l]=n,m}function b(m,l){for(var n=0;n<l.length;n++){var E=l[n];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(m,E.key,E)}}var y=a(3172).Buffer,p=a(2361).inspect,g=p&&p.custom||"inspect";function w(m,l,n){y.prototype.copy.call(m,l,n)}M.exports=function(){function m(){(function h(m,l){if(!(m instanceof l))throw new TypeError("Cannot call a class as a function")})(this,m),this.head=null,this.tail=null,this.length=0}return function i(m,l,n){l&&b(m.prototype,l),n&&b(m,n)}(m,[{key:"push",value:function(n){var E={data:n,next:null};this.length>0?this.tail.next=E:this.head=E,this.tail=E,++this.length}},{key:"unshift",value:function(n){var E={data:n,next:this.head};0===this.length&&(this.tail=E),this.head=E,++this.length}},{key:"shift",value:function(){if(0!==this.length){var n=this.head.data;return this.head=1===this.length?this.tail=null:this.head.next,--this.length,n}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(n){if(0===this.length)return"";for(var E=this.head,d=""+E.data;E=E.next;)d+=n+E.data;return d}},{key:"concat",value:function(n){if(0===this.length)return y.alloc(0);for(var E=y.allocUnsafe(n>>>0),d=this.head,r=0;d;)w(d.data,E,r),r+=d.data.length,d=d.next;return E}},{key:"consume",value:function(n,E){var d;return n<this.head.data.length?(d=this.head.data.slice(0,n),this.head.data=this.head.data.slice(n)):d=n===this.head.data.length?this.shift():E?this._getString(n):this._getBuffer(n),d}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(n){var E=this.head,d=1,r=E.data;for(n-=r.length;E=E.next;){var t=E.data,u=n>t.length?t.length:n;if(r+=u===t.length?t:t.slice(0,n),0==(n-=u)){u===t.length?(++d,this.head=E.next?E.next:this.tail=null):(this.head=E,E.data=t.slice(u));break}++d}return this.length-=d,r}},{key:"_getBuffer",value:function(n){var E=y.allocUnsafe(n),d=this.head,r=1;for(d.data.copy(E),n-=d.data.length;d=d.next;){var t=d.data,u=n>t.length?t.length:n;if(t.copy(E,E.length-n,0,u),0==(n-=u)){u===t.length?(++r,this.head=d.next?d.next:this.tail=null):(this.head=d,d.data=t.slice(u));break}++r}return this.length-=r,E}},{key:g,value:function(n,E){return p(this,function v(m){for(var l=1;l<arguments.length;l++){var n=null!=arguments[l]?arguments[l]:{};l%2?f(Object(n),!0).forEach(function(E){O(m,E,n[E])}):Object.getOwnPropertyDescriptors?Object.defineProperties(m,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach(function(E){Object.defineProperty(m,E,Object.getOwnPropertyDescriptor(n,E))})}return m}({},E,{depth:0,customInspect:!1}))}}]),m}()},1920:M=>{"use strict";function a(b,i){O(b,i),f(b)}function f(b){b._writableState&&!b._writableState.emitClose||b._readableState&&!b._readableState.emitClose||b.emit("close")}function O(b,i){b.emit("error",i)}M.exports={destroy:function I(b,i){var _=this;return this._readableState&&this._readableState.destroyed||this._writableState&&this._writableState.destroyed?(i?i(b):b&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,process.nextTick(O,this,b)):process.nextTick(O,this,b)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(b||null,function(p){!i&&p?_._writableState?_._writableState.errorEmitted?process.nextTick(f,_):(_._writableState.errorEmitted=!0,process.nextTick(a,_,p)):process.nextTick(a,_,p):i?(process.nextTick(f,_),i(p)):process.nextTick(f,_)}),this)},undestroy:function v(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function h(b,i){var _=b._readableState,y=b._writableState;_&&_.autoDestroy||y&&y.autoDestroy?b.destroy(i):b.emit("error",i)}}},7542:(M,I,a)=>{"use strict";var f=a(891).q.ERR_STREAM_PREMATURE_CLOSE;function O(){}M.exports=function b(i,_,y){if("function"==typeof _)return b(i,null,_);_||(_={}),y=function v(i){var _=!1;return function(){if(!_){_=!0;for(var y=arguments.length,e=new Array(y),p=0;p<y;p++)e[p]=arguments[p];i.apply(this,e)}}}(y||O);var e=_.readable||!1!==_.readable&&i.readable,p=_.writable||!1!==_.writable&&i.writable,g=function(){i.writable||m()},w=i._writableState&&i._writableState.finished,m=function(){p=!1,w=!0,e||y.call(i)},l=i._readableState&&i._readableState.endEmitted,n=function(){e=!1,l=!0,p||y.call(i)},E=function(u){y.call(i,u)},d=function(){var u;return e&&!l?((!i._readableState||!i._readableState.ended)&&(u=new f),y.call(i,u)):p&&!w?((!i._writableState||!i._writableState.ended)&&(u=new f),y.call(i,u)):void 0},r=function(){i.req.on("finish",m)};return function h(i){return i.setHeader&&"function"==typeof i.abort}(i)?(i.on("complete",m),i.on("abort",d),i.req?r():i.on("request",r)):p&&!i._writableState&&(i.on("end",g),i.on("close",g)),i.on("end",n),i.on("finish",m),!1!==_.error&&i.on("error",E),i.on("close",d),function(){i.removeListener("complete",m),i.removeListener("abort",d),i.removeListener("request",r),i.req&&i.req.removeListener("finish",m),i.removeListener("end",g),i.removeListener("close",g),i.removeListener("finish",m),i.removeListener("end",n),i.removeListener("error",E),i.removeListener("close",d)}}},6200:M=>{M.exports=function(){throw new Error("Readable.from is not available in the browser")}},954:(M,I,a)=>{"use strict";var f,O=a(891).q,h=O.ERR_MISSING_ARGS,b=O.ERR_STREAM_DESTROYED;function i(m){if(m)throw m}function e(m){m()}function p(m,l){return m.pipe(l)}M.exports=function w(){for(var m=arguments.length,l=new Array(m),n=0;n<m;n++)l[n]=arguments[n];var E=function g(m){return m.length&&"function"==typeof m[m.length-1]?m.pop():i}(l);if(Array.isArray(l[0])&&(l=l[0]),l.length<2)throw new h("streams");var d,r=l.map(function(t,u){var T=u<l.length-1;return function y(m,l,n,E){E=function v(m){var l=!1;return function(){l||(l=!0,m.apply(void 0,arguments))}}(E);var d=!1;m.on("close",function(){d=!0}),void 0===f&&(f=a(7542)),f(m,{readable:l,writable:n},function(t){if(t)return E(t);d=!0,E()});var r=!1;return function(t){if(!d&&!r){if(r=!0,function _(m){return m.setHeader&&"function"==typeof m.abort}(m))return m.abort();if("function"==typeof m.destroy)return m.destroy();E(t||new b("pipe"))}}}(t,T,u>0,function(D){d||(d=D),D&&r.forEach(e),!T&&(r.forEach(e),E(d))})});return l.reduce(p)}},7102:(M,I,a)=>{"use strict";var f=a(891).q.ERR_INVALID_OPT_VALUE;M.exports={getHighWaterMark:function O(h,b,i,_){var y=function v(h,b,i){return null!=h.highWaterMark?h.highWaterMark:b?h[i]:null}(b,_,i);if(null!=y){if(!isFinite(y)||Math.floor(y)!==y||y<0)throw new f(_?i:"highWaterMark",y);return Math.floor(y)}return h.objectMode?16:16384}}},4970:(M,I,a)=>{M.exports=a(9069).EventEmitter},5685:(M,I,a)=>{(I=M.exports=a(3154)).Stream=I,I.Readable=I,I.Writable=a(520),I.Duplex=a(1339),I.Transform=a(6025),I.PassThrough=a(6071),I.finished=a(7542),I.pipeline=a(954)},7574:(M,I,a)=>{M.exports=function v(O,h){let b,i,_,y=!0;function e(g){function w(){h&&h(g,b),h=null}y?f(w):w()}function p(g,w,m){b[g]=m,(0==--i||w)&&e(w)}Array.isArray(O)?(b=[],i=O.length):(_=Object.keys(O),b={},i=_.length),i?_?_.forEach(function(g){O[g](function(w,m){p(g,w,m)})}):O.forEach(function(g,w){g(function(m,l){p(w,m,l)})}):e(null),y=!1};const f=a(6643)},3502:(M,I,a)=>{var f=a(3172),v=f.Buffer;function O(b,i){for(var _ in b)i[_]=b[_]}function h(b,i,_){return v(b,i,_)}v.from&&v.alloc&&v.allocUnsafe&&v.allocUnsafeSlow?M.exports=f:(O(f,I),I.Buffer=h),O(v,h),h.from=function(b,i,_){if("number"==typeof b)throw new TypeError("Argument must not be a number");return v(b,i,_)},h.alloc=function(b,i,_){if("number"!=typeof b)throw new TypeError("Argument must be a number");var y=v(b);return void 0!==i?"string"==typeof _?y.fill(i,_):y.fill(i):y.fill(0),y},h.allocUnsafe=function(b){if("number"!=typeof b)throw new TypeError("Argument must be a number");return v(b)},h.allocUnsafeSlow=function(b){if("number"!=typeof b)throw new TypeError("Argument must be a number");return f.SlowBuffer(b)}},3647:(M,I,a)=>{const f=a(1455)("simple-peer"),v=a(5855),O=a(3753),h=a(5685),b=a(6643),i=a(9357),{Buffer:_}=a(3172),y=65536;function g(l){return l.replace(/a=ice-options:trickle\s\n/g,"")}class m extends h.Duplex{constructor(n){if(super(n=Object.assign({allowHalfOpen:!1},n)),this._id=O(4).toString("hex").slice(0,7),this._debug("new peer %o",n),this.channelName=n.initiator?n.channelName||O(20).toString("hex"):null,this.initiator=n.initiator||!1,this.channelConfig=n.channelConfig||m.channelConfig,this.channelNegotiated=this.channelConfig.negotiated,this.config=Object.assign({},m.config,n.config),this.offerOptions=n.offerOptions||{},this.answerOptions=n.answerOptions||{},this.sdpTransform=n.sdpTransform||(E=>E),this.streams=n.streams||(n.stream?[n.stream]:[]),this.trickle=void 0===n.trickle||n.trickle,this.allowHalfTrickle=void 0!==n.allowHalfTrickle&&n.allowHalfTrickle,this.iceCompleteTimeout=n.iceCompleteTimeout||5e3,this.destroyed=!1,this.destroying=!1,this._connected=!1,this.remoteAddress=void 0,this.remoteFamily=void 0,this.remotePort=void 0,this.localAddress=void 0,this.localFamily=void 0,this.localPort=void 0,this._wrtc=n.wrtc&&"object"==typeof n.wrtc?n.wrtc:v(),!this._wrtc)throw i(typeof window>"u"?new Error("No WebRTC support: Specify `opts.wrtc` option in this environment"):new Error("No WebRTC support: Not a supported browser"),"ERR_WEBRTC_SUPPORT");this._pcReady=!1,this._channelReady=!1,this._iceComplete=!1,this._iceCompleteTimer=null,this._channel=null,this._pendingCandidates=[],this._isNegotiating=!1,this._firstNegotiation=!0,this._batchedNegotiation=!1,this._queuedNegotiation=!1,this._sendersAwaitingStable=[],this._senderMap=new Map,this._closingInterval=null,this._remoteTracks=[],this._remoteStreams=[],this._chunk=null,this._cb=null,this._interval=null;try{this._pc=new this._wrtc.RTCPeerConnection(this.config)}catch(E){return void this.destroy(i(E,"ERR_PC_CONSTRUCTOR"))}this._isReactNativeWebrtc="number"==typeof this._pc._peerConnectionId,this._pc.oniceconnectionstatechange=()=>{this._onIceStateChange()},this._pc.onicegatheringstatechange=()=>{this._onIceStateChange()},this._pc.onconnectionstatechange=()=>{this._onConnectionStateChange()},this._pc.onsignalingstatechange=()=>{this._onSignalingStateChange()},this._pc.onicecandidate=E=>{this._onIceCandidate(E)},"object"==typeof this._pc.peerIdentity&&this._pc.peerIdentity.catch(E=>{this.destroy(i(E,"ERR_PC_PEER_IDENTITY"))}),this.initiator||this.channelNegotiated?this._setupData({channel:this._pc.createDataChannel(this.channelName,this.channelConfig)}):this._pc.ondatachannel=E=>{this._setupData(E)},this.streams&&this.streams.forEach(E=>{this.addStream(E)}),this._pc.ontrack=E=>{this._onTrack(E)},this._debug("initial negotiation"),this._needsNegotiation(),this._onFinishBound=()=>{this._onFinish()},this.once("finish",this._onFinishBound)}get bufferSize(){return this._channel&&this._channel.bufferedAmount||0}get connected(){return this._connected&&"open"===this._channel.readyState}address(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}}signal(n){if(!this.destroying){if(this.destroyed)throw i(new Error("cannot signal after peer is destroyed"),"ERR_DESTROYED");if("string"==typeof n)try{n=JSON.parse(n)}catch{n={}}this._debug("signal()"),n.renegotiate&&this.initiator&&(this._debug("got request to renegotiate"),this._needsNegotiation()),n.transceiverRequest&&this.initiator&&(this._debug("got request for transceiver"),this.addTransceiver(n.transceiverRequest.kind,n.transceiverRequest.init)),n.candidate&&(this._pc.remoteDescription&&this._pc.remoteDescription.type?this._addIceCandidate(n.candidate):this._pendingCandidates.push(n.candidate)),n.sdp&&this._pc.setRemoteDescription(new this._wrtc.RTCSessionDescription(n)).then(()=>{this.destroyed||(this._pendingCandidates.forEach(E=>{this._addIceCandidate(E)}),this._pendingCandidates=[],"offer"===this._pc.remoteDescription.type&&this._createAnswer())}).catch(E=>{this.destroy(i(E,"ERR_SET_REMOTE_DESCRIPTION"))}),!n.sdp&&!n.candidate&&!n.renegotiate&&!n.transceiverRequest&&this.destroy(i(new Error("signal() called with invalid signal data"),"ERR_SIGNALING"))}}_addIceCandidate(n){const E=new this._wrtc.RTCIceCandidate(n);this._pc.addIceCandidate(E).catch(d=>{!E.address||E.address.endsWith(".local")?function w(l){console.warn(l)}("Ignoring unsupported ICE candidate."):this.destroy(i(d,"ERR_ADD_ICE_CANDIDATE"))})}send(n){if(!this.destroying){if(this.destroyed)throw i(new Error("cannot send after peer is destroyed"),"ERR_DESTROYED");this._channel.send(n)}}addTransceiver(n,E){if(!this.destroying){if(this.destroyed)throw i(new Error("cannot addTransceiver after peer is destroyed"),"ERR_DESTROYED");if(this._debug("addTransceiver()"),this.initiator)try{this._pc.addTransceiver(n,E),this._needsNegotiation()}catch(d){this.destroy(i(d,"ERR_ADD_TRANSCEIVER"))}else this.emit("signal",{type:"transceiverRequest",transceiverRequest:{kind:n,init:E}})}}addStream(n){if(!this.destroying){if(this.destroyed)throw i(new Error("cannot addStream after peer is destroyed"),"ERR_DESTROYED");this._debug("addStream()"),n.getTracks().forEach(E=>{this.addTrack(E,n)})}}addTrack(n,E){if(this.destroying)return;if(this.destroyed)throw i(new Error("cannot addTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("addTrack()");const d=this._senderMap.get(n)||new Map;let r=d.get(E);if(r)throw r.removed?i(new Error("Track has been removed. You should enable/disable tracks that you want to re-add."),"ERR_SENDER_REMOVED"):i(new Error("Track has already been added to that stream."),"ERR_SENDER_ALREADY_ADDED");r=this._pc.addTrack(n,E),d.set(E,r),this._senderMap.set(n,d),this._needsNegotiation()}replaceTrack(n,E,d){if(this.destroying)return;if(this.destroyed)throw i(new Error("cannot replaceTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("replaceTrack()");const r=this._senderMap.get(n),t=r?r.get(d):null;if(!t)throw i(new Error("Cannot replace track that was never added."),"ERR_TRACK_NOT_ADDED");E&&this._senderMap.set(E,r),null!=t.replaceTrack?t.replaceTrack(E):this.destroy(i(new Error("replaceTrack is not supported in this browser"),"ERR_UNSUPPORTED_REPLACETRACK"))}removeTrack(n,E){if(this.destroying)return;if(this.destroyed)throw i(new Error("cannot removeTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSender()");const d=this._senderMap.get(n),r=d?d.get(E):null;if(!r)throw i(new Error("Cannot remove track that was never added."),"ERR_TRACK_NOT_ADDED");try{r.removed=!0,this._pc.removeTrack(r)}catch(t){"NS_ERROR_UNEXPECTED"===t.name?this._sendersAwaitingStable.push(r):this.destroy(i(t,"ERR_REMOVE_TRACK"))}this._needsNegotiation()}removeStream(n){if(!this.destroying){if(this.destroyed)throw i(new Error("cannot removeStream after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSenders()"),n.getTracks().forEach(E=>{this.removeTrack(E,n)})}}_needsNegotiation(){this._debug("_needsNegotiation"),!this._batchedNegotiation&&(this._batchedNegotiation=!0,b(()=>{this._batchedNegotiation=!1,this.initiator||!this._firstNegotiation?(this._debug("starting batched negotiation"),this.negotiate()):this._debug("non-initiator initial negotiation request discarded"),this._firstNegotiation=!1}))}negotiate(){if(!this.destroying){if(this.destroyed)throw i(new Error("cannot negotiate after peer is destroyed"),"ERR_DESTROYED");this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),setTimeout(()=>{this._createOffer()},0)):this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("requesting negotiation from initiator"),this.emit("signal",{type:"renegotiate",renegotiate:!0})),this._isNegotiating=!0}}destroy(n){this._destroy(n,()=>{})}_destroy(n,E){this.destroyed||this.destroying||(this.destroying=!0,this._debug("destroying (error: %s)",n&&(n.message||n)),b(()=>{if(this.destroyed=!0,this.destroying=!1,this._debug("destroy (error: %s)",n&&(n.message||n)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch{}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch{}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ontrack=null,this._pc.ondatachannel=null}this._pc=null,this._channel=null,n&&this.emit("error",n),this.emit("close"),E()}))}_setupData(n){if(!n.channel)return this.destroy(i(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL"));this._channel=n.channel,this._channel.binaryType="arraybuffer","number"==typeof this._channel.bufferedAmountLowThreshold&&(this._channel.bufferedAmountLowThreshold=y),this.channelName=this._channel.label,this._channel.onmessage=d=>{this._onChannelMessage(d)},this._channel.onbufferedamountlow=()=>{this._onChannelBufferedAmountLow()},this._channel.onopen=()=>{this._onChannelOpen()},this._channel.onclose=()=>{this._onChannelClose()},this._channel.onerror=d=>{const r=d.error instanceof Error?d.error:new Error(`Datachannel error: ${d.message} ${d.filename}:${d.lineno}:${d.colno}`);this.destroy(i(r,"ERR_DATA_CHANNEL"))};let E=!1;this._closingInterval=setInterval(()=>{this._channel&&"closing"===this._channel.readyState?(E&&this._onChannelClose(),E=!0):E=!1},5e3)}_read(){}_write(n,E,d){if(this.destroyed)return d(i(new Error("cannot write after peer is destroyed"),"ERR_DATA_CHANNEL"));if(this._connected){try{this.send(n)}catch(r){return this.destroy(i(r,"ERR_DATA_CHANNEL"))}this._channel.bufferedAmount>y?(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=d):d(null)}else this._debug("write before connect"),this._chunk=n,this._cb=d}_onFinish(){if(this.destroyed)return;const n=()=>{setTimeout(()=>this.destroy(),1e3)};this._connected?n():this.once("connect",n)}_startIceCompleteTimeout(){this.destroyed||this._iceCompleteTimer||(this._debug("started iceComplete timeout"),this._iceCompleteTimer=setTimeout(()=>{this._iceComplete||(this._iceComplete=!0,this._debug("iceComplete timeout completed"),this.emit("iceTimeout"),this.emit("_iceComplete"))},this.iceCompleteTimeout))}_createOffer(){this.destroyed||this._pc.createOffer(this.offerOptions).then(n=>{if(this.destroyed)return;!this.trickle&&!this.allowHalfTrickle&&(n.sdp=g(n.sdp)),n.sdp=this.sdpTransform(n.sdp);const E=()=>{if(this.destroyed)return;const t=this._pc.localDescription||n;this._debug("signal"),this.emit("signal",{type:t.type,sdp:t.sdp})};this._pc.setLocalDescription(n).then(()=>{this._debug("createOffer success"),!this.destroyed&&(this.trickle||this._iceComplete?E():this.once("_iceComplete",E))}).catch(t=>{this.destroy(i(t,"ERR_SET_LOCAL_DESCRIPTION"))})}).catch(n=>{this.destroy(i(n,"ERR_CREATE_OFFER"))})}_requestMissingTransceivers(){this._pc.getTransceivers&&this._pc.getTransceivers().forEach(n=>{!n.mid&&n.sender.track&&!n.requested&&(n.requested=!0,this.addTransceiver(n.sender.track.kind))})}_createAnswer(){this.destroyed||this._pc.createAnswer(this.answerOptions).then(n=>{if(this.destroyed)return;!this.trickle&&!this.allowHalfTrickle&&(n.sdp=g(n.sdp)),n.sdp=this.sdpTransform(n.sdp);const E=()=>{if(this.destroyed)return;const t=this._pc.localDescription||n;this._debug("signal"),this.emit("signal",{type:t.type,sdp:t.sdp}),this.initiator||this._requestMissingTransceivers()};this._pc.setLocalDescription(n).then(()=>{this.destroyed||(this.trickle||this._iceComplete?E():this.once("_iceComplete",E))}).catch(t=>{this.destroy(i(t,"ERR_SET_LOCAL_DESCRIPTION"))})}).catch(n=>{this.destroy(i(n,"ERR_CREATE_ANSWER"))})}_onConnectionStateChange(){this.destroyed||"failed"===this._pc.connectionState&&this.destroy(i(new Error("Connection failed."),"ERR_CONNECTION_FAILURE"))}_onIceStateChange(){if(this.destroyed)return;const n=this._pc.iceConnectionState,E=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",n,E),this.emit("iceStateChange",n,E),("connected"===n||"completed"===n)&&(this._pcReady=!0,this._maybeReady()),"failed"===n&&this.destroy(i(new Error("Ice connection failed."),"ERR_ICE_CONNECTION_FAILURE")),"closed"===n&&this.destroy(i(new Error("Ice connection closed."),"ERR_ICE_CONNECTION_CLOSED"))}getStats(n){const E=d=>("[object Array]"===Object.prototype.toString.call(d.values)&&d.values.forEach(r=>{Object.assign(d,r)}),d);0===this._pc.getStats.length||this._isReactNativeWebrtc?this._pc.getStats().then(d=>{const r=[];d.forEach(t=>{r.push(E(t))}),n(null,r)},d=>n(d)):this._pc.getStats.length>0?this._pc.getStats(d=>{if(this.destroyed)return;const r=[];d.result().forEach(t=>{const u={};t.names().forEach(T=>{u[T]=t.stat(T)}),u.id=t.id,u.type=t.type,u.timestamp=t.timestamp,r.push(E(u))}),n(null,r)},d=>n(d)):n(null,[])}_maybeReady(){if(this._debug("maybeReady pc %s channel %s",this._pcReady,this._channelReady),this._connected||this._connecting||!this._pcReady||!this._channelReady)return;this._connecting=!0;const n=()=>{this.destroyed||this.getStats((E,d)=>{if(this.destroyed)return;E&&(d=[]);const r={},t={},u={};let T=!1;d.forEach(D=>{("remotecandidate"===D.type||"remote-candidate"===D.type)&&(r[D.id]=D),("localcandidate"===D.type||"local-candidate"===D.type)&&(t[D.id]=D),("candidatepair"===D.type||"candidate-pair"===D.type)&&(u[D.id]=D)});const S=D=>{T=!0;let U=t[D.localCandidateId];U&&(U.ip||U.address)?(this.localAddress=U.ip||U.address,this.localPort=Number(U.port)):U&&U.ipAddress?(this.localAddress=U.ipAddress,this.localPort=Number(U.portNumber)):"string"==typeof D.googLocalAddress&&(U=D.googLocalAddress.split(":"),this.localAddress=U[0],this.localPort=Number(U[1])),this.localAddress&&(this.localFamily=this.localAddress.includes(":")?"IPv6":"IPv4");let B=r[D.remoteCandidateId];B&&(B.ip||B.address)?(this.remoteAddress=B.ip||B.address,this.remotePort=Number(B.port)):B&&B.ipAddress?(this.remoteAddress=B.ipAddress,this.remotePort=Number(B.portNumber)):"string"==typeof D.googRemoteAddress&&(B=D.googRemoteAddress.split(":"),this.remoteAddress=B[0],this.remotePort=Number(B[1])),this.remoteAddress&&(this.remoteFamily=this.remoteAddress.includes(":")?"IPv6":"IPv4"),this._debug("connect local: %s:%s remote: %s:%s",this.localAddress,this.localPort,this.remoteAddress,this.remotePort)};if(d.forEach(D=>{"transport"===D.type&&D.selectedCandidatePairId&&S(u[D.selectedCandidatePairId]),("googCandidatePair"===D.type&&"true"===D.googActiveConnection||("candidatepair"===D.type||"candidate-pair"===D.type)&&D.selected)&&S(D)}),T||Object.keys(u).length&&!Object.keys(t).length){if(this._connecting=!1,this._connected=!0,this._chunk){try{this.send(this._chunk)}catch(U){return this.destroy(i(U,"ERR_DATA_CHANNEL"))}this._chunk=null,this._debug('sent chunk from "write before connect"');const D=this._cb;this._cb=null,D(null)}"number"!=typeof this._channel.bufferedAmountLowThreshold&&(this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")}else setTimeout(n,100)})};n()}_onInterval(){!this._cb||!this._channel||this._channel.bufferedAmount>y||this._onChannelBufferedAmountLow()}_onSignalingStateChange(){this.destroyed||("stable"===this._pc.signalingState&&(this._isNegotiating=!1,this._debug("flushing sender queue",this._sendersAwaitingStable),this._sendersAwaitingStable.forEach(n=>{this._pc.removeTrack(n),this._queuedNegotiation=!0}),this._sendersAwaitingStable=[],this._queuedNegotiation?(this._debug("flushing negotiation queue"),this._queuedNegotiation=!1,this._needsNegotiation()):(this._debug("negotiated"),this.emit("negotiated"))),this._debug("signalingStateChange %s",this._pc.signalingState),this.emit("signalingStateChange",this._pc.signalingState))}_onIceCandidate(n){this.destroyed||(n.candidate&&this.trickle?this.emit("signal",{type:"candidate",candidate:{candidate:n.candidate.candidate,sdpMLineIndex:n.candidate.sdpMLineIndex,sdpMid:n.candidate.sdpMid}}):!n.candidate&&!this._iceComplete&&(this._iceComplete=!0,this.emit("_iceComplete")),n.candidate&&this._startIceCompleteTimeout())}_onChannelMessage(n){if(this.destroyed)return;let E=n.data;E instanceof ArrayBuffer&&(E=_.from(E)),this.push(E)}_onChannelBufferedAmountLow(){if(this.destroyed||!this._cb)return;this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);const n=this._cb;this._cb=null,n(null)}_onChannelOpen(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())}_onChannelClose(){this.destroyed||(this._debug("on channel close"),this.destroy())}_onTrack(n){this.destroyed||n.streams.forEach(E=>{this._debug("on track"),this.emit("track",n.track,E),this._remoteTracks.push({track:n.track,stream:E}),!this._remoteStreams.some(d=>d.id===E.id)&&(this._remoteStreams.push(E),b(()=>{this._debug("on stream"),this.emit("stream",E)}))})}_debug(){const n=[].slice.call(arguments);n[0]="["+this._id+"] "+n[0],f.apply(null,n)}}m.WEBRTC_SUPPORT=!!v(),m.config={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}],sdpSemantics:"unified-plan"},m.channelConfig={},M.exports=m},9357:M=>{"use strict";function I(f,v){for(const O in v)Object.defineProperty(f,O,{value:v[O],enumerable:!0,configurable:!0});return f}M.exports=function a(f,v,O){if(!f||"string"==typeof f)throw new TypeError("Please pass an Error to err-code");O||(O={}),"object"==typeof v&&(O=v,v=""),v&&(O.code=v);try{return I(f,O)}catch{O.message=f.message,O.stack=f.stack;const b=function(){};return b.prototype=Object.create(Object.getPrototypeOf(f)),I(new b,O)}}},1808:(M,I,a)=>{const f=a(1455)("simple-websocket"),v=a(3753),O=a(5685),h=a(6643),b=a(4472),i="function"!=typeof b?WebSocket:b;M.exports=(()=>{class e extends O.Duplex{constructor(g={}){if("string"==typeof g&&(g={url:g}),super(g=Object.assign({allowHalfOpen:!1},g)),null==g.url&&null==g.socket)throw new Error("Missing required `url` or `socket` option");if(null!=g.url&&null!=g.socket)throw new Error("Must specify either `url` or `socket` option, not both");if(this._id=v(4).toString("hex").slice(0,7),this._debug("new websocket: %o",g),this.connected=!1,this.destroyed=!1,this._chunk=null,this._cb=null,this._interval=null,g.socket)this.url=g.socket.url,this._ws=g.socket,this.connected=g.socket.readyState===i.OPEN;else{this.url=g.url;try{this._ws="function"==typeof b?new i(g.url,null,{...g,encoding:void 0}):new i(g.url)}catch(w){return void h(()=>this.destroy(w))}}this._ws.binaryType="arraybuffer",g.socket&&this.connected?h(()=>this._handleOpen()):this._ws.onopen=()=>this._handleOpen(),this._ws.onmessage=w=>this._handleMessage(w),this._ws.onclose=()=>this._handleClose(),this._ws.onerror=w=>this._handleError(w),this._handleFinishBound=()=>this._handleFinish(),this.once("finish",this._handleFinishBound)}send(g){this._ws.send(g)}destroy(g){this._destroy(g,()=>{})}_destroy(g,w){if(!this.destroyed){if(this._debug("destroy (error: %s)",g&&(g.message||g)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this.connected=!1,this.destroyed=!0,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._handleFinishBound&&this.removeListener("finish",this._handleFinishBound),this._handleFinishBound=null,this._ws){const m=this._ws,l=()=>{m.onclose=null};if(m.readyState===i.CLOSED)l();else try{m.onclose=l,m.close()}catch{l()}m.onopen=null,m.onmessage=null,m.onerror=()=>{}}this._ws=null,g&&this.emit("error",g),this.emit("close"),w()}}_read(){}_write(g,w,m){if(this.destroyed)return m(new Error("cannot write after socket is destroyed"));if(this.connected){try{this.send(g)}catch(l){return this.destroy(l)}"function"!=typeof b&&this._ws.bufferedAmount>65536?(this._debug("start backpressure: bufferedAmount %d",this._ws.bufferedAmount),this._cb=m):m(null)}else this._debug("write before connect"),this._chunk=g,this._cb=m}_handleOpen(){if(!this.connected&&!this.destroyed){if(this.connected=!0,this._chunk){try{this.send(this._chunk)}catch(w){return this.destroy(w)}this._chunk=null,this._debug('sent chunk from "write before connect"');const g=this._cb;this._cb=null,g(null)}"function"!=typeof b&&(this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")}}_handleMessage(g){if(this.destroyed)return;let w=g.data;w instanceof ArrayBuffer&&(w=Buffer.from(w)),this.push(w)}_handleClose(){this.destroyed||(this._debug("on close"),this.destroy())}_handleError(g){this.destroy(new Error(`Error connecting to ${this.url}`))}_handleFinish(){if(this.destroyed)return;const g=()=>{setTimeout(()=>this.destroy(),1e3)};this.connected?g():this.once("connect",g)}_onInterval(){if(!this._cb||!this._ws||this._ws.bufferedAmount>65536)return;this._debug("ending backpressure: bufferedAmount %d",this._ws.bufferedAmount);const g=this._cb;this._cb=null,g(null)}_debug(){const g=[].slice.call(arguments);g[0]="["+this._id+"] "+g[0],f.apply(null,g)}}return e.WEBSOCKET_SUPPORT=!!i,e})()},3054:(M,I,a)=>{"use strict";var f=a(858).Buffer,v=f.isEncoding||function(r){switch((r=""+r)&&r.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function b(r){var t;switch(this.encoding=function h(r){var t=function O(r){if(!r)return"utf8";for(var t;;)switch(r){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return r;default:if(t)return;r=(""+r).toLowerCase(),t=!0}}(r);if("string"!=typeof t&&(f.isEncoding===v||!v(r)))throw new Error("Unknown encoding: "+r);return t||r}(r),this.encoding){case"utf16le":this.text=w,this.end=m,t=4;break;case"utf8":this.fillLast=e,t=4;break;case"base64":this.text=l,this.end=n,t=3;break;default:return this.write=E,void(this.end=d)}this.lastNeed=0,this.lastTotal=0,this.lastChar=f.allocUnsafe(t)}function i(r){return r<=127?0:r>>5==6?2:r>>4==14?3:r>>3==30?4:r>>6==2?-1:-2}function e(r){var t=this.lastTotal-this.lastNeed,u=function y(r,t,u){if(128!=(192&t[0]))return r.lastNeed=0,"\ufffd";if(r.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return r.lastNeed=1,"\ufffd";if(r.lastNeed>2&&t.length>2&&128!=(192&t[2]))return r.lastNeed=2,"\ufffd"}}(this,r);return void 0!==u?u:this.lastNeed<=r.length?(r.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(r.copy(this.lastChar,t,0,r.length),void(this.lastNeed-=r.length))}function w(r,t){if((r.length-t)%2==0){var u=r.toString("utf16le",t);if(u){var T=u.charCodeAt(u.length-1);if(T>=55296&&T<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=r[r.length-2],this.lastChar[1]=r[r.length-1],u.slice(0,-1)}return u}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=r[r.length-1],r.toString("utf16le",t,r.length-1)}function m(r){var t=r&&r.length?this.write(r):"";return this.lastNeed?t+this.lastChar.toString("utf16le",0,this.lastTotal-this.lastNeed):t}function l(r,t){var u=(r.length-t)%3;return 0===u?r.toString("base64",t):(this.lastNeed=3-u,this.lastTotal=3,1===u?this.lastChar[0]=r[r.length-1]:(this.lastChar[0]=r[r.length-2],this.lastChar[1]=r[r.length-1]),r.toString("base64",t,r.length-u))}function n(r){var t=r&&r.length?this.write(r):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function E(r){return r.toString(this.encoding)}function d(r){return r&&r.length?this.write(r):""}I.s=b,b.prototype.write=function(r){if(0===r.length)return"";var t,u;if(this.lastNeed){if(void 0===(t=this.fillLast(r)))return"";u=this.lastNeed,this.lastNeed=0}else u=0;return u<r.length?t?t+this.text(r,u):this.text(r,u):t||""},b.prototype.end=function g(r){var t=r&&r.length?this.write(r):"";return this.lastNeed?t+"\ufffd":t},b.prototype.text=function p(r,t){var u=function _(r,t,u){var T=t.length-1;if(T<u)return 0;var S=i(t[T]);return S>=0?(S>0&&(r.lastNeed=S-1),S):--T<u||-2===S?0:(S=i(t[T]))>=0?(S>0&&(r.lastNeed=S-2),S):--T<u||-2===S?0:(S=i(t[T]))>=0?(S>0&&(2===S?S=0:r.lastNeed=S-3),S):0}(this,r,t);if(!this.lastNeed)return r.toString("utf8",t);this.lastTotal=u;var T=r.length-(u-this.lastNeed);return r.copy(this.lastChar,0,T),r.toString("utf8",t,T)},b.prototype.fillLast=function(r){if(this.lastNeed<=r.length)return r.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);r.copy(this.lastChar,this.lastTotal-this.lastNeed,0,r.length),this.lastNeed-=r.length}},858:(M,I,a)=>{var f=a(3172),v=f.Buffer;function O(b,i){for(var _ in b)i[_]=b[_]}function h(b,i,_){return v(b,i,_)}v.from&&v.alloc&&v.allocUnsafe&&v.allocUnsafeSlow?M.exports=f:(O(f,I),I.Buffer=h),h.prototype=Object.create(v.prototype),O(v,h),h.from=function(b,i,_){if("number"==typeof b)throw new TypeError("Argument must not be a number");return v(b,i,_)},h.alloc=function(b,i,_){if("number"!=typeof b)throw new TypeError("Argument must be a number");var y=v(b);return void 0!==i?"string"==typeof _?y.fill(i,_):y.fill(i):y.fill(0),y},h.allocUnsafe=function(b){if("number"!=typeof b)throw new TypeError("Argument must be a number");return v(b)},h.allocUnsafeSlow=function(b){if("number"!=typeof b)throw new TypeError("Argument must be a number");return f.SlowBuffer(b)}},4364:M=>{function a(f){try{if(!global.localStorage)return!1}catch{return!1}var v=global.localStorage[f];return null!=v&&"true"===String(v).toLowerCase()}M.exports=function I(f,v){if(a("noDeprecation"))return f;var O=!1;return function h(){if(!O){if(a("throwDeprecation"))throw new Error(v);a("traceDeprecation")?console.trace(v):console.warn(v),O=!0}return f.apply(this,arguments)}}},9136:M=>{M.exports=function I(a,f){if(a&&f)return I(a)(f);if("function"!=typeof a)throw new TypeError("need wrapper function");return Object.keys(a).forEach(function(O){v[O]=a[O]}),v;function v(){for(var O=new Array(arguments.length),h=0;h<O.length;h++)O[h]=arguments[h];var b=a.apply(this,O),i=O[O.length-1];return"function"==typeof b&&b!==i&&Object.keys(i).forEach(function(_){b[_]=i[_]}),b}}},5732:()=>{},3762:()=>{},8333:()=>{},59:()=>{},2361:()=>{},4616:()=>{},4472:()=>{},7156:M=>{function I(f,v,O,h,b,i,_){try{var y=f[i](_),e=y.value}catch(p){return void O(p)}y.done?v(e):Promise.resolve(e).then(h,b)}M.exports=function a(f){return function(){var v=this,O=arguments;return new Promise(function(h,b){var i=f.apply(v,O);function _(e){I(i,h,b,_,y,"next",e)}function y(e){I(i,h,b,_,y,"throw",e)}_(void 0)})}},M.exports.__esModule=!0,M.exports.default=M.exports},4425:(M,I,a)=>{"use strict";a.d(I,{TU:()=>h});var f=a(6895),v=a(4650);class O{constructor(e,p){this._document=p;const g=this._textarea=this._document.createElement("textarea"),w=g.style;w.position="fixed",w.top=w.opacity="0",w.left="-999em",g.setAttribute("aria-hidden","true"),g.value=e,g.readOnly=!0,this._document.body.appendChild(g)}copy(){const e=this._textarea;let p=!1;try{if(e){const g=this._document.activeElement;e.select(),e.setSelectionRange(0,e.value.length),p=this._document.execCommand("copy"),g&&g.focus()}}catch{}return p}destroy(){const e=this._textarea;e&&(e.remove(),this._textarea=void 0)}}let h=(()=>{class y{constructor(p){this._document=p}copy(p){const g=this.beginCopy(p),w=g.copy();return g.destroy(),w}beginCopy(p){return new O(p,this._document)}}return y.\u0275fac=function(p){return new(p||y)(v.LFG(f.K0))},y.\u0275prov=v.Yz7({token:y,factory:y.\u0275fac,providedIn:"root"}),y})()}}]);